***************Beginning Page***************
***************page number:1**************
l A
$ BAZE DE DATE
Mihaela Elena Ereabén
i; Fll 202072021

***************Ending Page***************

***************Beginning Page***************
***************page number:2**************
Cuprins
r Etapele procesirii interogirilor
> Expresii in algebra relagionali
Operatori (rewzitat)
Expresii
Echwalenga expresiilcr
> Estimarea costului interogérii
> Algoritmi pentru evaluarea operatorilor/expresiilor Tn algebra relagionalé
1

***************Ending Page***************

***************Beginning Page***************
***************page number:3**************
Etapele procesérii interogérilor
> Compilarea interogirii
> Analiu sintactici - Complarea
\ Arm de Wm
> Analiza semanticé v '
- E -
Seleqia reprezemiriialgebrice i 110'“;ng
Selecgia algoritmilor 5i a ordinii // V
\ Plan ﬁm ‘c, V
meud=A\ v
\"' "7i
) 3

***************Ending Page***************

***************Beginning Page***************
***************page number:4**************
Analiza sintacticé
> Gramatici independenté de context
<query> ::: <SFW> | (<query>)
<SFW> *.= SELECT <se\ecnilisn> FROM <cahleil|sL>WHERE <whereicand>
<se\en_hst> ,;= <idenuﬁer>, <se\en_hst> | <|denﬂﬁer>
<(ablejls:> .1: <\der\uﬁer>,<tableilvs:> \ <|demt|ﬁer >
> Rezultatul parsirii: arbore de parsare
SELECT " FROM usenable WHERE usenwui:‘ngg‘ ANDwsswmd:‘sens'
@ -em A» Mmhml
o w @ pm»; when
> Gramatica SQL in form: BNF: http:Usavagc.ncLau/SQL/mdcxvhtrnl
} 4

***************Ending Page***************

***************Beginning Page***************
***************page number:5**************
Analiza semanticé

Preprocesare

> Rescrierea apelurilor la view-uri

> Veriﬁcarea existenyei relaqilor

> Veriﬁcarea existenyei atributelor 5i a ambiguiﬁﬁi

> Veriﬁcarez tipurilor

Dacé arborele de parsare este valid el este transformat intr-o expresie cu operatori din algebra
relagionali
S

***************Ending Page***************

***************Beginning Page***************
***************page number:6**************
Analiza semanticé
Rescriere in AR (1)
<Query>
\
SELECI' < select_list > FROM < table_lisc > WHERE < whiraqm >
< idenuﬁer > < idenuﬁer > <Tup|e> 1N <QuK
. ‘ \ / / 1
tltle Starsln < \dentilﬁer > ( <QL/JEI'Y> )
/M%VT>
SELECT < s;leu_lis: > FROM /< :able_|is: > wE/< {hire_cond >
< Identiﬁer > < Identiﬁer > < Ide‘ntiﬁer > LIKE <Pattem>
I / \
name MovieStar birthDate “’/n1960'
p a

***************Ending Page***************

***************Beginning Page***************
***************page number:7**************
Analiza semanticé
Rescriere in AR (2]
ntitle Htitle
6 wh er e_c o n d> UstarNaTe:name
\ \ X
StarsIn / \
<tup|e> IN Hname StarsIn Hname
<attribute> Ubirthdate LIKE ‘%1950' Gbirthdate LIKE '%195n'
starName MovieStar MDVieStar
p 7

***************Ending Page***************

***************Beginning Page***************
***************page number:8**************
Anallza semantlca
Optlmlzarea planu1u1 loglc
SELECT Theaier n plan logic imp/11
FROM Movie, Schcdule \ Them’
WHERE 6 _ _ _
Mowef'ﬂlle : ScheduleTllle )L Movie.T|llFSche/dule Tn]: AND Movle AcAoF"ngel"
AND M.Acto|=“Winger" /
Movic Ermine
Gcnmuurul m» plumln lugh'c
ah plan lagic dplw-i mcnrn .llgrbnr:
"Theaier .
\ n1, plan Ioglc
1:
T Movie,Actnr:“Winger" ‘ Them’
[>4 6 .
/ M0v\B.T\ﬂe: ‘ Movie.Ac\oI>“nger"
JOIN =Schedule,Tille
6Mnvie.Tnle=Sr:hedule.Tille
Movie Sc edule ,L
Q Movie/ Emu
} H

***************Ending Page***************

***************Beginning Page***************
***************page number:9**************
Analiza semanticé
Optimizarea planului logic
7!‘ Theater ﬁTheaier
M . _ . .
(‘,Movie.ActoF“Winger” \Schedule.TltleiMowefl'nle
M Movie.Title: 6
/\:Schedule.Title ‘ACIOF“WingH"
Mov1e Schedule Schedule Movie
‘ Qq
(‘20nd ducfu'mul \
M face refcrire / g
/ \ duar la S R ‘
R S S
> v

***************Ending Page***************

***************Beginning Page***************
***************page number:10**************
Analiza semanticé
Optimizarea planului ﬁzic
“Wham
>4 Schedule.Tille:Movie.Tiﬂe Schedule \mml pt Tulc
\ fTheau/er
NSORT-MERGIZ ‘ .
T Acml=MWingern \Sclledule,TnleiMcMeTnle
S h l M '
c e ue ovle GIEQEX“W' “
(icncmmrnldcpldnﬁzlcdlcgc ‘ HF Inger
plimiliwlcd: emcmic‘ Schedule Mom
mm pc \um w _
KT,‘ 1 . v . . V. .. V, m” 11:71 2
Euler 1m uhdg mamm‘
>‘<1 LEFT INDEX
\SchedulevTitlFMovie.Tille
“INDEX ~
‘ Aciorf'nger"
Sche ule Movie
P/ullﬁjll I
} ID

***************Ending Page***************

***************Beginning Page***************
***************page number:11**************
Operatori in algebra relationalé
(revizitat)
> §ase operatori de bazi

> Selecgiazs

> Proiecgia: Fl

> Reuniunea: U

> Diferenga: —

> Produsul cartezianzx

> Redenumirea: ,1
> Operatorii iau ca intrare una sau doui relaqi §i genereazé o noua relaqe
p ||

***************Ending Page***************

***************Beginning Page***************
***************page number:12**************
Operatorul de selectie

> Realagia r nu.“
a a I 7
a ,Ii 5 7
ﬁ ﬁ IZ 3
,0 ,0 23 IO

' UA=B"D>S(r) nu.“
a a l 7
11 p 23 m

} l1

***************Ending Page***************

***************Beginning Page***************
***************page number:13**************
Operatorul de proiecyie
> Relagiar
a I0 I
a 20 I
ﬁ 30 I
,0 4o 2
>11‘.c (r)
a I a I
a I p I
ﬁ I p z
t Z
) l3

***************Ending Page***************


***************Beginning Page***************
***************page number:14**************
Operatorul reuniune
> Relagiile r §i s
a I a 2
a 2 11 3
ﬂ I S
r
> W S;
a I
a 2
ﬂ I
ﬁ 3
) H

***************Ending Page***************

***************Beginning Page***************
***************page number:15**************
Operatorul diferenté
> Relagiile r §i s
a I a 2
a 2 11 3
ﬂ I S
r
a l
11 I
p ls

***************Ending Page***************

***************Beginning Page***************
***************page number:16**************
Produsul cartezian
a ID a
p IO a
I] 2 11 20 b
' y IO b
s
IIIIEH
a I a IO a
a 1 p /o a
a I 1; 20 b
a 1 7 IO b
p 2 a m a
p 2 p ID a
p 2 p 20 b
I 2 * ll] b
} lé

***************Ending Page***************

***************Beginning Page***************
***************page number:17**************
Operatorul de redenumire
> px (E) - returneazé expresia E sub numele X
> Dacé o expresie E Tn algebra relagionalé are aritate n atunci
pX(A|./12> ,A,M(E)
returneazi rezultatul expresiei E sub numele X §i acributele redenumite Tn A,,A2, “WA”
n

***************Ending Page***************

***************Beginning Page***************
***************page number:18**************
Compunerea operatonlor
> UA=C(I’XS)
"HIE
/. rxs
a 1 a IO a
a I p m a
a I p 20 b
a 1 y IO b
11 2 a m a
p 2 p IO a
p 2 p 20 b
: 2 ~ m b
2. 0A=C(rxs)
lulu:
a I a I0
11 2 ﬁ I0
ﬁ 2 l1 20
} IE

***************Ending Page***************

***************Beginning Page***************
***************page number:19**************
Expresii in algebra relationalé

> Cea mai simpla expresie este o relagie Tn baza de date

v Fie E, §i E2 expresii in algebra relagionali; urmitoarele sum expresii in algebra relationali:
> E , Q £2
> E, , E2
> E, x £2
> 6p (E ,). P esre un predlcat paste atribute dm E,
> 1145,), s esze o ma de ambute am E,
> px (5,), x este noul Hume pennu rexukztul lui E,

p w

***************Ending Page***************

***************Beginning Page***************
***************page number:20**************
Expnmarea 1nterogér110r in algebra relaplonalé
mm “mm” 4qu zmmmur
“memw
,. in. whim m‘ (vs/ninmew
> lmpumuturile (loan) mzi marl a: I100 WM Y
sammmt> \200 (105")
> Numarm fmprumutului (loaninumber) perm TmprumuKuri mai marl de I200
BMW“, (“mm > mo (loam)
> Numele clierwilor care au un imprumuL un depozlt sau ambele la hancé
Ummmmﬂme (“WW”) U l'lmmmeuame (“1105ti)
} 10

***************Ending Page***************

***************Beginning Page***************
***************page number:21**************
Interogan
> Numele tuturorcliemilor care au un Tmprumul la ﬁliala Perryridge
‘ ncusmmeriname (Gbmnchiname =“Perryridge” (
6borrowenloan_number = loan_loan_number (b°"r°wer X km)»
‘ “customeriname(6loan.loaninumber = borrowenloaninumber(
(shranchiname = “Fern/ridge“ (‘WW X b°"°wer))
lmmc/r nctmm! (Iqmwtm “Mm”
[MHJIJMHW "uwuinmm'u
Wm,
D 1|

***************Ending Page***************

***************Beginning Page***************
***************page number:22**************
Interogan
lmmc/r nctmm! (Iqmwtm “Mm”
vadLumm' hwypnmuh!
mum”!
> Numele tuturor cliengilor care nu un Tmprumut la ﬁliala Perryridge dar nu au un depozit la nici o mama
a bincii
l [zuswmeulame (Gbranchirvame = “Perry/ridge”
(chorrowenlonninumber = 1m.IanwumbeAbmmWer X |°="))) -
ncustomerinameweposmor)
> 11

***************Ending Page***************

***************Beginning Page***************
***************page number:23**************
Operatori aditionali

> lntersecgia pe mulgimi

> joinul natural

> Agregarea

> joinul extern

> Teta-jomul
> Togi cu excepgia agregirii pot ﬁ exprimagi utilizind operatori de bazi
p 23

***************Ending Page***************

***************Beginning Page***************
***************page number:24**************
Intersecpia pe multimi
> Relagiile r §i s
" '
a 1
[i | 3
r s
’ m s
P 14

***************Ending Page***************

***************Beginning Page***************
***************page number:25**************
Joinul natural
r Relagiile r §i s "um
01 | 01 a | a a
[a 2 y a 3 a B
y 4 15 b | a y
a | y a 2 b 6
5 Z i b 3 b E
I S
"HEB
01 | 0. a (‘1
' rm‘ m | c. a y
a | y a a
a | y a y
5 1 i b 5
' nnA,r.B,r.C,r.D,sE (GLB=S.BALD=&D (r X s))
15

***************Ending Page***************

***************Beginning Page***************
***************page number:26**************
Agregare
Exemplu
> Cea mai mare balms din tabela account
ﬂrIOlmt
lvmmlrimmlu
[min/m
nhmmdamum) ' naccounlbnlunce
(Guccouanalance < dimlarvce (“mm X Pd (“WW”)
F 16

***************Ending Page***************


***************Beginning Page***************
***************page number:27**************
Functii de agregare §i operatori

> Funcﬂi de agregare:
> avg
> min
> max
> sum
r count
> var

v Operatorul de agregare Tn algebra relaﬂonali

6,516 ‘9mm)sztAn‘---an<An)(E)
v E i expresie in algebra relaﬂonalé
> 6,, GZ .. ., c" o \isu“; de atribute de grupare (poate n goa\5)
> Fiecare F, esle o {uncgie de agregare
v Fiecare A, esce un atribut
p 27

***************Ending Page***************

***************Beginning Page***************
***************page number:28**************
Agregare
Exemplu
m m 1
a p 1
B B 3
B B l0
' g gum“) (Y)
> Care operaw de agregare nu pot h exprimate pe ban celormgi operamri relaponali?
p as

***************Ending Page***************

***************Beginning Page***************
***************page number:29**************
Join extern
relagia loan relagia borrower
1%anan branchiname amount
L-l 70 Downtown 3000 jones L- x 70
L-ZZO Redwood 4000 Srmrh L130
erso Perryrldge x 700 Hayes L- x 55
r loan >< bormwer (juin natural)
Ioaninumber branchiname amount customeriname
L-l 7o Downtown 3000 jones
0-230 Redwood 4000 Srruth
> loan D4 borrower (join extern stﬁnga)
/aun,number branch,nnme amount customcrinume
L-l 7o Downtown 3000 jones
L-zao Redwood 4000 5mm
> 2, L-ZéO Perryrldge I700 nu”

***************Ending Page***************

***************Beginning Page***************
***************page number:30**************
Join extern
> join extem dreapta
loan ><Cbomw=r
loanJvunlbe! branclwinanwe arnuunt cuszonwerinanwe
L-l 7O Downtown 3000 lanes
L-ZZO Redwood 4000 Snnch
Lil 55 null null Hayes
> join extern p|in
lnun Mhormwer
loaninumber bmﬂCanﬂmC amount cuszonlcriname
L-l 70 Downtown 3000 jones
L-230 Redwood 4000 Smh
L-ZéO Perryridge l 700 null
L-l SS null null Hayes
p an

***************Ending Page***************

***************Beginning Page***************
***************page number:31**************
Example 1nterogar1
> Numele clien'rilorcare au un Tmprumut 5i un depolit la banci
l'lmmmwme (borrower) m l'lmmmm (“PM”)
> Numele clien§ilor care au un Tmprumut la banci §i suma imprumutati
memﬂme, laanimmbev, nmaunl (WWW/">4 Iva")
> Cliengii care au depozite I; ambele ﬁliale Downtown §i Uptown
nmmmum (50mm name ="Duwnwwn' (devwwrbq mow‘! )J n
“customer ﬂﬂﬂle (6mm name =“Upmwn' (dePOSI'WMWWHID
3|

***************Ending Page***************

***************Beginning Page***************
***************page number:32**************
Echivalenta expresiilor
r Doui expresii Tn algebra relagionali sunt echivalente daci acestea genereazi ace|a§i
set de tuple pe orice inscanqé a bazei de date
' ordinea Luplelor e ire\evant5
> Obs: SQL lucreazé cu multiseturi
> Tn versiunea mum'sec a algebrei relaglonale echivalenga 5e veriﬁcé relativ la multiseturi de cuple
F 31

***************Ending Page***************

***************Beginning Page***************
***************page number:33**************
Reguli de echivalenté
l selecﬂa pe bazé de ccnjuncgii e echivalenté cu c secvengﬁ de seleqii
Um”! (E) = 0U‘ (0,: (5))
z operagiile de selecgie sum comutative
6m (501(5)) = 6015MB)
a Tntr»un §ir de proiecgii consecutive doar ultima efectuati e necesari
1-11‘(l'11‘(»~(l'1,”(E))-~)):l'll,‘(E)
4 selecgiile pot ﬁ combinate cu produsul cartelian §i teta joinurile
2- “MEI X E1) : E‘ W (-1 E;
b- 6M5 W 01 E1) = E‘ >4 mm Ez
33

***************Ending Page***************

***************Beginning Page***************
***************page number:34**************
Reguli de echivalenté
5 operagiile de [eta-join §i de join nacural sunt comutanive
E|l><le 51:51 We El
a a) Operagiile de join natural sunt asociative
(E| l><1 EZ)I><1 E3 = E| l><1 (E1 l><1 E3)
b) Opemgiile de teta-join sunt asociative astiel:
(5| Wm Ez) I><1 01A 03 E; = E‘ I><1 0|A01(Ez I><1 01 Ea)
unde Glimplici atribute doar din Ez §i 1':J
34

***************Ending Page***************

***************Beginning Page***************
***************page number:35**************
Reguli de echivalenté
[>49 Rule5 [>49
/ \ / \
E1 EZ E2 E1
[>4 Ruleéa [>4
/ \ / \
M E3 E1 [x1
/ \ / \
\ 1 E2 E2 E.
68 Rule7a N
l>|<1 lfﬁnnlyhm 6/ \EZ
‘\kmbutes frum E1 e
./ \. l
H hZ l1]
p as

***************Ending Page***************

***************Beginning Page***************
***************page number:36**************
Reguli de echivalenté
7 Distribuﬂa seleqiei asupra operatorului de teta-join
‘ (ind 0° Impllca ambute dozr dm um dlmtre expresMe (5,) am |0|n:
“MEN n E1) : (“NEON n E1
; (ﬁnd 0 ‘ Impllci Mm. atrlbute dm E‘ $01 Impllci Mm. zmbute am £2;
Gum: (51M 0 51) = (WKEIWQ n (601 (51))
p as

***************Ending Page***************

***************Beginning Page***************
***************page number:37**************
Reguli de echivalenté
s Disxribusia proieqiei asupra tera-joinului
‘ daci e Impllci numal zmbute am L, u L1:
U1.‘u,.,(E| M5151):(n14(5|))>%(n1.1(51))
Fie pinul E‘ M‘, £1
Fie L, si L1 mulﬁmi de atribure din E‘ si respectiv E2
Fle L, ambuce mu E, care sun: Imphcate in condlgla de 1m" 0, dar nu sun: in L‘ L/ L1,
He L4 ambute mus2 care sum. imphcate in condma de join e, dar nu sunt in L‘ v L1
nu“; (E, W951): HM‘: ((l-[LIHL (51)) Wad-[mu (51D)
p a7

***************Ending Page***************

***************Beginning Page***************
***************page number:38**************
Reguli de echivalenté
q Opemgiile de reuniune §i interseqie pe mulgimi sum comutative
EI u E2 = E2 u E‘
EI m E2 = E2 n E‘
m Reuniunea §i intersecgia pe multjmi sunt asociative
(EI u El) u E3 = El U(E1UE3)
(a n E1) m E1 = E. m (E1 n 5,)
n Selecgia se distribuie peste um §i i.
0'0 (Ex i 51) = 013(5)’ 50(51)
similar pentru u §i n in locul i
0'9 (5| - 51) = (76(5) - 51
similar pentru n in locul <dar nu pentru u
lz Proiecgia se distribuie peSle reuniune
HL(EI V E2) = (11(5)) v (TUEQ)
38

***************Ending Page***************

***************Beginning Page***************
***************page number:39**************
Optunlzén
Implngerea selecmlor

> Numele cliengilor care au un cont la o ﬁlialé din Brooklyn

> Pe bzza regulii 73

nmmuﬂm. ((memm :“amw (bm'Id'D M (“mum M dEPﬂsiw'»

> Realizarea selecgiei in primele etape reduce dimensiunea relaﬂei care participi in join
Immdv m-mm/ dqvosflov Ins/0m"
Why, U,” yum/MW metmmm u!~‘h“\m,~;lm1
Wm ’ ﬁnkmu‘ uhlmm'lullg/

lmuv hm mn-ur
} 39 nwmwl

***************Ending Page***************


***************Beginning Page***************
***************page number:40**************
Optimizéri

Impingerea selectiilor
> Numele cliengilor cu un cont la o ﬁliali din Brooklyn care are 1mm peste

IOOO
nmmmummJmemhjw =“Brook\yn" A baiance > woo
(branch l>< (account l>< depositor»)
> Regula 6a (asociativisatea la join)
ncuxwmer,name((D-bmnch,uxy : 'Bmklyn“ A balm, > IOOD
(branch l>< accounm l>< deposiw!)
> A doua formi furnlzeali oportunltatea de a electua selecgia devreme
“WNW :“Bmuw (brunch) W 6 Mm. > looo (ﬂmm)
P 40

***************Ending Page***************

***************Beginning Page***************
***************page number:41**************
Vizualizare sub formél de arbori
11 (ummzumm
H caslomeriname l
L M
mmﬂqﬂumuyn
Abalmlm<klﬂﬂ / \ .
[>4 depusxmr
|><1 / \
mnCh/ >N\ 1|? bpmgh,my:Bzookl)/T~ Tulamdonn
acmlmt depusiior branch account
(a) Imtlal expression tree (b) Tme after mulhple transformations
4|

***************Ending Page***************

***************Beginning Page***************
***************page number:42**************
Optimizéri
Impingerea proiecﬁilor
l'lmwmerﬂmtmmmw :“Brooldyn” (bruﬂch) M account) W depOS/W)
> Eliminarea atributelor care nu sunt necesare din rezultatele intermediare
nmwm. ((
l'lmmﬂm (Gummy, :“WM (branch) Mﬂwwm )
I>< depositor)
> Realizarea devreme a prciecgiei reduce dimensiunea relagiilor din join
P 41

***************Ending Page***************

***************Beginning Page***************
***************page number:43**************
Optimizéri
Ordonarea j oinurilor
> Pentru orice relagii rLrl'si r3»
(erQMr; I'M (QMQ)
> Daci r,l>< r] are dimensiuni mari §i r‘ Mr, e de dimensiuni mai mici.a|egem
(n M G) M '3
> Exemplu
“WWW” ((Ummm : “Emoklyn“ (bm'ldw
I>< (accountW depositor»
Numai un mic procent din cliengi au conturi in ﬁliale din Brooklyn deci e mai
bine $5 se execute mai intii
GMMY Z “MM. (brunch) M account
> Pentru n relagii existi (2m , |))!/(n i I)! ordoniri diierile pentru join.
n = 7 r> 665280, n = \0 r> \ 76 m\|iarde!
> Pentru a reduce numérul de ordoniri supuse evaluérii se utilizeazi
programarea dinamicé
4:

***************Ending Page***************

***************Beginning Page***************
***************page number:44**************
Estlmarea costunlor
> 1,; dimensiunea unui tuplu din r.
> n; numirul <15 tuplein relagia r.
> b;num5ru| de blocuri ccntjnind tuple din r.
> ﬂfuctorul de m0: 3| lui ri nr. de tuple din r ce intri intr-un bloc
> Daci (uplele lui r sunt stocate Tmpreuni mm" ﬁgier. atunci:
b {mi
r, i
frl
> V(A, r): numirul de valori distincce care apar in r pentru atributul A; e echivalent cu dimensiunea
proiecgiei HA0) (pe seruri).
> Estimarea vizeazﬁ numérul de tuple rezultat iar optimizarea vizeazﬁ reducerea numérului si dimensiunii
tuplelor cit mai devreme
M

***************Ending Page***************

***************Beginning Page***************
***************page number:45**************
Estimarea dimensiunii selecgiei
' 6A=1(')
> n, 1m,” :numirul de fnregmrin ce 5mm selecgia
> pentru acribu: cheie: |
> 05W) (cazul 0A Z v0) este simetric)
> ma sum: dlspomblle m\n(A‘r) 5| max (AJ)
Odzciv < Mun
n v’m|n(A,r) “dd
' "BX'A,V)’XHIII(AJ‘)
> ma sum: disponibile hismgrame se peace Farm esumarea anterioaré
> in up“ Omarel \niormagll stausuce dlmenslurlea w consideri a ﬁ ",12,
} 4S

***************Ending Page***************

***************Beginning Page***************
***************page number:46**************
Estimarea dimensiunii selectiilor complexe
> Selectivimea unei conditlii 6| este probabilitatea ca un tuplu in relagia r :5 satisiaci 6,
> a“; numirul de mple (e sauslac n, esze s‘ , selecuvmnea E s‘ In,
> Coniunqia (in ipoteza independenyei)
6M“. Wm: n ‘SI *Sz * *S~
> Disjunqia " n,”
Jew 91v. v 9N)!
n, *[1-(1-i)*<1-¥)*m*(1-i)]
ll, n1 ll,
> Neguia
0;‘,(r): n,—sAze(o-9(r))
p 46

***************Ending Page***************

***************Beginning Page***************
***************page number:47**************
Estimarea dimensiunii joinului
> pentru produsul cartezian r x s: n,* n; 1up|e,ﬁecare tuplu ocupE s, + s3 octegi
> pentru r [>q s
> R!\S= 5”]an
> R m s este o [superkhele penuu R:<: "x
> R m s = (A) nu e cheie penzru R sau s; sau
n, *"J M
minimul este consideralde lemme mm mare V(A,s) WA’)
daci sun! dlsponlbﬂe hmograme Se cakuleaxé (armulde anmrioare pe ﬁecare cehlli pemru CEle doui rekqh
p 47

***************Ending Page***************

***************Beginning Page***************
***************page number:48**************
Estimarea dimensiunii pentru alts operatii
> Prciecgia Hm; my)
> AgregareazAgﬂ): V(A,r)
> Operagiipe mulqmi
> 1 v s: n, + n‘.
> r n 5 :min(r\y , n3)
v join excern
> r j><szd|m(r Ms) +n,
> , Ms :d!m(r Minn,“
V 6m (r) r‘- 0'92 (r) echivalent cu 00. 602 (r)
> Estimatcrii furnizeazi in general margini supericare
p as

***************Ending Page***************

***************Beginning Page***************
***************page number:49**************
Optimizarea planului ﬁzic
p w

***************Ending Page***************

***************Beginning Page***************
***************page number:50**************
Estimarea costului la nivelul planului ﬁzic
> Costul e in general misum ca durata de timp necesaré pentru returnarea rispunsului
v Accesul la disc este costul predominam

> Numérul de ciutiri * l5 (limpul penlru o localizare a unui bloc pe d\sc)

> Numirul de blocun cilite/scrise * c, ((impul de (ransier)

v coscul CPU e ignora: pentru SHHPHEAKE
> Costul pentru transferul a b blocuri plus s céutiri pe disc:

b * z, + S * zS
p so

***************Ending Page***************

***************Beginning Page***************
***************page number:51**************
Algoritmi pentru selsctie

> Ciuzare liniari (mu scan)
> cost: bx (T + k
> dacé selecg'a e pe un atrlhul: cheie,cosm\ estlmauv. b/Z * 11 + [5
> poate n aphcaté mdiferent de comma de se\eqie, ordcnarea anegxsxririlor in ﬁgien existeng mdecgilor

> Céucarea binari
> aplmbua pentru condiw' de selecgie de mp egzhtate pe ambucul aupa care e ordonat ﬁ§|erul
> costul gisirli pmmului tuplu ce satisface condmﬂloglwﬂ * (1, + IX):dac5 exmé maI mm tuple se adaugé

(impul de transler a\ blocurilar

> Scanarea indexului , condiﬁa de seleqie : cheia de céumre a indexului
> index primar p2 cheie mam. egalitate; m + I) * (r, + =5)
> index primar pE non-chele, Egallmte: h, * (t, + [5) + I; + z, * b
v mdex secundan egalime‘ n mpde remrnam: (11‘ + n) * (t, + 1;)
> index primar, compamge: h‘ * (t, + 13) + 13 + z, * b

p 5|

***************Ending Page***************

***************Beginning Page***************
***************page number:52**************
Algoritmi pentru selecpii complexe
r Conjuncgie: O'B'A 92A, . ,e"(r)
> utilizarea unui index pentru 0, §i veriﬁcarea cekwrlalle condi§ii pe masura ce tuplele sunt aduse in
memorie
> utilizarea unui index multi-che\e
> interseqia identiﬁcamrilor (pointerilor la fnregistrin) returnam de indeqh asociaq condiyiilor
urmati de citirea anegistrérilor
r Disjuncgie: celv 91 v. . . a“ (r)
> reuniuneaidemiﬁcatorilor
p 52

***************Ending Page***************


***************Beginning Page***************
***************page number:53**************
Algoritmi pentru join
> Algoritmi:
> pm cu bucle \mbncate (nested-loop 10m)
> pm mdexatcu buds imbricate
> 10m cu ‘uzlune (merge 10m)
> 10in hash
> Alegerea se lace pe baza escimérii costului
> Sun! necesare estimiri realizaw la nivelul planului logic
p 53

***************Ending Page***************

***************Beginning Page***************
***************page number:54**************
Join cu bucle imbricate
> Pentru teta-ioin: 1M 0 s
[or each tuplu t, in r do begin
(or each tuplu ts in s do begin
if (gs) satisface 0
adaugi r, - rs la rezultat
end
end
> relagia interioari - s
> relagia exterioari - r
> Costul estimat: (n, * by + b,)*z, + (n, + b, )*ts
S4

***************Ending Page***************

***************Beginning Page***************
***************page number:55**************
J 01n 1ndexat cu bucle 1mbrlcate
> Ciutirile in index pot inlocui scanarea ﬁ§ierelor due;
> e un echlqom sau 10m mum
> exisri un \ndex pe acributul de 10m al relagim interioare
> pentru ﬁecare tuplu e, in relaqa exterioaré r se ulilileazé indexul pentru localilarea {uplelcr
din s care satisfac condiﬂa de join cu uplul z,
> costul: b, (z,+ 1;) + n, * c
> c esLe (05ml parcurgeru mdexulm pentru a returna mple dm s care se patrivesc pemru un cuplu dm
r (emwalent (u selecpa pe s (u tondlga de jam)
> daci exmi indec§i pemru ambde rem", relap'a cu ma\ Mme We va n preierati drepl relaye
exterxoari Tn 10m
> Exemplu
> depositarMcusmmel. deposits! relagie extenuari
> (ustcmer are Meme un Index prlmar de [lp Bﬂarbure pe amburul de 10m customer'nume, (u 20
intrirl pe nod
> customer: mono (up\e(l=25),depos:tar:5000 :uple 14:50)
ccsw‘: IOO + 5000 * 5 = 25.“)0 blocuri :mnsleraie 5| ciuréri (corespondentul Tn jcmul
nelndexal:1.000.\00 blocun xramlenze ;i = 5 |00 (imiri)
p ss

***************Ending Page***************

***************Beginning Page***************
***************page number:56**************
Join cu fuziune
> Algoritm
se sortezzé ambele relagl in luncge de atributul de join
> are lo: (utlunsa rehvﬂor
> Poate ﬁ utilizat dear pentru echi-juinuri
> Costul:
> b, + bi blocuri Lransfemte
> + costul Sortiru relagﬂor
> join cu fuziune hibrid: O relaye esle sonati \ar a doua are un index secundar p2 atribulul de pm de tip B‘-arbore
> relaga Sormlﬁ (“Imam (u \ntrérile de pe nivelul frunzé 3| arborelui
p sa

***************Ending Page***************

***************Beginning Page***************
***************page number:57**************
Join hash
> aplicabil pemru echi-join
> o funqie hash h ce ia la intrare atributele de join partiﬂoneazi tuplele ambelor relaﬁi in blocuri ce
incap Tn memorie
> n, r2, .1"
> s‘ 51‘ v.5“
> zuplele din r‘ sum comparate doar cu tuplele din sv
I‘ |-"I'-|
p s7

***************Ending Page***************

***************Beginning Page***************
***************page number:58**************
J 01nur1 complexe
> Condiﬂe de tip coniuncﬂe: r We“ 92AM 9" s
r bucle Imbrlczce cu verlﬁcarea cucuror condigiﬂor szu
> se cakmealé un 10m mai simplu r [>15 5i se reahleazi selecqa pentru celelake
condigii
> Condiﬁe de tip disjuncyie: r >40‘ v my N0":
> bucle \mbncate cu venﬁcarea condwnlor sau
> calculul reuniunh ioinunlor individuals (aplicahﬂ numal versiunh set a reuniunu)
(r m») v (r Mm UV ‘v (r ms)
p ss

***************Ending Page***************

***************Beginning Page***************
***************page number:59**************
Eliminarea duplicatelor

> Sorcarea tuplelor sau hashing

> Fiindca e costisitoare, SGBD-urile nu elimina duplicatele decat la cerere
Sq

***************Ending Page***************

***************Beginning Page***************
***************page number:60**************
Evaluare expresnlor
r Alternative:
v Materializarea: (sub)expresiile sunt materializate sub forma unor relapi scocace pe disc pennru a ﬁ
dale ca immre operatorilor de pe nivehe superioare
> Pipelining: luple sun: date ca intrare operagiilor de pe nivele superioare imedia: ce acestea sunt
returnate Tn limpul procesini unul opemtor
: nu e Tnloldezuna pombﬂ (xorlare.ioin huhi
variama I; cerere: nivelu‘ supermr soliciri noi wple
varianta la producimr: operatorul scrie in buﬂer (uple iar pirimele scoate din buﬂer (la umplerea huﬂerului existi
nmpi de a5wpum)
p so

***************Ending Page***************

***************Beginning Page***************
***************page number:61**************
Planuri de executie
Oracle
> lnregistreaza planul:
EXPLAIN PLAN
[SET STATEMENTJD : <id>]
[INTO <mbleiname>1
FOR <squratement>;
Pentru once ccmanda DML
> Vizualileaza planul:
SELECT * FROM table(dbmsixplan.display);
szu
select * (rem plan_tab|e [where smtement_id = <id>];
http://wwwnrac|e.com/technetwork/databaselbi-datawarehousing/twp-explain»the-exp|ain»plan-OSZO| I»
393674.pdf
5|

***************Ending Page***************

***************Beginning Page***************
***************page number:62**************
Planuri de executie
Oracle-statistici
> Table mtistics
> Number of rows
v Number o! blocks
> Average rowlength
v Column statistics
> Number of distinct V3|LIES (NDV) in column
> Number of nulls in column
> Data distribution (histogram)
r Index statistics
> Number of leaf blocks
> Levels
> Clustering factor
v System statistics
v l/O performance and utilization
> CPU performance and utilization
p 62

***************Ending Page***************

***************Beginning Page***************
***************page number:63**************
Planuri de executie
Colectarea statisticilor
> Proceduri Oracle din pachetul DBMS_STATS:
> GATHER_|NDEX_STATS
> Index stzusucs
> GATHERiTABLEiSTATS
> Tabkx <0lumn,and index stansncs
> GATHERiSCHEMAiSTATS
> SIAUSUCS (or all abiccts m a schema
> GATHER_DATABASE_STATS
> SIAUSUCS (or all abiccts m a database
> GATHER_SYSTEM_STATS
> CPU and |/O smusucs (or (he system
> http://docs.oracle.comlcd/B Iosooio |lserven920/a96533/stats.htm
P 63

***************Ending Page***************

***************Beginning Page***************
***************page number:64**************
Planun de executle
Hlnts
> In cadrul unei comenzi DML este posibil a instrui optimilalorul Oracle asupra planului de execulie:
SELECT PM USEiMERGHemplcyees departments) */ * FROM employs“,departmentsWHERE emponeemepmmde =
departmemsdepartmentiid;
hupzl/ducs uracle.mn\/:d/B I may \ /serven l ﬂl/b l 4200/:qLelememxﬂﬂémm
64

***************Ending Page***************

***************Beginning Page***************
***************page number:65**************
Bibliograﬁe
> CapWoMc n g l4 In Avi Silberschutz Henry F. Konh s. Sudurshun. “Database System Concepts”. McGraw-
Hill Science/Engineering/Math; 4th edition
P 65

***************Ending Page***************

