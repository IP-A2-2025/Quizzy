***************Beginning Page***************
***************page number:1**************
1
The Expectation-Maximization
(EM) Algorithmic Schema
Contains:
ex.1,2.5,G,7_R,11_27.14,31_12,34_35.15,lﬁ_17,18
from ‘he 2023f vsrsinn of the NIL axarnise hunk by L. Cinrhlz at al.

***************Ending Page***************

***************Beginning Page***************
***************page number:2**************
2
Algoritmul EM, fundamentare teoreticﬁ:
pasul E [§i pasul M]
CMU, 2008 fall, Eric Xing, HW4, pr. 1.1-3

***************Ending Page***************

***************Beginning Page***************
***************page number:3**************
‘X
Algoritmul EM (Expectation-hiaximization) permits crearea unur
modulo probabilistc care p0 dc 0 part0 dcpind do un sot dc paramotri
o m pe de alté pane includ p9 langa variabilele ubi§nuite (“observabile"'
sau “vizibi1e") .1 55 variabile necunoscute (“neobservabile“, “ascunse” sau
“latente”) z.
in general, in “ml do sitnaﬁi/modclu, nu so poatc face in mod direct
Q estimate a parametrilor modelului (o). in a§a fel mom sé se garanteze
atingerea maximului vemsimnnsgii datelor observabile 1:‘
in “111mm algoritmul EM procedeazé in manieré iterativé. constituind ast-
fel 0 lnodalitate fnarte (:nnvenabilﬁ de 95mm a paralnetrilor a‘
Deﬁuim lng-vernsimilitatea (1mm observahile (1) ca ﬁiud 10g Pm \ a), iar
logiverosimilitatea datelor complete (observabile,1,§ineobservz\bile, z) ca
ﬁind 10g, Pp“: \ e)‘
Observaﬂe: Pe m parcursul acestui exercigiu SE va considera funcgia lug
(:a avimrl baza suprallnitaril, ﬁxatﬁ.

***************Ending Page***************

***************Beginning Page***************
***************page number:4**************
1

a. Log-verosimilitatea damn" abservabile (1r) SE- poate exprhna in funcﬁe
de datele neobservabile (z). astfelz”

[(0) “3 logP(:r \ 0) flog (2111.; \ 01>
in continuare vom noLa cu q 0 funcgie / distribugie de probabilitate deﬁnité
pesto variabilclc ascunsc/ncobscrvabilc ;.
F0105“; inegalitntea lui Jensen pcntru a domonstra c5 are 10¢ urmﬁtoarca
illegalitate:

1m , z \ e)
lugPU, a) 2 ‘1(1) lug; (i (n
‘ z 11(1)

pentru orice .1; (ﬁxat), pentru orice valoare a parametrului 0 5i pentru orice
distrilmgie probabilisté q deﬁnitii paste variabilele neobservabile z‘

***************Ending Page***************

***************Beginning Page***************
***************page number:5**************
Observagie (1) J
Semniﬁcagia inegalimégii (1) este urmétoarea:
Funcgia (d9 fapt, orice funcﬁe de furma)
m1 P(.1,: 6)
F(q.H) i 21mm; (i‘
i ‘1(1)
constituie o margine inferioaré pentru funcgia de log-verosimilitate a
datclor incomplete / obscrvnbilc, [(0) ‘J log m1 \ H).
Remarcaﬁi faptul (:5 l" cstc 0 funcﬁic dc doui variabilc, iar prima wriabili
nu este de tip numeric [cum este H). ci este de tip funcgional‘
Mai mult, se observe‘ c5 expresia funcgiei F este de fapt 0 medie,
Pym H)
E, :> [mi ,
‘l 11(1)
atunci cénd 11,‘, q §i paranletrul f1’ 5e consider?! ﬁxagi, iar g este 13553‘. $5
variczc.

***************Ending Page***************

***************Beginning Page***************
***************page number:6**************
a
Solugle
lnegulitatea mi Jensen, in cuntextul Leoriei pmbahunaguon
considerind x este D variabilé aleatoare (‘m-Ma),
daci ,~ este D funcue (reali) convexi. atunci ¢(E[X]) < E[;(X] ;
dacé p este funcﬁe cuncavi, atunci ¢(E[X]) > E[;(X\ _
Aici vuln r01»; l'uncgia log cu bazfn supraunitzu'ﬁ (rm-cue concavii), am nplicﬁnd illegal»
itateu lui Jensen vum ow“: l<»,=.(E[X]) 2 E 10;;(X) ‘
Log-vcrosimilitatea dalolor ubservabile este:
I'M-1H!)
IH]’V‘0P| m i IQ P|:6 flog ‘mi
< g< g;(\> 211w)
a‘, 1%,": mD
I log I; z i
< ‘l J[ (All
. . . . . Hum) <
Conform megamag“ 1m Jensen (mlonumd X de mal sus cu T), rezulta:
'1
Pu : \ a) M mi : m]
[H :'10P[rH>E,,[|<»,u_ I 1110 .
(1 g \ 1 M “(2) Z 1(1 F. W]

***************Ending Page***************

***************Beginning Page***************
***************page number:7**************
7
Notagie
In continuare, pentru a v5 aduce mereu aminte (:5 distribuﬁa q 5e referé
la datele neobservabile :, vom folosi notagia 4(1) in loc de I,‘
In consecinga. in cele ce urmeazé, in funcﬁe de context‘ 11(5) va desemua
ﬁe distribugia q, ﬁe valnarea acestei distribugii penml n valnare oarecare
[a variabilei neobservabile] ;.
(Em adcvérat 05 accasté lcjcré ambiguitatc poatc induce in croarc citi-
torul neexperimentaL)

***************Ending Page***************

***************Beginning Page***************
***************page number:8**************
3

b‘ vé reamintim deﬁuigia entropiei relative (numité §i divergen§a
Knllback-Lciblcr): i i

, P : 1.0)

A Mm u m \ T 1m I 2 qu m (%)

Arétaﬂ 65

lug P(;1: \ a) 2 F(q(:),H)+/\’L(q(z) H P(:\.1:.H))
Obscrvagic (2):
Semniﬁcaﬁa egalitﬁﬁi Care trebuie demonstratﬁ la acest punct este fuarte
interesantil: diferenga ‘1mm. fumgia nbiecﬁv {(0) “2 log P(_1 \ a) §i marginea
sa infcmara 1“(1/(z).0) 2 a so vcdca punctul u 2 05m mum) H m; \ mm.
Tocmai pe aceasté chestiune se va “construi” punctul ﬁnal, §i cel mai
impnmm, a1 prublenlei noastre‘

***************Ending Page***************

***************Beginning Page***************
***************page number:9**************
9
Observagie (3)
Idcilc do buzz‘: ale algoritmului EM sunt doui:
1. in loo 5:1 calculczc maximul funcﬁci do Iog-vcrosimilitato log P(_1, \ e) in
rapurt cu 0, algoritmul EM va maximiza marginea sa inferioara, ‘Ln/(11.0),
in raport cu ambele argumente, 4(1) §i e,
2‘ Pentru a céuta maximul (de fapL, un maxim local al) marginii in-
fcrioarc F(q(:).9), algoritmul EM aplicﬁ motoda cre§terii pe coordzmatc
(engL, coordinate ascent): dupa ce animal se ﬁxeazé W eventual aleatoriu,
se maximizeazé itemtiu funcgia F(q(:).H), in mod albemabi'u: mai intéi in
raport cu distributia (1(2) §i apoi in raport cu paramotrul H.
Pasul E: 11"‘(Z) I nrgnmx F(q(:) W‘)
aw
Pasul M: 0W" : arglnaxl"(q‘n(:).ﬂ)
ﬂ

***************Ending Page***************

***************Beginning Page***************
***************page number:10**************
10
Solugie
F(11(1).6) "2 2mm; (W)
i :ch [10W + mm ‘ 0)]
I 211(1) 10% (W) + 211(1) 10am ‘ H)
I :KLWZJ H P(Z‘*"”>1*hw<.rw> 2m
:> 11%me :1-‘(q(:),ﬂ)+1vL(q<;) H HIM/1)).

***************Ending Page***************

***************Beginning Page***************
***************page number:11**************
11
Obscrvaﬁc (4)
Conform pruprietégii M11) H q) > o pentru VM, rezulté 1(L(q(;) u Pt; \
m. M) 2 n‘
Agadar, din egalitatea care tocmai a rm demonstraté la punctul h obginem
(din nuul, dupa rozultatul dc la pumml n) “a F(q(:).6) cm, Q marginn
inferioaré pentrll log-vernsimilitatea datelnr observahile. ((0) ':' 10;; P( r \ a).

***************Ending Page***************

***************Beginning Page***************
***************page number:12**************
12
c. Fic 0v! valoarca obqinuta pcntru paramotrul / parametrii 0 la imamr
a algoritmului EM‘ Considerénd “Basra valoare ﬁxaté, amagi c5 maximul
1m F in “pm C“ argnnlenhll / distribuﬁa (1(2) we aﬁns pentrn distribugia
H; \ 111W). iar valoarea maximului este:
nmx 1701(1). 6"‘) : Em‘, “II/MM P(|:. 1 \ 5W + H(P(z \ 11.490)»
M

***************Ending Page***************

***************Beginning Page***************
***************page number:13**************
13
Solugie
Trebuie 55 maximizém mm). Hm) i marginea inferioaré a 10g-
verosimilitiaﬁi dawn» observabile .r in Rpm cu distribugia r](:).
PE de 0 pane, rezultatu] (is! la punctu] n ne 5pm“! “a mm). H) g 10g P(r \ a),
pcntru oricc valoarc a 1m 0; in particular, pcntru 00> avcm
10g, Pu \ W) 2 [Tu/(1)6“)
Pc do alt?‘ part6, dam; in cgalitatca domonstraté la punctul h sc inlocuic§tc
o cu 0W, rezulté:
l<)gP(1,\H"7)* F[q(z),H(’)) + KL(q(z)HP(:\1,HW])
in ﬁne, dacﬁ alcgom ‘1(2) : m; \ .119“), atnnci mmcnul KL((1(2)HP(: \
1.0m» din dreapta egalitégii d9 mai sus devine zero (vezi exercigiul [PS731]
de la capitolul de Probabimagi §i statisticé).
A§adar. valoarea umWFrq(z)+/<"1 se obgine pentru distribugia 11(5) i P(;/ \
1.6m).

***************Ending Page***************

***************Beginning Page***************
***************page number:14**************
14
Acum vom calcula aceasté valoare maximé:
logP(_'17 \ 6f”) 2 my mm 0"‘) 2 mm \ WM“)
1,1,
W ~ . m ‘ w
i ZIP(JJ.” )"’*(P(; ‘I W)
I‘ mm \ em)
i LP(1\|0W) [MW
2 E,,(,‘,m,,,[1ug P(|,,z\9[“) 2103 P(;\;1:.H(‘7)]
2 EPWW, [10g P(',,:W)] 2 EPWW, [10g P(Z\,-.e“1)]
2 FJP'ZL, M [10g mm 1WD] + H[P(Z\fr.€m)]
2 (3(0") mm) \ 11[1’(z\1.0(")]
undo 0m \ m") 2 EM EmﬂlogPQLJ \ an.

***************Ending Page***************

***************Beginning Page***************
***************page number:15**************
13
Observagic (5)

Noténd we) “if I-‘(P[z \ mmm, din calculul de mai sus rezulté c5
(14W) : 1m; P(.1 \ Hf") : QM’? \ W) + H(P(: \ "Wm Se pmm! (lenmn-
Sm u§0r i procedfmd similar cu calculul dc mai sus i cgalitatca

(3(a) i ()(H \ W) + Hm: \ 1,9“)
Observénd c5 termenul H[P(: \ 1.810)] din aceasté “lama egalitate nu de-
pindc dc 0, rczultz“! imcdiat c5

aygnmx 01(0) i al'gmaxQU) | 9W)
5 g
in consecin§5,
9”“ ‘i’ m'gmaXF(P(z \ 1.90)).H) i m~gmxc,(e) i argumwa \ 9W)
ﬂ ﬂ n

***************Ending Page***************

***************Beginning Page***************
***************page number:16**************
15
gum
Fkom: ‘ log P006)
What is the expeclatinn mlm'mizm and)
tizm algorithm?
Chuong B. Do, Seraﬁm Batzuglou, gm ‘
Nahlre Bimerhnnlngy_
vol, 26, no. 8, zoos, pp. 897-899
91-1
g,

***************Ending Page***************

***************Beginning Page***************
***************page number:17**************
17
Egalitatea precedenté este responsabilé pentru urmamama reformulare
(cea uzualé!) a algoritmului EM:
Pasul E’: calculeazé 0(0 \ 0W] : L'P(,‘,M[1og1>1(1,z\011
Pasul M’: calculeazé W ‘ H I mgnmew \ W)
u

***************Ending Page***************

***************Beginning Page***************
***************page number:18**************
18
Algoritmul EM:
monotonie / convergentgﬁ
preluxtrare (1e Lava“ cam“, dups
eluwikipediaorg/wiki/ExpectMinn-maximization

***************Ending Page***************

***************Beginning Page***************
***************page number:19**************
19
Pom“ a maximiza functia dc log-vcrosimilitatc a datclor obscrvabilc, m
1(a) “2 1w; P(;| \ a), unde baza lugaritmnlui (MSW-15mm) ask-s musidema
supraunitarfx, algoritmul EM proccdcazi in mod imam, optimizénd la
pasul M 31 ﬁecérei iteragii (L) 0 funcgie “auxiliaré”
VI!’
Q(0 W) i Em‘, ﬁn~,][logP[:r.: \ on.

reprezenténd media log-verosimilitégii datelor complete (observabile §i
ncobscrvabilc) in raport cu distribugia condigionala P(z \ 1.0”).
v0.11 considera immune r I 0.1. , §i W" I Mgmmrgm \ 9W), (:u 0W1 ales
in mod arbitrar,
Dcmonstrati c5 pcntru oricc t ﬁxat (arbitrar) 5i pcntl'“ oricc 0 astfcl inczit
()(e \ W) g QM’? MW) are 10¢ illegalitatea:

log PM \ H) , log PM \ H”) 2 0w \ 6"’) , (2W W”) <2)

***************Ending Page***************

***************Beginning Page***************
***************page number:20**************
.. 20
Observagll
1‘ Semniﬁcagia imediaté a relagiei (2):
Orice imlmuamagire a valorii funcglei auxiliare ()(ﬁ l 9”’) cnnduce la 0
imbunétégire cel pug“ la fel cle mare a valurii funcgiei obiectiv, 1(1)).
2. Dacé in inegalitatea (2) 59 inlocuiegte l} cu 11W“ : al'gluzlxﬂQU) l W), va
rezulta
log P(.r l W") 2102170»qu lug m, a)

in ﬁnal, vom avea log ml 0W";
([HW') 51‘(H('>)§/(H“">)§m . -

‘ log Pure“; J
51ml acesta (monoton) este
mﬁrginit superior dc U (vczi Q(e"‘“la"‘> \
deﬁnan lui l)‘ deci converge la Q(e“'le“') ’
0 annulus valoare PM In anulnite Q WW“)
cazuri / condml, accasté valoarc
este un maxim (in general, local)
a1 fumgiei (1E! lug-vernsiinilitate. e'” 9”“ s

***************Ending Page***************

***************Beginning Page***************
***************page number:21**************
21
Observagii (cont.)
s. Cnnfnrln alieleia§i inegalitilﬁ (2), la pasul M (1e la its-maﬁa r a algoritmului
EM, 05m suﬁcicnt ca in 10¢ 55 sc in W" i argumxﬂQU) \ 0W), 55 so alcaga
HM! astfel incét QUW“ \ W) > QM” \ W)‘ Aceasta constituie versiunea
“generalizatli” a algoritmului ENI.

***************Ending Page***************

***************Beginning Page***************
***************page number:22**************
22
Demonstragia relagiei (2)
P[r,z \ H; : m2 1- a) P[!“H)QIOgPh"H):10gP(I‘,T‘H>*IORPKZ‘A”);
21111.0”: 10mm”):
\‘—v—/
‘
Em; \ 1.0m) lug1‘(|.z 0) i211; \ 1.0m) lugl‘(z \ 1 0) >
lugl'Ll m) Q[U\0‘”)’ZP[: \ m") mm; ‘.0)
Ultimul termen din egalitatea aceasta reprezinté o crossientropie. p2 care o Wm nota
cu (fl-m1 \ 0”‘). AQadar,
MPH \ l7) *Q(”\/'"‘)+CH((/\ﬂ'“)
Aceasté cgalitatc cslc manna pcntru mate valorile posibile ale parametrului 0. in
particular panl-n 11’ 0"‘. vom avea:
luanr \ w) I 0W x W) + 11H[e'~'>\9<'11

***************Ending Page***************

***************Beginning Page***************
***************page number:23**************
23
Demonstragia rela§iei (2), cont.
Scézénrl membru cu membru ultimele doué egalitéﬁ, amine-111
lug 1w ,, \ H; *Ing my \ H") , 0w \ W‘) , QM" \ "1")’(1101 \ m’ mm MW
Conform inegalitéyii Iui Gibbm avem 011(0 \ 11"") 3 (‘11(01H \ W)‘ deci in ﬁnal rezulxé:
mm, \17]*lugl'[x m"; 3 Q(/7\17\"]’Q[0\"‘ m”)

***************Ending Page***************

***************Beginning Page***************
***************page number:24**************
2\

log FLY/6)

ml/
Gmw ) q
HlP(Z/X,' e ""01
m
c,<e 1 m“, ‘ BM)
QtBK) "’)
H[ P(zlx; 9"’ )1
HUI HUM! 011+2/ H

***************Ending Page***************

***************Beginning Page***************
***************page number:25**************
23
A mixture of Bernoulli distributions and

a binomial distribution:

ML-Estimating the parameter using 4 methods:

1. the analythical method, 24 the gradient ascent method,
3. Newton’s method7 4. the EM algorithm

Liviu cam“, starting from:

CIVIU, 2014 fall. W. Cohen, Z, Bar-Joseph, HWl, pr. 2J3

***************Ending Page***************

***************Beginning Page***************
***************page number:26**************
2r»
Presupuncm a; avem doué moncdo: una cstc pal-teem. avénd (loci probabili»
mac-d m.- upurigiv u rem cu Btunlu 1)] : 1/2, m comma munudﬁ cstc lnﬁsluitﬁ
/ irnpcrfccti, avéuld probabilitatuu dc apariﬁc u stun-mi m : 1/3.
Facern 100 de arunciu'i dupi cum “rm-4m De 7%"an
ﬁecare datﬁ alegem una dintre Cele aqua monede. ‘
c“ n probabililma nemnnsrms w, 51?,ng mon- A“
eda perfecté, iar cu probabilitatea 1 , w alegem
max-mm magmas. Considerlhn cf: mu obginul. do l _ 'I _
40 dc m stclnu 11in Lutulul cclur 100 4L- aruncﬁri. X‘E""°"':' 1P P X‘E”"“"”'"
a. Calculagi in manieré directﬁ / analiticé Wm
eslhnarca do vcrosimilitate “mama (MLE) a
parametrului 1. "/ ' W“
b4 in locu] memdei analitice (de la punctul a)‘ pentru estimarea in sensul
verobimilitﬁgii maximc (MLE) a paranlctrului 7r W pom Mm mcdodn gra-
diumului Bu“ Inutudu 1“; Nuwtum Dcducugi rugulilc dc uctuadizurc pcntru
parametrul ."r in cazul medodei gradientului 5i respectiv in cazul metodei lui
NEW1nn.

***************Ending Page***************

***************Beginning Page***************
***************page number:27**************
27

c. Pe léngé 1:212 mi methe de mai sus, pentru estimarea in sensul
verosimilitigii maxime (MLE) a parametrului 71 se poate folnsi 5i algoritmul
EM.

Elaborugi variantu / ,TinstunQXu“ alguritmului EM pentru prublema de ma, m7
hilind mai intéi cine sunt variabilele nhservahile 5i respectiv variabilele neob-
sarvahile. smeﬁ expresia funcﬁei rare trebuie npnmima, iar apni deduceﬁ
formulele de actualizare pentru cei doi pa§i (E §i M) din corpul iterativ a1
ulguritmului.

d. lmplcmmmgi algoritmul EM p0 can) l-ngi ummum 1:. punmu (a Comparaﬁ
numaml de iteraﬁii, precurn Qi timpul necesar pentru a se ajunge la
mnvergmga pm“. cei Lmi algoritmi: algoritrnul EM, me'nda mi New'nn 5i
metoda gradiamului asrendent. Vega fnlnsi in man», male lrei mzmi Emmi val-
narei|\i§iali§1r‘m i nu, precum §iaceea§i condigiede oprire. w’ ‘ WWW < 10 t

***************Ending Page***************

***************Beginning Page***************
***************page number:28**************
2x
Solutie
a. Fie x D variabilﬁ aleatcvare avﬁnd distrihuﬁa pruhahilistﬁ descrisi de mix-
tura de distribugii Bernoulli din ennng. Vom desemna cu Z 1 (respectiv
z n) moneda perfecté (respectiv, cea imperfecté), vum nota cu 11 ma
stelnii (Engl., head) §i apoi vom considcra urmflLoal-ca probabililale:
q ‘i’ 11(x i u) *"L' 11x i111 i1)+1'[x i 11.2 ,0;
P(X m2 l) Prz |)+ P(X H\Z u; I"(Z u)
I I I w
I 2 7r43[17i):3>ﬁ.
. 1' a 1 2 n
ceeacelmplc ,q, TE‘
Dani x’ eslc o variabilé alcamarc Bgnnonm eclnvalentn“ cu mixture: (laté in
cnnng, putcln scrim: X’ ~ BumuullL[q). In Emma, intrucﬁt nu ni ya prucizut ur-
dincuin carc uu rm aminnm culc 100 dc rczultutc / .,Ubﬁcl'vi\§ii“ (dc up ,wma
sau ban), vom lucra En n [a treia] variabilé aleatoare, x” N bmnnnnm M),
unde .- I au 5i n I mu. Aiadar, funcﬁa d2 verosimilitate a dam.“ este:
1 W m 2 W m
W 7.“, m , in! A" , i , , i
L<1 (Mn <1 11> CMK + G) (tJ u)

***************Ending Page***************

***************Beginning Page***************
***************page number:29**************
29
Pntcm scrie acum funcgia de log-verosimilitate a dabelor:
up] I‘, 1 7r 2 w ~
1 *1L.*IC 4m(,,,)+mn(,,,) ‘
<1) n< (Y1) n ‘m, + ., 3 0 ., 3 6
Derivata intéi 5i derivata a dnua pentru runqia r12 lng'vmrnsirnilitate an‘ “swam;
urmétoarele expresii:
l’(’l i ll) 1 w 1 i an (ill i 411*]me
" i H; r» if; ninw 1w’(2<w1(11r)
1U GU
I”? : ,i,i<n v 0.1.
(J (2+7FV (hwy WE 1
reea ce implies“: [aptul Us funrﬂa r (‘-3 5i r) are un singur punct d2 maxim, m aces'a
4i
este obginut Egalénd prima derivaté cu n; i'(:r) Z u c» 7: I mjn Z M <1 [0.1]. A534“,
1H1“: I 0.1.

***************Ending Page***************

***************Beginning Page***************
***************page number:30**************
:10
h. Pam“ me'oda gradientului ascendent, regula de ,,anhlalizan=,“ am
urmémarea:
1' :1 ‘Muméw +1; Juiwur
H 1 r , , (2mm K)
"mle I] este mta de mam.
Penn-u metada 1“; Newton, regulu <12 T,uctuz\lizare“ este “mam-ma;
W W
mm) u i mph) (2+n]l[4iwjl i(2*57r)(‘l+w](4i7r)
1"(m) i <2 + 7m i w] 2612(4 i 1r)‘ + m + ml i 5w’ i 4v‘ + 4-1
Asadar,
ﬁ 7 i(2*5m)[2+m](1*m)
"""" swim“;

***************Ending Page***************

***************Beginning Page***************
***************page number:31**************
c. Asociind ﬁeczwei “observaﬁW din cele 100 despre care este vurba in enung o variabili 31
aleatuure X, N Bm'mmlllm) gi notind x I (20. ,Xnm 1. funcgia de log-vernsimilime a
dam“ “Olsen-while“ va ﬁ scrisé mm:
1wI1nP<Xm:1“((‘.‘&P(X‘: Hf“ Pun : TY") :ln(I/'?I’m11“‘(l , W)»
a,‘ f
~ 74
Dacé notém cu 5| numérul (neobservabil) de aparmi ale Shél'nei pentru moneda 1 (din
mtalul celor HS : 40 de aruncéri) §i cu z“ numérul (neobservabil) de aparim ale banului
pentru lnuneda 1 (din tutalul celor “B Z so d2 aruncZu-i), lug-verosimilitatea datelor
,,cDmplete“ vu putea ﬁ scrisi ustfelz“
,, ‘I mo
[Wm “J 1|1P<X_Z\w) "*2" ZIHWWAZ w) FILM-'1) w
‘A
I i‘ll\(1rm)+(m i ix) WU 40m) + iu1“(1r(1*m)) + ("u fin] WU i ")(1 *II2))
: m“ 1r + 1",“) + [115 i mum i 7r) +h1p2)
+590“? +1141 , 11,1) + (M , 21,](1nu , 1:) + 111(1 , m)
Observatie: in wlagm (a) m“ (‘mmdvnw vsrmlulvlv slvatrmxv (molwrvthllv) Z, luéml "alumna 1
(1W ..ulm\nz\<,ia" 2;, : 1, u hm umhszu unwind munmla 1. Q1 mpww mlmu'ca o um 5-“ mum
monedu 2
M Pmem cmmdeln "s =| "B C, m ‘Mk , obazrvablle“

***************Ending Page***************

***************Beginning Page***************
***************page number:32**************
32
Pasul E
Acum vom putea calcula funcgia ,,auxiliar5“ wa"), folosind propriennea
de liniaritate a mediilor:
Qth) “ll b'[’,,n.‘,,m>] : E[5,](lnw +1np1)+(!15 i Napalm , w]+lnp1]
+E[5u](lnﬂ i mu i m) + ("a , E[5u])(ln[l i w) + 111(1 , p21)
I 4/’ +(E[i‘] + Elm) 1M +015 + 115 *E[5,] i E[iu])ln(l i 7) (4)
_ ‘Eu
Mcdiilo E[i,] §i E[iu] so calculcazﬁ ginind com ca i, ~ EmmmulMOJAU] gi
2‘, N Bm/lmml(lil) ML unde
m
m w , , v7 1”"pr W m
i PZ,’1X,’1,N i
"‘ [ ‘ 7 1 1r"7p|+(li7rm)p;
u) 1,
n, l , , ~> m5” w < p.)
‘1" i P‘Z"1‘X”0‘" J ’ 1r")(1iln)+(l*1r('>)(l*m)
reea re i dat ﬁind of: EMITHUHHXHI‘.I141)‘ : "11* implicé
£51]: my‘ 5i Em] : soul)”

***************Ending Page***************

***************Beginning Page***************
***************page number:33**************
33
Pasul M
BMW’) g, 1;[2,] + Em] i H5‘ + my i L151’ Em]
aw 1r 1 i 7r
a , , r
gw; : u a u *77[F[1\] + F4201) : mm +11” *LEquml
ﬁw , i 1i ml <5)
">- + n ,w
Se pnate constata u§or r5 derivata a dnua a ﬁlm-mi anw) in vaport cu w me negativé
p0 mm domoniul oi do dcﬁnigic‘ coca cc implicé mm“! cé 50mm primei dcrivatc (care a
fusl calculuca lnui sus) cstc punct dc lnuxinl pcnh'u ()(ﬂﬁm).
Obseruali smmmcam rezultatului (a): mm] v 13pm} reprezima mite Amman a“ 11m
Eicute (in medie) cu muneda 1 (la iteragia r), deci Esta "Damn-Eu“ ca 1: 5:‘ deviné (pEnLru
iteraﬁaf > 1) raportul dintre E[m.] > Ehm] qi numirul total cle arunciri, m x n“.
Concluzionénd, regula de actualizare pentru Pasul M al algoritmului EM pentru re
znlvarea prnhlamei de astimare a parametrului 1r a] dis'ribuﬁei prohahiliste descrise in
enunwl problemei este urmémarea:
WHH) : 4W5” +60%” I 24§')+3<1§"
100 5

***************Ending Page***************

***************Beginning Page***************
***************page number:34**************
34
Pseudo-codul algoritmului EM
pentru rezolvarea problemei de tip MLE din 6mm;
“Wham
ambme o vamare avbmravi W” m mien/2M (0,11 penlm pavemetml w‘
Comm ixemw
pentru! u Ti] (cu T ﬁxal'm Mm)
(53“ pénizind w ﬂwn <0cuIﬁxaanavansjexecuti
stul E
'1“, i Wm III
‘ ~11," +(1 *WUVHIZ‘
N» wuim
‘" *th*ln)+(l*v\'”)(l*m>‘
stul M
m m
"MHZ , 2m “Km, .
a ‘
Retumeazi 1"“ ‘

***************Ending Page***************

***************Beginning Page***************
***************page number:35**************
33
YIII ‘IIIII III In
In“
I I
II I I
i: l i 1 PX"
I. | | H L ‘A,
II I I
Au‘ H l l
II I I
II I I
II I I
II I I
I: I I
, III
(3m? II I I
II I
II __
. . WW‘ H)
An" I: : : ‘1,,
H I 'wa 1
II I I
II I I
II I I
II I I
II I I
II I I
II I I
II I I
ILUU 1m u 3U in; 1w

***************Ending Page***************

***************Beginning Page***************
***************page number:36**************
as
Gradient ascent method (n : n 001. n I 0,01, n : 0.1)
Newton’; methud, and the EM algorithm
Numb“, dc "mt" Wm-o W.
tm . SQ .juw 1. COM-mm mind
H H r i m’ ‘=
as 7 momda gradicmulul \daci v 7
U m),
t mm M New-t
m 7 “Mm! m.
' " ' f‘ Twp." "Hm" I“, rknrutnrra NW.
\\ \\ tm int-‘ii:
‘"‘ “" 0 [10054 :ch 7 me oda |a<l|cu ulul,
t \ t \ U "W 7 “.020.” Fm NOWZM.
t .t \ t .t \ u WW m, .luunmml EM,

***************Ending Page***************

***************Beginning Page***************
***************page number:37**************
‘l7
The EM algorithm for solving
a Bernoulli mixture model
CMU, 2008 fall, Eric Xing, HW4, pr. 1.4-7

***************Ending Page***************

***************Beginning Page***************
***************page number:38**************
38

Suppose I have two unfair reins. The. ﬁrst lands on heads
with umhnhility ,l, and the. sennnd lnmls on henrls with prnh- Z~ﬂlrmwﬂi
shility 1,. my‘
hnsgiue n tosses where for eucli toss l rhoose to use the ﬁrst l o
roin with probohility r and choose to use the second with X_,,,,,,,,,,,,,| X_B,,,m,,,,,-n
probability le o. Thc outcome ofcach toss 1 is l, e {0.1). H,

, P liq
Suppose I tell ynu the outcomes of the n tosses, I "l
(r, '11. .1"), but I dou't tell you whirh roins l used on 1 0
which toss.
Given unly the outcomes, r, your joh is to compute estimstes for H which is the set or
all psrerneters, u e (Mo) using the EM algorithm.
To compute these estixnuteel we will creote u lotent wsriohle z, where z, q (0,1) intlicotes
the coin used for the u“ toss. Fur example 33 e 1 indiestes the liret coin was usetl on
the second £055.
We deﬁne the "incomplete" rlsts logrlikelihocld as luPlrlel snrl the "complete" rlsts
logrlikelihood ss ln Pros e).

***************Ending Page***************

***************Beginning Page***************
***************page number:39**************
39
a, Show that Lv'[z,\:r,,0] : 11(1,:1h,,.o).
be Use Bayes rule to eompnte P(.:, e meow), whore W denotes the pa-
rameters at iteration L,
c, white down the complete log_likelihood, 111])(1'. 5W),
oi E-Step: Show that the expected log_likelihuod of the eonipiete data
Qto \ 0W) ‘i’ EM, 5H,][1n P0,: \ on is given by
(At/WI) I 2E;\115,90“-(]nﬁ+:l,lnp+(1iI,)ln(1*y))+

e1

+ (I i E[:, ‘1,, M1) e (him i 7V)+I',|HI]+(1i1!,)|ll(|ill))
e. M-Step: Describe the process you would use to obtain the npdnte
equations for ow", W" 5i 1"“).

***************Ending Page***************

***************Beginning Page***************
***************page number:40**************
40
Solution
a,
PM I’, "1: Z :,P(:,\1,.9):0'P(2,:(J\|‘H)+l-P[z,:1\1,,éf)
;%(lll)
@up, ‘1,121 :P(Z, : 1 \ we)
b.
P(z,i1\ “0)
i P(l,‘l,:1,y)P(/i,:1 H)
P(|,\z,:1,fi)P(z,:l\H)+P(|,\:,:U,H]P(:,:11\H)
i Miliw)‘ "'1
i P“ (I *1))‘*'~v+a'~<1*11>‘*'~(1* W)

***************Ending Page***************


***************Beginning Page***************
***************page number:41**************
41
c.
Note (in Romanian): Din punct (1e vedere metodologic. pentl'u a calcula 1m: 1/)
nc putcln inspiru LlC la punctul precedent: ubmvam ca“: la nurniturul frucﬁci curl: nu
dé valoarea 1m P(:,\.rmﬁ) avem Pp, z, : 1V1) 5i Pub; I my). Pnrnind de la ateste dnué
expresiL ne vom propune 55 le exprimim in mod “mum adicé sub forma unei singure
uxpmii, rumina artiﬁcial mpmmnmrii (ungl., the cxponcntiuﬁon muk).
mm , ‘l "
1.1mm \ a) :’ 111HP(1‘.:(\9):11\HP(1,‘\z‘.5)-P(z‘\ﬂ)
,Z, ,Z,
I 1mm n1’ 11>‘ 1) (q <1’ u)‘ (1* w)
H
| 7, 1, 4 *4 Y I!
, 2111(07 wk p)‘ w) (a ‘<1 i q)‘ ‘<1 i m) )
H
I 2[;,1..(,w(1ipwﬂwnui 2,)1" ((1"(l i q)""(l #1)]
H

***************Ending Page***************

***************Beginning Page***************
***************page number:42**************
42
cL
c201 \ W‘) ':" E,wz\,m1nP<-1»: \ Hn
i EPFWM: [1,lx\(]1“(l *71)""w) +
' (1*z.)ln(q"(1*IIJH'KPWUN
i iIEWIPW >1“(,w(1i,,)‘ w) +
a’ +(liEs,‘JPHWD*(11111"(1*/l)\ "(14M
i i[E[:,\1,.0“) Y(lufr+:r,lnp+(lif,)1n(l*1)” +
H + (1i E \ Ham) ‘(111(1 iv) +mw+ (1 immu , 1m]

***************Ending Page***************

***************Beginning Page***************
***************page number:43**************
43
e‘
(1):“ i U)\ »,_ ‘m
1151)JE[Z“J‘_9¢:J-Q H U £11 ) (1 If ) T ‘I
(I' >1" 41w > < + W)" ~ <1 ~11”) > <1 i w)
Q Q(H \ W) = Z[1L5]![lnﬁ+l‘1ny+(li'17,)1n(1*11))+
,:1
+ (1 qt?) - (mu *7r)+r,lnq+(l ’I,)1“(1 Hm]
WWW”) , " (r) .,-, 1*‘, i 1 " u! 1 " m
T 06;”, If?!’ 04:72,!‘ .1, ﬁg”! (p.11)
C» (1103M :pZHi/mi.»@Z/m:,,(inﬂulihwz/Af'nn)
:1 ,:\ ,Z. ,Zv :1
n n n (My
t» Zﬂyurpzw j p~+1>=3+ﬁjxdm
,:\ ‘Z. 2:1)‘,

***************Ending Page***************

***************Beginning Page***************
***************page number:44**************
44
0c a Hm ” ;, lip‘! " 1a U) n
2U ):U@2(l’/‘5U) ‘iii’ :oquUIizfxﬂ #101)‘ e[(1,1]
(*1 '1 1“I 2am» >
1W \ W) " m” 1 , W‘ 1 " 1 " n
fame éai' am-p ‘if 1a
a (1a n34” , #3114”) a 2/15” , W(Z<1aw>>+ DE")
1/) , m i (Ml) a 1 <11
<—> I 1 <—> . A> I _ a g 0.1
. v ()7 (‘i2 i)‘
Note: It can be easily shown that the ammd denvatwes ( . and , ) are an
up’ 01,2 07:7
"t-gntm un tht- 11:51,)chch dunlujns ut' Lleﬁnitiulh Thcrcfarc, the abuvu suluﬁuns (MW,
4W‘! and w"*‘]) maximize the Q functional.

***************Ending Page***************

***************Beginning Page***************
***************page number:45**************
45
The EM algorithm for mixtures of Bernoulli distributions: pseudo-code
lnmahzarc
zmbme v2lun1rhltrzv:(7rm' M” W in immm (0.1))
pentm WWW.‘ v‘ p 5‘ respetuv q,
cwm iteutw
pemm 1 :0. Til (cu T mm avans]
(San pa“; rind lug'vewslmllltatea dmw observablle nu mal cveste Semmﬁcatw)‘
(53-. pﬁni Cﬁnd 7w iwlwl' < s, l1?" fwd!‘ < :1 MM i ql'm < g‘
W E um in evens)
:xemti
Pasul E pennux: l. . 11‘ CBlCUlQBZi
v! , Om)" (1*r‘”)"’~w(” .
/“ s (Fwy,41¢le‘Kr11+(qm)~1.(1iqm)wl (1*7('l]'
stul M
n m 1. m
pus], : BZHAWA [104) I Zﬂﬂliululﬂ 1047 : l Z” ‘Hm
2:1)‘, 2,4111, J " P '
Returneazi WW" p"*",q~"*“v

***************Ending Page***************

***************Beginning Page***************
***************page number:46**************
4F»
L1 Ciortuz, s. Ciobanu:
Exemplifying a simpler version of the EM / BMM algorithm
starting from the dataset used at
CMU, 2005 run, T. Mitchell, A. Muore, midterm. pr, 1.3
A. suuurvissd B. unsupervised
III- III- /\
1 1 1 (Head) 1 7 1 (Head) , n
2 u u (Tail) 1 7 n (Tun) X~Hrvuoullv| Arﬂzmnulhu
:1 0 0 (Tail) A, .1 ? u (Tun) 1 H! 1" ,4»
<l 0 0 (Tail) J ? U (Tail)
T1 ll 1 (Head) 5 '.' l (Head) l '1
(‘WW N 1111111111121), \ _ T1,”.1.11111 1'1 7,111,111,111
with 1/; (u 1/2). .uu 1w 111;,
Note: In the next ﬁve slides we will assume that Tr is ﬁxed.

***************Ending Page***************

***************Beginning Page***************
***************page number:47**************
41
E step:
E[:.\z,.9["] : P(z,:1\I,-9m)
l.- ,3,» 1r(9“))"(1*9['7)"“ “it 11 -
(1011,19) “:" 1,.P(X Z191
I 2.111(51) + (1 , Z1)ln(21‘i(l , 1)) + 2.1111((1i (1)1) + (1 , z‘) 111((1 , 2(1)(1i 1)) +
24111((1 i 1;)1) + (1 , Z1) 111((1 , 2e)(1i 1)) +
2111((1i 1/)1)+(1i za) 111((1 , 2e)(1i 1)) + 21111011) + (1 , z‘)1n(211(1 , 1))
@0101”)? EVWMH
I E[z,] 111(01) + (1 i E[Z1])ln(20(1i 1)) + E[ZZ]111((1’ M11) + (1 i E[Zz])ln[(1i 20)(1i 11)) +
Em] ]n((l i (2)1) + (1 i E[ZJ]) 111((1 i 219m’ 1)) +
E[Z1] ]n((l i (2)1) + (1 i E[Z.1]] 111((1 i 219m’ 1)) + E[Z;] 111((111) + (1 , E[Za])ln(2€[1 i 11))
” *9" mm + E[Z1]1116+ (1 i E[Z1])ln€ + E[ZQ]1"(1 ,9) + (1 i E[Z;])In[1*2$]+
Hz!) 111(1 , 11) + (1 i mm) 111(1 , 2/1) + E‘[Z4] 111(1 , 11) + (1 i E[Z4]) 111(1 , 2/1) +
E[Z,,] 111/1 +(1i Em) In (1
: mm + 211111 + (522] + E[Z1] + E[Z4]) 111(1 , e) + (:1 , (E[Zz] + Em] + E[Z4]))1n(l , 20)

***************Ending Page***************

***************Beginning Page***************
***************page number:48**************
M step; 48
on“! a" dlﬂlIMwawm)
1111/11/11
0 2 E[Zl] + E[21] + E[zi 2[:1n (E[Z;1]+ E1211+ E Z111]
i Uy1v>,[me,iei
00Q< ‘ J 11 1n/1 1, 2/1
< > 211’ o>11 e 211 (1-14] , 1112.1] + 1512111111’ '1") + 213 r (H1211 + £121] + LIZ11>>011 r v)
m 211’ l!)[1 e 2/1) n (/15” +/1?,” +/|‘|“')/1(1 e 201+ 21:1’ (11'2" ~11” +/|‘(>))0(1 e a)
ewe? 1 he - (:11 with (1 : 111.11: 12 1/62‘) 1 ,11" 1M" 1::2L'IR (7)
Nnte chm
:11 211
,_% ,—,_
U! H) 1'11 ll/ 1!) (1‘
iQWl/VW) fifth +111 +11, i41$i<111 Hui/MD <0_
001 01 (1*0/1 (1401
su 01111111“) is a strietly concave iunetiun, so it has a unique maximum on (11. 1/2).
pl” C [0.1] due tn the relationship my therefore A : 1'1 1111» : 111 x11 > 1 > n, which
implies thnt the. solutions tn the nhnve. 2nd degree equatinn (denoted 0| and respectively
112) ere reel nomhers. It enn he shnwn (by using high school mathematics) ihni a‘ > u,
e 1 e i/w e
a; > u, und ninrenver 1'1 < 1/1_ and 02 > 1/1. Therernre, the snlutinn ¥ is
1,
the one corresponding to the maximuln value of melt/(“1 in the (11, 1/2) interval.

***************Ending Page***************

***************Beginning Page***************
***************page number:49**************
49
So, the updating rule for the IVI-stcp is
6W] i in i W i 4m- (X)
z“
Now, m summarize. the updating Tulsa for this version of the EM
algorithm are the relationships (m and (x).

***************Ending Page***************

***************Beginning Page***************
***************page number:50**************
50
Pseudo-codul algoritmului EM
pentru rezolvarea acestei mixturi de distribugii Bernoulli
lnmahmre
ambme o vamare avbmavi W in mtevvalul (0 1/2) pennu palametm‘ u‘
cmpm iteutw
pemm v :0. r 1 (cu T mm avans]
(sau pans rind 0"‘ ,9" ‘q < 5‘ w 5 mm SVEIV51=XECM5
stul E
“mg, ,(gmyuiﬂwﬂﬂ.
, rfgllx)nU,(/u>]1 n,(I,,)(-3W)v,(|,2,,<n)1
Pm“ M
,1, i vrﬂ i 4m
Wm I i
2" ‘ cu
u 10‘ 1, in”? +;1‘,"‘+;|(|" 5| I 2‘
Returneazi W4,"

***************Ending Page***************

***************Beginning Page***************
***************page number:51**************
Execution of two iterations of the EM/BMM algorithm,
when r. : 015 (ﬁxed)
‘puns made by Sebastian Ciobanu'
<1 111m» 1 7 1111M) 1 1 \ 1
"1’ 1 1 “("1"‘°'1 “1 0(11111'"11.1"2»H1z1x 11m»
*1 1 1 1 *1 10(H1PMJ>1H2‘HG11X N 1
1 1 001sz 1 1 1 1
“F 1 1 1 “F 1 1 1 1
1 1 1 1 1 1 1
V1 no 01 DZ on n‘ 05 1 nu n1 n2 n: 04 05
11 11

***************Ending Page***************

***************Beginning Page***************
***************page number:52**************
32

-——

£ "W m a 14mm

I (I QthM J ikx'leﬂ

R U lbhhTT‘) ,3 ikx'xlﬁﬁ
__——

X 0201mm’? a imvm

W U lbhbhh'r J {Wm

mm’ Arumm “L” 41m|11\1,p'x“" 41vn|1x|1,,4“' 410mm pi,” i u Mum

***************Ending Page***************

***************Beginning Page***************
***************page number:53**************
When 1 is free: 53
E step:
Flmnﬁh‘ ﬂm] : PM : H" 9411’?an
,1 111- ,,1'1(@m],,(1,91x»)1 ,, 1;» <11
, W1 (5111);‘ (1 , MM. +11 , WWW-<1 , 25m)”: , M
MMWRW) ":" 1-;[2,,,m,.,(a m1
: E[Zy]l|\(llvr) + (1 i E[Z|]) ||1(zo(1 i #1) + E[Z;] 111((1 i 11)”) + (1 i E[Z2])ln((1* 20m i 1)) +
F[z,]1..<(1 i m] + <1 i 1111]) “.111 i mu i m) +
H[ZA]1I1((1* am+<1i 1,1211) |“((1 i 21am i m) + b z51111157)+(1i u[z§])1n(2a(1 i 1))
M step: 0"“! same as before, but using the ,Lf" from 11115 E step.
w“ “2 mgmilxvem Homwwmm)
i , m w ,
614m, 11W )iucv
ed" [201151. + (152,1 + E[Zg] + E[Z;] + E[Z. A E[Z§]) lnn+
(5’(1; z. ~ 1»;[21]+ @121] + 1512.1 + E[Zs]))ln(li1r)] : 0 a»
Em] + 5 211+ E[z,] + E[Z.1] + E[Z>,] z 5’(E[Zv] + E1211 + Em] + Em] + Emu <=
7 1,"
1r : éw'm i W1] + FJ[Z1] + mm] + mm)
Therefore 7TU+U : QM," HQ” + p1" +113’) + 11;")5 [0, 1]. Note: ()(5.Ww<ll‘ﬁm) is concave w.r.t. r.

***************Ending Page***************

***************Beginning Page***************
***************page number:54**************
54
Pseudo-codul accstci noi variantc a algoritmului EM
pentru rezolvarea mixturii de distribuyii Bernoulli
Inmahzare
5mm Q vahale mums 0"" 'l'n mkelvalul m. V2) mm. paramwm a 5‘
o mom arbitrari 1"" Tn mtervahﬂ (n 1) permu parametml w‘
Cum Iievatw
mm. 1 i 0 T i 1 (cu r Ml in Mm)
(m péni ma a" H" ‘H < g‘ cu g mm Evans) execmi
stul E
Hm "y ""‘l0"‘>"(1iu">l‘ "
, 4W!!](g4l¢\11‘(1fullvﬂih + (1 i "\HXZTWI4JMU i Muff,»
Pasul M
(m, in i W11 i 1m
1/ i‘ cu
2"
u :1u,!,: *12 +“§”+;L_§"_,LL” $1,: 2.
| \ \ i ,
WWIWH,’ +112”+,1,”+,1(>+/11,“)e[u.1],
Returneazi 110*“ 5i 1W",

***************Ending Page***************

***************Beginning Page***************
***************page number:55**************
33
Execution of the EM/BMM algorithm, when n is also free
plots nlade by Sebastian Ciubanu
E
a w

***************Ending Page***************

***************Beginning Page***************
***************page number:56**************
if»
‘ ———-—

***************Ending Page***************

***************Beginning Page***************
***************page number:57**************
a7
Revisiting the case when Tl’ is ﬁxed
Dmnritﬁ proprimiiﬁi rin liniaritatn a medinii urmruzi 0:“: mnrliu snlnri unnr variabiln
aleatoare este sums mediilor 1m. Fnlusind aceastA proprielaLe simpié vom mm
m-"m c5 putnm $5 mcmmul-am algoriunui mm" EM prntrll Human-d pummnmlm
unei xnixLuri de dislribugii Bernoulli sub o aitﬁ formi, fnarle convenzbili.
La rczolvﬂrra daci antrvior pm", pasul r: (Cﬁﬂd p'ohabmmm dc sumac, ,»., (‘ra
uurhideratzvu ﬁxatﬁ). an: ubgimn
‘W , I , , , w 1- Ii w<r/"">"<1i/I’”)‘"‘
M , 1 <ﬂ , u w 1 , ﬂ—[a,,ym WW, + U , VJWHW , 2M1“,
PuLem scrie
pentru cazui 1, :1 (adici, pentru ., , Mm)
{m , 7 ,, H, 15"" ‘
n I 1H, u ,, 11/ ) inn" + (1 i @201" (Ya)
pnnm. cazlli I‘ : u (adicﬁ, pclﬂrll ,, E m)
‘ —. Y i ﬂ '1‘
Mg“: ,: 1m: ,< 1
"" H‘ l" ‘H l m 0'le mu 2W) (m)

***************Ending Page***************

***************Beginning Page***************
***************page number:58**************
58
Fie 2| numaiui (neubservabil) d2 aparigii ale Mai mm pentru moneda 1, din
totalul de 7n "I" 2 apariﬂii ale stemei in datele noastre.
Similar, ﬁe z" “mum-“1 (noobservabil) do aparigii ale iciei 1w‘ pentru monoda
1, din Lotzilul do 1m ‘2 3 npnrigii ale banului in daLclc “0mm.
“maﬁa de verusimilitate corespunzitoare a datelor [din Label] Esta
W) , "1.“ in)?“ m)”. (1 *‘ZI'W
iar funcﬁa de lng-vProsimilitate este
mi) , :\ m1” mm , 0) , ("5 , mime) + (m; , :V)lll[1* 20).
we“ cc cunllucc imudiut lu “Qua expresie a funqiei auxiliare:
Q<vw"')"'lul/w>1
“" 9" PW mm F) ,0 ln[l , a) i (n: , E[;,])hi(25) + ("B i Emblnu i 29)

***************Ending Page***************

***************Beginning Page***************
***************page number:59**************
59

La pasul E, mcdiile
. um adicé num5rul a§leptat (engL, expected number) dc aparigii ale rem
mm pentru monctla 1 din mum! do w "A 2 3pm“: ale sLemei in datele
noastreé gi
- mm, mics “"maml asiaptat (“ng expected number) rle aparmi “up, Mei
m pemm moneda 1 din totalul de m; "1' 3 apariﬁi ale hanului in datele
noastrc.
se calculeazﬁ la iteragia/ folosind ﬁe proprietatea de liniaritate a mediilor
ﬁe formula medial distribugiei binomiale:

V (n . v V u)

Mill i "s <1‘ §l b <0 i nu '10 (11)
in aceasté noué formulare a algoritmului EM pent"! probléma lmastré, pain]
E 05m mnsmun dc formulcle (01 gi <10), m pasul M so elaboreazé dupa cum
urmeazk
5mm c5

0W" I argnm): (2(9 01"‘). (12)
Him‘ v/n

***************Ending Page***************

***************Beginning Page***************
***************page number:60**************
[ma maximul funcgiei mew“) se Silueﬂlﬁ in intcm'mml intervalului (0. 1/2), atunci cu so
necesitate vom avea
o .
E (EM [no + En] mu , 0) + (/75 , E[21])1n(2(7)+(r|5 i Em) mu , 20>) : u
E 2| Em] 2t”, i E[:,]) 2(1”; i E[:“])
a i i i i i i : 0
e 1’ e + 20 1’ 25
¢ m "hm i M {1}," + 2W ,7“ 11$") i llHn *Hn 115"] in
e 1 i a 29 1’ 29 i
a "MA" , Tia-‘1511+ ‘mu HA") , mu ~15") :0
a 1 , H 1a 1 , 2H
a 1,,(1 i mu i 29)’?1511mﬂﬂ i 2a) i 275(1’ MUM] i h‘) : u
Q 775 + 6km“ ,M, 2m: + 2m?) + "1"": +M+ ‘1"’: *M] Z U

4: 2m- “15191 i (31,5 + 2mg i nmfﬂw +1“- : u (l3)
Se constati u§0r 05 ecuaﬁa (w) este de fapt Ream cu ecuaﬁa <7) pe (‘are am 01mm“-
o la pasul M atunci 05nd probabiliuatea de selecgie ~. era consideraté ﬁxaté. Prin
urmare. bolugia prublemei dc optimizare (12] i adici. rcgula do actualizare a valorilur
parametrului H la pasul M pentru aceasti noué versiune a algoritmului EM i v3 avea
exact fol-ma Ls).
Renapitulénd, regulila de artualizare panh'u aceas'ﬁ versiune a algoritmului EM sunh
la pasul E relaﬁa no)‘ m la pasul M 5i varianta regulii (s) pennu ecuagia (13).

***************Ending Page***************

***************Beginning Page***************
***************page number:61**************
m
Pseudo-codul algoritmului EM
pentru rezolvarea acestei mixturi de distribugii Bernoulli
lnmalxzare
BIHbIHE o vamare avbmrzvi W in mtervalul m 1/2) pwm paramenu‘ a‘
cwm iteutw
pemm 1 : n. Til (cu r men" avans]
(53“ pa"; zénd 9 " fa’ ‘w \ z‘ cu z mm evens) mm;
stul E
m, w (I , 0"‘)
' : in
m ~41’an (1 *WJU izz/Hy)
Pasul M
WW I H" Vb‘ i 1m ),/(2u)‘ w
a 2m- + n5)‘ r. *($|15+21113 , 11,1‘,1,")§w w»
Retumeazi a“ “‘

***************Ending Page***************

***************Beginning Page***************
***************page number:62**************
m

Observafzi:
14 um formula (18] se vede faptul c5 nu este necesar 55 mai calculiun ‘1E’
la pasul E. Chiar Q; data ar ﬁ trebuit is calculém 4;”, pasul E cm ar ﬁ fest
mai Hen-am in nnua versiune derﬁt in versiunea ,.clasic§"' a algnmmulux EM
pemru rezolvare de mixturi de distribugii Bemoullh ﬁindca acolo calculam
11 mcdii Ill“. ALI-n [apt cstl: fuurtc scxnniﬁcativ pcntru uuzuri in can: uvcln
foul-Le multe immnge “I
z‘ Acest ultirn up =16 mam-ME a Lgmﬂum
parametrului / paralnetrilor unei
distribugii probabiliste cu ajumrul A’!
algoritmului EM esw posibil datorité | a
mm“; ca an 10¢ relauue (n)- Hmwm, WWW.“
llustrém awash? importanté a 4" 2“ 1.19
‘,dcpcndcnﬁi“ in ﬁgura amuram
(pcnu'u a FaciliLa roginorea 0i .10 1 n
titre Cililol'l). va rcarnintiln :5 H, <
5i m, sunt datele / variabilele oh A VV q
servahile_ iar z, 5i Z1, sunt variabilele ~ . v w ~ j ‘m m

, z ~B|m|mml(!| , ) ~amm' n , )
neobservablla ‘ S q‘ z" B q”

***************Ending Page***************

***************Beginning Page***************
***************page number:63**************
m
Estimating the parameters of a mixture of
vectors of Bernoulli variables, which are independent
and [respectively] identically distributed
A. when all variables are observable: NILE, in the direct manner;
B. when some variables are unobservable: the Elﬂ algorithm
Liviu Ciortuz, following
“What is the expectation maximization algorithm?”,
Chuung B. D0. Seraﬁm Batzoglou,
Nature Biotechnology, vol. 20, no‘ s, 2008, pag, 8977899

***************Ending Page***************

***************Beginning Page***************
***************page number:64**************
(H
Fio urmﬁtorul ewpm'mem pmbabiliat:
Dispuneln (1e (10115 mnnerle, A §a 12.
Efcctuém 5 scrii do operatiuni do tipul “mam:
Alegem in mod 8193mm una dintre monedele ,1 5i u, cu probabilitate
egalﬁ (1/2);
i Amman] dc 1o ori muncda cam tucmai a fast 310351; (Z) §i notém
rezultatul, sumarizat ca “um-:1: (x) de Me ‘head’ (r0, ‘stemiﬂ obginute
in “er aruncérii,

***************Ending Page***************

***************Beginning Page***************
***************page number:65**************
Iii

A, La acest punct vom considera cé s-a obginuc unnamml rezultat pentru
experimentnl ﬂush-n:

I Z, X,

1 B 5H (5T)

2 A 0H (11')

a A 81! (2T)

4 B 4H (GT)

5 A 711(31')
Semniﬁcaﬁa variabilelor aleatoare z, 5i x, pentl'u z i 1. . .5 din tabelul cle
mai sus ester inlediatﬁ.

***************Ending Page***************

***************Beginning Page***************
***************page number:66**************
66

i. Calculagi a; §i é”, probabilimile de aparigie a fegei ‘head’/stem€i pentru
cele doué monede, £0105in deﬁnma clasicd pentru pmbabilitatea eveni-
mentalor alentoam, §a anume raportul (1mm mnnérnl de cazuri favorabile
§i numérul de cazuri posibile. relativ la intregul experiment‘
Réspuns:
Analizénd datele din tabelul din enuny, rezulté imediat

. 24 ~ 9

11: :os '1) : :04:

'4 24+0 5' " 9+11 ’
De ubservat c5 (“menu (a §i respectiv 11 de 13 nulniturii acestur [mew
mpmima .mmaml do fete ‘MW/ban care an fost obﬂnutc la aruncarca
monedei A @i respectiv B: GT i 1T A 2T +21, llT i 3T + GT4

***************Ending Page***************

***************Beginning Page***************
***************page number:67**************
57
Maximum likelihood
a HTTTHHTHTH 544,51-
- 24
o HHHHTHHHHH 9H‘1T 9A=24+6=uso
o HTHHHHHTHH 504,21‘ _ 9
sfmwm
o HTHTTTHHTT 4H.6T
a THHHTHHHTH 7H,!!T
/ 24H‘5T 9H,!1T
5 5e15, W [95595 WV W‘

***************Ending Page***************

***************Beginning Page***************
***************page number:68**************
ms
Observagie
Dacii in locul variabilelur binare Z, 6 (A. B) pentru / : I_. H5 introducem
in mod natural variabilclmindicator Z“ e (0.1} 5i z,“ e {0.1) wt pcntru
1 i 1,. . 5, deﬁnite prin Zn, i 1 iﬁ‘ z‘ i A, §i 21,1 i n iff 2,,” i 0, atunci
procesérile necesare penh-u calculnl probahilitiaﬁlor/parametrilor 0/‘ §i 0,;
pot ﬁ prczcntatc in mod sintctizat ca in tabclul do mai josl‘
1 Zm Z,“ X,
1 U 1 5H
2 1 l’) 911 :>
I} ] (l 8H
4 O 1 411
5 1 (l 7H
~ Pmcmmn at'csr "mil-1m" ca pwgaurv, pvntxu rvzolvarca (ulrvnuari a) pnnc'tulni
13 a1 puwmlm pwlvlvmv

***************Ending Page***************

***************Beginning Page***************
***************page number:69**************
69
XwZI .1 X1 Z111
011 (01') s11 (5'1)
9H (1T) (1H (UT)
8H (2T) 0H (UT)
i 011 (01') 411 (0'1) i
7H (3T) UH (UT)
231,21, Iz, , i 2411 2f" x, , Z111 i $111
2),’;(10 i X,) I z, 1 i GT 21,1‘(10 i X,) I Z,” i111‘
11,‘ I ﬁ I ms
j +
19 i is» i111’
” i 0+ 11 i ‘J

***************Ending Page***************

***************Beginning Page***************
***************page number:70**************
70

,. ‘ m» . , H
w Calculam LA mm“) i P(X. Z \ (M. on), funcua dc vcroslmllltatc a datclor

um . ‘ no! A ,. ,
X i< )un “X; > 5| Z i< Z...‘ .Zr, >, m raport cu paramctm 04 $1
respectiv 9B ai distribugiilur care modeleazé aruncarea celur (10w; monede.
Ubsev'mzﬁe: Faccm presup'unerea 65 am mgmm succcsiunca [tuturor] rczul-
tatelor obginute la aruncérile celor doué monede. Precizarea dz facto a
acestei Mzccesiuni nu em! esengialii. Dacia nu s-ar face aceastz“; pmwpmwm,
ar trcbui 55 55 lucrﬁm on distribuﬁa binomiald.

***************Ending Page***************

***************Beginning Page***************
***************page number:71**************
71
Réspuns:
Calculul verosimilitétii datclor:
mm 0R) “2 P01 m2” \ Mn) “i II mmwm \ m”)
i HP(X‘ \ z, ,1.ZLB;e,“aE) - Hz‘ 4,2“; \ {14,98}
I Pun \ 2m I 1-91?)'1/2'
Pm \ z“ 1.9.41-1/2-
P(X5 \ ZN : HM) I/QY
P(X,‘\ZI;_1:L91;)-J/2~
P(X5 \ ZA», i1.0,,)-1/2
, r K - l
i WIfow'ﬂiﬂ*0»)41Wfool-ﬂAliﬂmb-ﬂﬂli174)‘-2;
i $vi‘<1imu‘;g<1iﬂu>“

***************Ending Page***************

***************Beginning Page***************
***************page number:72**************
72
iii‘ Calculagi 01 “l argumxg‘10gL\(04.(7/;) 51 01, "3 @rg11m0,,10g1..(04,0n)
folosind derivatele paryiale de ordinul intéi
Ubsemmﬂi:
1. Ba“ lugaritmului‘ ﬁxatﬁ dar lama mai m mspcciﬁma, 5c va Considcra
suprallnitarfx (cle exemplu 2_ ‘I sau 10).
24 Lucrénd corect, vegi ubﬁne acelagi rezultat ca la punctul i,

***************Ending Page***************

***************Beginning Page***************
***************page number:73**************
73
Réspuns:
Functia dc log-vcrosimilitatc a datclor complete so cxprimfx astfcl:
10gL1(€/\.€,;) I i510g2>2410g9j 4 610g(1 , 9,‘) 4 910g91; - 11105142”)
Prin urinate, maximul acestei rump: in tapoﬂ. cu parametrul 0A se cal-
mlcaz-a astfcl:
alogmomu) 21 0 '1 1 »
i’ iUQ iiii0@iiicrl~lﬂ,i6 41H? fog
01M 01 14/1 01 1%,, ‘ ‘ 1
71 L 0 ,9 A
Similau, se [ace calculul $1 penLru W $1 se obgine 9,3 : 0.4m
A ‘ L Ii
Cele doué valori obginute, e,‘ §i HE‘, reprezinté estimarea de verosimilitate
maximal (MLE) a probabilitﬁﬁlor dc apariﬁc a fc§ci ‘head’ (‘stema’) pnntru
moneda A §i respectiv moneda u.
u s" mama “W mpuu (‘a inn-mlrxvm rénhivmilu durivaualur pmmlu ‘10 unliuul was
pcutl'u {"11qu do logw'crusimilimtr‘ rolxvzintﬁ punctc 11¢ maxim‘ Pmm'u atﬂasta so
muhué smnnalo azmtur derivaux.

***************Ending Page***************

***************Beginning Page***************
***************page number:74**************
14
Observagii

1. Am mam pp incest m particular c5 motoda do calcularc a proba-
bilitégilor (0,4 §i a”) direct din datele observate (353 cum o §tim din liceu)
corespunde de fapL meLodei de estimate in sensul verosimitégii maxime
(MLE).

2. La punctul B vom ar'éta cum anumu so poatc face estimaroa acclora§i
parametri HA §i an in cazul in care o parts din date, §i anume variabilele z‘
(penm, v, : 1. . ,5) sunt neobservahila

***************Ending Page***************

***************Beginning Page***************
***************page number:75**************
73

B, La acest punct se va relua experimentul (1e la punctul A, insé de data
accasta vom considora Ca valorilc variabilclor Z, nu sunt cunoscutc.

1 z, X,

1 “ 5H (5T)

2 7 9H (1T)

s ‘9 8H (21‘)

4 J 4H (GT)

5 7 7H (3T)

***************Ending Page***************

***************Beginning Page***************
***************page number:76**************
15
EXpectahon maxmmzallon
fax
HYLTHWN 01m. 055x’ 4.2%sz -28H,2.8T
km WWW
Mmmuwnm =7.2H‘D‘ST LLBHJLZT
wwvwnw max. 027x’ =5>9H,L5T =2.IH,0>5T
I 035x‘ 06510 =1AH2|T =2.6H,39T
5;‘qu 0'65xo can’ ~4.5H,1.DT =2.5H.u'r
9:1:05“ :ZMH'LBGT :H7H_B.4Y
I ‘ ‘.1 21.2 7 ®
> H7 M
a-‘nnaA 059 ‘)HA‘ 0'8‘)
Q" 9;“2052

***************Ending Page***************

***************Beginning Page***************
***************page number:77**************
77

iv. Pcntru cunvcnicma, in locul variabilclor ,,ncobscrvabilc“ z, pent“!
1 I 1,. ..5 vom considera variabilele-indicator (de asemenea neobservabile)
z,,\.Z,_B e {0.1}, C“ z, 1 I lqu §i 71.1 + 2M; I 11 Evident, intrucﬁt vari-
abilclc Z, sunt alcatoarc, rczultil 05 $1 variabilclc Z, .1 512,1, sunt alcatoarc.
Folosind tcorcma lui Bayes, calculati modiilc variabilclor ncobscrvabilc
21 ,1 §i 2,3 condigionate de variabilele observabile X‘, Vegi considera c5
paramotrii accstor distribugii (Bernoulli) care modclcazﬁ aruncarca mon-
edelor .4 §1 B a“ valorile 11$" I 0.1; §1 respectiv 111;” I 11,5.

A§adar. se Cert E141 1 XVHEngH §1 E1215 1X1.H$§‘>,a§;“1 pentru 1I1.. Us,
Ca §1 mai 111311118. prubabilitiﬁle a priori m2“ I 1) §1 P(Z,‘,, I 1) se vor
considcra cgalc cu 1/2.

***************Ending Page***************

***************Beginning Page***************
***************page number:78**************
78
Note“;

Algoritmul EM no permits 55 faccrn in mod imam cstimarca paramotrilor
0A gi 0,; in funcgie cle valorile variabilelor observabile. A], §i de valorile
inualc atribuitc parametrilor (in cazul nostru, 0;“) i 01; 5i 0;?’ 415).
Vom face 0 5mm a calcnlclor do la prima itcraﬂc a algoritmulni EM i
detaliate la punctele iv, v §i vi de mai jos i sub forma urmétoareA care
seaméné intr-o anumité mésurﬁ cu tabelele de la punchll A:

r Z“ Zw A, EMA] LIZ“;

1 ‘F '7 511 0.4511 0.5511

2 " " UH i U801‘! UQUH if,

3 ‘7 7 8H [)YTSH U.27H

4 .’ ‘7 411 0.3511 0.6511

'3 " " 7H UGSH 0.35.511

***************Ending Page***************

***************Beginning Page***************
***************page number:79**************
79
Noté (c0nt.)
X, - 1512111] X, - 11121.11‘
2.211 (2 21') 2.811 (2.51)
T 211 (n 81') 1.811 (n 2T]
1, 59H (IST) 21H (057‘)
j 1.411 (211') 2.1111 (3.01) i
.1511 (197') 2.511 (1.1T)
KAXL-Eyz, ,1 I21.311 ﬁdxquwy 11711
21,01) I x,) > E[Z, ,,] I MT 31,00 I x,) -1-3[z,,3] I is 3T
1 21,11
11m I i I , 1
i { ,1 2|:s+87 07
~11, I17 N r
H” i117+s§s NU”

***************Ending Page***************

***************Beginning Page***************
***************page number:80**************
80
Noté (cont)
Vom mat-n (15:

0 intr-adcvzir, cstc posibilé calcularca modiilor variabilclor ncobscrvabilc
an §i z,,,,. condigiunate de variabilele observabile x, §i in rnnqle cle
valorile asignate inigial (0.6 ea 0.5 in en|1n§, dar an general ele se pot
asigna in mod nlenwrin) [)Cntru parametrii 04 ea on;

0 raga de tabloul de sintezé de la punctul precedent, ciuld toate vane
abilele erau observabile §i se calculau produsele X, >2‘ .4 §i x, . z! ,i, aici
so inlocuicsc variabilelu 2M ea an cn mcdiilc F,‘ z,_,\] ea FJ[Z,_,;] in pro-
dusele respective, De fapt, in 10c 55 se calculeze 2‘ x,-z, .4 se calculeazé
{media Elgx, . z, l, ea similar pentru Bl

Natutie: Pentru simplitate, in cele de mai sns (inclusiv in tabelele prece-
dente), prin 92M] nm notat E[Z,_,‘ l X,.h'"“], iar prin 92w] am nnlnl
up, ,1 x,.nl"‘/], uncle mm ”:" ($9.03”).

***************Ending Page***************


***************Beginning Page***************
***************page number:81**************
81
Rﬁspuns (711;)
inmmm variabilele z, 1 an Wilma bouleene (u 5-4“ 1), mum “a
u[z,,,\x,.o\“>] : o-P(z,,‘ :0\/\1.0("‘)+1-P(Z,l1:1\/\].0W))
i PM“ i nXPW)
Probabilimgilc P(Z,_4 : 1 X W") : m2, 1 : | \ KPHUU)‘ pcntru I : 1 5,
5e pot calcula folosind teorema 1m Bayes:
~ P(X \ZAi1.0“”)-P(Z,Ai1\0“”)
P Z. i1x,.0\°‘ i —
( ‘ ‘ ) Z,CU,.,P(X,\Z..,\i1.w"/>YP<Z,.1*1W")
, PM} \ 2,,‘ I MS“)
mx, \ 2M : Lei“) i P<XX \ 21.x: 1M2”)
S-a 9mm cont cé m2“ : 1 \ 9w) : HZ“? : 1 \ 9W) : 1/2 (a se vedea
enunguly

***************Ending Page***************

***************Beginning Page***************
***************page number:82**************
82
Do exemplu, pcntrn 1 i1 vom avca:
0.6‘(1 i rm)" 1 .
EZ, x ,W i 6 i i7 x0;
l “‘ ‘ l ani0.6)~>+0.55(1i(1,5)‘ 1 my, * )
‘ n 2-1
Similar cu E[Z,\\ \ X,,H‘~'”)] se calculeazz“: §1 celelalte medii m2, ,\ \ X,,H(”7]
pontrllliz. v .SQi E{Z,_H\X,.o<"\\ pcntru 1 i 1. v .5.
Am inrcgistrat accstc valori/mcdii in col de~al doilca babel din Nola do
mai sus‘
Obscv'vuﬁe: Sc poatc tine mm 05, do indaca cc H calculi“ EM, 4 \ X,.0<"/1,
se poate engine imediat §i EV‘); \ xvmm} i 1’ EVA \ XVHU'H, ﬁindcé
Z,,\+Z‘I;: l-

***************Ending Page***************

***************Beginning Page***************
***************page number:83**************
PH

11‘ Calculagi media funcgiei cle log-verosimilitate a datelor complete, x
(observabile) §i Z (neobservabile):

MM”) :1 b,,‘Z‘\»_,m~,[logP(A.A \ 0]].
undo 0'1” (414.0”) 5i 0W! "1’ (09.0%”).
Semniﬁcapia notagiei de mai sus este unuétoarea:
[uncgia Lmﬂﬂg) este o medie a variabilei aleatoare reprezentaté de
log-vcrosimilitatca datclor complete (obscrvabilc §i, rcspcctiv, ncobscrv-
abile), m aceasté medie se calculeazé in raport cu distribugia probabilistzi
condigionalé a datelor neobservabile, P(Z \ X110”),
Obscwuﬁe: La claborarca calculului, vcﬁ folosi mai mm; propriotatca do
liniaritate a mediilor variabilelor aleatoare. §i apoi rezultatele de la punctul
in.

***************Ending Page***************

***************Beginning Page***************
***************page number:84**************
84
Réspuns:
Media functici dc log-verosimilitatc a datclor complete, “(0.4.0“1, sc cal-
culeazé astfel:
mom”) :’ bpmw, logm¢ \ 01]
mm , , 7| > ,
:’ hm ﬂ mug H P(X,- 4 A. 4.” \ 0.1.0111]
m d1; mu , ,
’ I ’ ENZMUmmogl-[POH \ 2M Z, 8.91.9")-PKZ‘,\_Z,_B\H,\.HB)1
,4

in continuare, omigand din nou distribugia probabilisté in l-apon cu care
ﬁe (:alculeazil media aceasta intrucét ea pnate a sllbingeleasi vnm scrie:

***************Ending Page***************

***************Beginning Page***************
***************page number:85**************
85
Limo”)
I Ellogﬁwi' '1 >X‘ - [<1 - QA>Z~1“‘*X' -<92*“1“" -[<1- 9511‘ ”]“"X‘ - :1
,Z,

I E[i[X,VZ,VAV10g6A + (10 *XJ v 2,‘,4 '10g(1 i 9A) +

H X, - Z“, ‘logQU + (10 — X,]-Z1U-1og(1— 6'”) — log2]]

""2"" iv, 112M] -log€A + (10 i x‘) -E[Z‘,A] >10g(1* a‘) +

'11 X1 > Ella] >1<~g HE + (10 i X1) ‘ E[Z!.E] >1<\a(1 i HE) i m2]
I ilvgmi' EZ, a] _ (l i 9,00%») um A] ~01“ Ell‘ u] v (1 i SR)““’X“ LIZ, B] . é]
:1:;(6i2~(1*H,\)22'e233'(1*65)23m> 41f‘;Y(1*9,1)‘9'9f;"-(l*6;;)"-%)

***************Ending Page***************

***************Beginning Page***************
***************page number:86**************
P55
La nltima cgalitatc dc mai sus, cantitixﬂlc fracﬂonarc provin din calcnlclc
simple X, >52“ \ Xlw :1 2.24, X‘ - E2,” \ my] z 2.x, . ., X;,»E{ZH \
X19] s 15, Yr, - EV, R \ >0, a a 23 (a SC vcdea tabclclc din (iadrul Notei
precedents)‘

***************Ending Page***************

***************Beginning Page***************
***************page number:87**************
87
m: Calculagi 9;“ "é' argmaxiv,‘ mama) §i at“ ‘:’ 1"ngme 11201,‘,03)‘
Réspuns:
Valorilc paramotrilor H4 §a H” pcntru care so atingc lnaximul modici Funcﬁci
d9 log'verosimilitate a datelor complete 5e obgin cu ajutorul derivatelur
pal-gale de ordinul musk"
0Ll(e,\.eg) i 0
09A i
a
é Val 10g”,4 + 2.2103(1i 0,‘) + . , . + 4.51091,‘ +1.01%»,(1 i an) i n
‘ .\
2 2 2 2 '15 19 U
Qiiii, iii:0¢. .:>H\ mm,
e1 liéh +9‘ P94 A '
smm-dr, vnln nbﬁne HEP z 0.5x

***************Ending Page***************

***************Beginning Page***************
***************page number:88**************
H8
c‘ Formalizagi pa§ii E §i M ai algoritmului EM pentru estimarea
parametrilor a,‘ §i 9,; in condigme de la punctul B‘
Réspuns:
Formulele care 59 folosesc in cadrul algoritmului EM pent“! rezolvarea
problemei date i Le. estimarea parametrilor a,‘ §i an atunci cénd vari-
abilclc Z‘ sunt ncobscrvnbilc i, SQ claborcazﬁ/dcduc astfcl:

***************Ending Page***************

***************Beginning Page***************
***************page number:89**************
89
Pasul E:
E{Z, ‘\XPH} i P(Zh\ i 1\X,.H)* P(Z,,\ i 1\X,.H)
,_,%
P<X,\Z,.1:1:ﬂ)-P(ZY_A: L W>+P<X,\2,H: 1:9)-P(Z,”:1 W)
W
h'z
mx, \ 1,, :110)
i P<X.\z‘..1:1.@) - P<X. \ m: 1.91
i 9100 i HAWPX,
’ H;r1ianmihwg'rl*HUWH
Similar, vom obtinc:
HZ“; ‘ X,.H] I %
m1’ HUM‘ ,HM, , WM,

***************Ending Page***************

***************Beginning Page***************
***************page number:90**************
90
Notﬁnd cu
i z, valnarca variabilci A]
i 9%‘ §i respectiv Hi?“ estimérile parametrilor HA §i a” la iteragia /, a algo-
ritmului EM,
FYI," §i respecm pit”, medme Ell“ x A,.o<,i)1 si m.” x x‘. 0&9],
yam ma:
11"?) : <ﬂ£i>>~<1 i HEW“
Wm i HWH +<HEQ>L<1 , HZU'H
pm» Z (92'5141- 951W“
wii1>T~<1i BXUWL + (6%‘le , (mm

***************Ending Page***************

***************Beginning Page***************
***************page number:91**************
91

Pasul M:

Ca 5i mai inaintc, in formulclc do mai jos vom folosi notaﬂiilc simpliﬁcatc
EV, \ “:" EIZ,.\ \ KW] §i Wm] "2 PM.” \ X2. W1-

c“ aceste notaﬁL procedénd shnilar C“ calculul de la path-2a B, punchll w,
vom avea:

112(9\_6n):\ngnﬁf{m' \ (I feauuiml; 1, \]HEI5ZMX(1fenv'mirqﬂzdg]
H

***************Ending Page***************

***************Beginning Page***************
***************page number:92**************
92
Pm “mam,
a L (e 9)*04>1i:~E{Z p 1 inn )E{Z}
00A Z 'l- B f7,“ a‘ .1, ; /\ 1i H,‘ ‘:l J» wk
4 n1’ QAJE'HEVMJ i 0,1310 i {mm
H H
Q ELI-12,1] I 10mg F.‘[Z‘_/\]
,Zv ,1,
" - EZ " :,EZ
Q H1 : M §i, shnilar, an : M
102,,‘ Ll!‘ a] 1" 2,’. M48.
A§adar, la pasul M 31 algoritmului EM vnm avea:
5 I
9%") z Zlml'ff/l‘) §i ng z 2,1. 1a If?
’ 1022:] vii?" 1021,15,?“

***************Ending Page***************

***************Beginning Page***************
***************page number:93**************
. . . . 93
Summlng up: The EM algonthm for solvmg thls problem
lmpzhzare
atnhme vabn zrlmmv: M?‘ 0:” 'm mlervnM [n 1))
pennu palametm 0/1 5‘ respecuv an,
(mm iteratw
pentm 1 : n, T ,1 (Q- T hxzt in avans)
(sau pin} (ﬁnd ‘ug'vucsxmiﬁtama datelur abservzb'd: nu mai cre5te Semmﬁcztiv)‘
(m péni (ﬁnd mg“ i Mm‘ (1“ 0;? i 0Lj*"\ <
W 5 um in evens)
exezuki
Pasul E
pemru , :1 .s “Indeed
"M, WW1‘ MSW"
“ (0‘i'>“(l*//'\”)‘“*"+(1/X7)"<1*”}l'1“"“
,1 ‘ H <ﬂ51’v'<1*ﬂ§l‘1“’*“
I’! : 1 u u ‘1
” ("Twai/Mlmﬂ+<1n¥>~<1iﬂdlmm
Pasul M
1 3 W1 V, 21-“
911,7“: 2,110 P‘ 4 5‘ 6')?" I 27.10 P, u
2;;“11'?” 21,.1'51”
Rﬁumezzi 92*‘) ﬂﬂj"!

***************Ending Page***************

***************Beginning Page***************
***************page number:94**************
94
Obscrvagic

Implementénd algoritmul EM cu relagiile obginute pentru pasul E §i pasul
M. dupa execugia a 10 iteragii se vor obgine valorile 11):") ~ 0.80 §i 9g” x 0.52.
Em intorcsant do ohscrvat Ca nstimarua obginut'?! pcntru paramotrul H,‘
este acum la acela§i nivel cu cea Oman-m1 pm. metoda verosimilitﬁgii
maxime (MLE) in cazul observérii tuturor variabilelor (o an, vezi rezolvarea
(1e la partea A, punctul ,), iar Emma“ ohginut-Ia pentru paralneh'ul a” a
coburét de la valurea n as care a rm obginuté la prima iteraQie a algoritmu-
lui EM la o valoare (0.52) care este considerabil mai apropiaté (1e estimarea
pm motoda MLE (u '15).

***************Ending Page***************

***************Beginning Page***************
***************page number:95**************
95
z , \ \ \ \\ \~
1 ‘ \\ \ \ A‘ \\ \\\
\\\\ \ \>// ~ \\ \\
5‘ z ” \\\ \ \ ‘
* \\ \ \ \
>\\\\ \\ \ \ \\
w <§\\\\ \ \ \ \
‘ w \\\\\\ \ \ \
‘\wws \ \
Nomi: Implementarea acestui algoritm EM‘ precum §i graﬁcele au fast real-
izate de cine Sebasﬁan Ciobanu.

***************Ending Page***************

***************Beginning Page***************
***************page number:96**************
95
AUAUUMUUM m
» ‘ HHHHHHH*
In graﬁﬂll 315mm“ prezenhim valn- g > > , ’
rile pffg ""’ 1:‘[Z, ,\ \ XL.r/f("/], pentru ¢ ¢ *
1: 1.. a. (Evidcnlh 1/1’), :1i;/;"Z\.) o
Se nhswva r§ valnrile aces'ea cnnverg E: “ <> <> Q ° ° ° ° ° ° ° ° <> <> ° ° ° ° ° °
relaziv repede §L (ma la convergengQ g
m l'ucu chccrcu la upmumngs dc up g a
“hm-d“ (ulnar; E..- aplicii u rugum 4'.- dc» z
cizie de tipul celei folosite d2 algoritr X
mu] Bayes Naiv), atunci SE regssesc °
exact etichetele rare an ﬁrst “ﬁersefﬂ g X °
mm; (in ordino) u‘ A A, u, A! a a

***************Ending Page***************

***************Beginning Page***************
***************page number:97**************
s17
The EM algorithm for solving
a mixture of two vectors of
independent Bernoulli distributions,
aka the unsupervised Naive Bayes
Cl\/IU. 2014 spring, Aarti Sing, Barnabas Poczos, HW3, pr. 2.1

***************Ending Page***************

***************Beginning Page***************
***************page number:98**************
98

ln anve lam/es, the joint likelihood of the ants is:

d n l. a

1w) “I mesvl) I Helm [Ill-‘(Hm
lel lel lel

Let us nssume that v, e (u l} v, and Xj e (1.2 my”. Denote. the pa-
nsmetens of ply) by 1 and the nsssmetess of nlx Y) by ll. ln the presence of
labeled data (te, h ls observed for all l), we can get estlmstes nth ‘2' (mm),
l1 ':" unwell,“"mit'lllsﬁlll.an“. ml.) by counting and normalizing.
We denote. random variables by capilal letters and their values by lowercase
letters leg“ Y, denotes a random variables while n, denetes lts assignment
from the set of possible values of random vsslnhle m.
Suppese thnt we do not have labeled data. We can still estimate these pa-
nsmetens using the Expeetntlen Maximization (EM) slgnslthm.

***************Ending Page***************

***************Beginning Page***************
***************page number:99**************
sm
a, soooiry ilio (log) likelihood rilnelioo LhaL needs io be maximized.
mm: 'rlie likelihood looriioo will now he a summation over all possible
assignments L0 all mom variables‘
bi Derive ilie Estep, i.e., compute the grub-ability ofall class assignments for
each data poi-ii. given oorrerii parameters w and a.
c. Derive ilie M-eiep, Le” compute ilie parameter updates for eerli class,
given ilio class assignment distributions ror each poiol from E-step.
4i Specify o guud initializatiun iooliniqoe orirl de>cribe yuul' rationale.

***************Ending Page***************

***************Beginning Page***************
***************page number:100**************
100»
Solution
a. [LC: Letting aside the parameter n, we would write]
zit/‘HT 411k» m)
p : a , Y : i é
1% Pm .m 21% Z put) Hum‘) 2W Z Am m)
‘ei pew) iei ,ei item I)
2 Z Z qwmgih/HL in \I)
i:\ mm W’)
Z Z rib/ii logzlfui) + kai-{iw plumb/i)
b. In the E-etep, for all i. we update M‘) given the current values of w and i. Since
we know the current values of p and a, we can compuLc MM) and VeUHl/J- Taking Lhe
derivative with respect tn q(_1/,) and set it to zeip, we get the folluwing update rule:
i v,
(my, :m XII-KY‘ :ml'livtrliyt :m- and ion I 1)>1w(i2:1>1'[1~(rlm: 1i.

***************Ending Page***************

***************Beginning Page***************
***************page number:101**************
101,
c. In the Mes-ten. we know the values er (Ill/Jt su this step is very similar ta supere
vised Naive Bayes updates. Maximizing the objective runetiun with resueet te the
parameters, gives the ihllnwing update:
my a Z "(l1 : u)
let
m'KZl1(Y,eU
tel
will X 2w, :01‘th
tilt. X Zlon e 11 1PM
tel
d. A gum! initialization teehnique sheuld ineerperate uur knowledge ahuut the possible
snlutinn. If we think one class is more likely than the other, use this in nur initializa-
tien of at For the w: parameters, if we think same words are indicative ul a class‘ we
should also set the corresponding d for that word te he higher. ln the absenee of prior
knuwludgc, we can initialize these parameters runduruly.

***************Ending Page***************

***************Beginning Page***************
***************page number:102**************
1(12,
The EM algorithm for solving
a mixture of K categorical distributions
CMU, 2015 spring, Tom Mitchell, Nina Balcan, HWG, pr. 1

***************Ending Page***************

***************Beginning Page***************
***************page number:103**************
1m.

Mietnre models are helpful for modelling unknown subpupulatiuns in data.
If we have a rolleetion of dete points x : (Xe Xv,» where eneh x‘ is [in.
dependently] drawn from one of K possible distributions, we can introdnre n
diseretevalued random variable Z, e l l. Il'} that indicates which distrihu-
tion x, is drawn fromt
This exercise deels with the categorical mieinre model, where eeeh observation
X, is a discrete value drawn from a categorical distribution. The poremeter lor
a categorical distribution is a 1i-dimensionel vector r that lists the probability
of each of 1c pessihle values (therefore, D 7:‘ I l),
For eromple, suppose our rategorieel mixture model has a underlying dis-
tributions Then, eel-h Zr could teke on one of three values, {1.2 :s}, with
respective probabilities 71.11,,’er equivalently, z, ~ CnhwrnltalﬁL where r I
(ﬁergJTA) e 11H, with m — n + Fl : ll The obseruotron X‘ ie then generuted
from anuther eetegurieel distribution, depending on the value or z“
The generative process for a categorical mixture model is summarized as fol-
lows=

z, e (Yufuyrlnmﬂﬁ)

X, e (YuhlgrlnmlWZ)

***************Ending Page***************

***************Beginning Page***************
***************page number:104**************
lﬁ'l,

For this medel, where we observe X hut met z, we want te lmrn the hemmee
terns eithe 1i’ categorical eempehehts (a e {m e. .. ,h'ltL Where each at u 1P1” is
the paranmter fnr the estegeiu-el distribution associated with the l»_th mix-
tllre mmptmeut. (It implies that each Y, can take on ime of ll possible
values). We will use the EM algorithm te accomplish this.
A mite eh uetutieu uml u hint:
Wheu working with categorical distributieusit is helpful to use indicatnrfu'nc-
hens. The indicator l'uuetieh Hm» has the value l when i e 1 and o ethei-wlse.
With this uetutieu, we can express the probability that u imitlem variable
drawn from a categorical dietiihutieh (ege Y N Camqmri'nﬂm], where e ( 1R”)
takes eh s panicular value as

.\'

1,0,) Z H0?" e»
tel

***************Ending Page***************

***************Beginning Page***************
***************page number:105**************
1m,

a. Wli-at is tlia juint distn'bution P(X z (a)?
h. What is the poatﬂrinr rlwtrihutin'n nf the latent Mllr'iahltza, Ptzlx; a)?
t. Compute the aspactutt'tm of the log-likehhood,

Q(9\E>'J : Elm ellluglKXZ-B'H
d. What is the unilata stap for e? That is, what e maximizes (‘Kala/)2
Hint: Maka sure your snluﬁnn enforces tlia unnstraint that paiamataas tn
categorical distributinns must sum to l. Lagrange multipliers are a great way
tu solve constrained optimization problems‘

***************Ending Page***************

***************Beginning Page***************
***************page number:106**************
106.
Answer:
u.
PLAZZ (7)] I HP(X,,Z,:H):HP(XJZ, 6mm»)
H H
H A .w v ‘MM
i HH “Hr/M“ ‘J
r*\A:k r‘
u.
i 1M: I" P(X,\Z, :A 6]P(Z,:L-H)
P(Z, 4W, en i Puma;
‘
I\ w 'hrw) "“‘
i P(X,\Z,*k9]f'[2rk.9] 11"‘ [WUWHM ]
Z‘:‘P(Z,:LH)P(I\‘\Z,:Mﬁ) ZILWH',M:|”Q‘ J

***************Ending Page***************

***************Beginning Page***************
***************page number:107**************
107,
c.
we a’) “2 E2“ (.y[logl’(X 2.6)]
HM)
H n h M um» ,
I RAW “Kl-[H mHHM' '
UH H
,. k .u
I Ez\\'<»>' 221W“ 1~m<2ukwlwm
‘ZHZ, /:|
.. K u
I ZZEZ\XH'1{Z‘:A) mgmeleQMugm,
i */—’ ,
‘ W. P<Z,:HXVW , .
Using
M 1 ,
W v , . ﬂ'l'I: (9' WM”)
m mm'[1v,:k>] H4 HXMQWL+M-
XIZmHFﬂU)
leadsto
., h \1
Q(@\6'):ZZ’M 1mm ‘21%,, )Iugﬂw
PM’, H

***************Ending Page***************

***************Beginning Page***************
***************page number:108**************
108,
a. To ﬁnd the updates rules [or the parameters, we solve the following consLmed
apiiwn'zntian prublcrm
\thnJ/l h (new)
mhwm tn 211‘ m : 1
2L" HM : LVL : I. Ii‘
We intrniinee a Lagrange vnulbzplzm' fur each cullstruint associated tn (his pinhieni and
form the Lagrangian fwtnrilnnrll:
a a .n
L e Quaie’) + ii <1’ Em) a EM if 2”"
iei iei Fi
an we wiii differentiate the Lagrangian fnnetinnai with respect ta each parameter we
want tn optimize, set the derivative tn zero, and salve for the optimal value.

***************Ending Page***************

***************Beginning Page***************
***************page number:109**************
10"),

We’ll sthit with optimizing for h, the parameter to the catﬁgorical distribution for the
latent variables Z.

0L “ 1 1 "

i U<> ‘r, if)“, l! >i' i N

0m 2 ‘ v.‘ ‘ T‘ M; ‘
wh can ﬁh<i the value of the Lagrange multiplier A, by enforcing the constraint:

h» A» 1 H 1 h ,,

zhgiiQZxZ-h iiwxzzw fit:

m A:i iii kiwi

A” I 22M a» IZZM @A” I h
i: ,Zi ,: i:
i i i‘
siibh-titutihg this value for /\., back ihtu the expresaion of h; gives the huh-wen
_ , 1 w
m , 7, g hi

***************Ending Page***************

***************Beginning Page***************
***************page number:110**************
110,

The process for optimizing the observation pni-ninoieis eh is siniiioi. First, wo differ-
entiate the Lagrangian L with iospooi. tn 0M set to zer0_ and [ﬁnally] snivo.

2m " l

iZu “.1 g, i AA:O

as‘, ﬁg“ W“) 9i, ”

H‘ l i 1
Q : i m in
A, M H H ix‘ ,i
Again, we can ﬁnd the value nf ins. Lagrange nniiiiniior A”, by enfnrring the summatinn
runstraint:
n n 1 ., I n .,
2H1,:l¢ 2V2“ 1%,“, I I = K22“ uni“, :1
i, n
d Am , ZEML 1mg“,
i:i ,Zi
SubsLituLan iiiis value roi An back inLu the cxprcssion or 9b gives the answcr:
a“ i Elli M 1l\',:l4) i 21;. w Inga-ii
A‘ i AI n i u AI
' ZImZmM 1min) E¢:lzt:|'7ik lixiq-i)

***************Ending Page***************

***************Beginning Page***************
***************page number:111**************
111,
Using the EM algorithm for
learning a categorical distribution
[and implicitly a multinomial distribution]
Application to the ABO blood model
Liviu Ciortuz, following
Anirban DasGupta, Probability f01' Statistics and Machine
Learning, Springer, 2011, EX. 20.10

***************Ending Page***************

***************Beginning Page***************
***************page number:112**************
112.
Grupele sangvine ale Dal'nellilol‘ sunt determinate de variantele (,AValelele“)
unei gene 51mm pe crolnozolnul 9 (mai exact, la poziﬁ'd Qqamy “mam
gcna ABO‘ s0 §tic 05 ﬁccarc dintrc noi dispuncm dc cite Q pcrcchc do
astfel de cromozomi. deci de Cate doué copii ale genei ABO. $1 anume una
m0§tcnit5 do la ma 5i nna mostcnitﬁ dc la mama.
, . ~ , grupe alele

ale genei ADO. Alelele A §i u sunt dominante 4 ,1 4
in 1-3pm cu 31813 0‘ (AlLfel spus, alela 0 este ‘ ‘40
rcccsivia in “pm cu ﬁccarc dintm alclcle A §i n in?
u.) Alelele 11 §i u sunt codominante, Prin ur— BO
mare‘, grnpele saugvine an ﬁ speciﬁcate conform y

4 ,
tabclulul alaturat. —-EI
Presupunenl c5, iutr-o populagie oarecare, ﬁecare dintre alelele A‘, I3 §i
0 are la barbagi aceea§i frecvenga ca §i la femei. in cele 09 urmeazzi,
aceste frecvenge (notate respectiv cu 1m, m, §i [10) vol- ﬁ considerate a
priori necunoscuw, dar nrmnazﬁ 5-:1 1c domrminém.

***************Ending Page***************

***************Beginning Page***************
***************page number:113**************
11.x,
Location of the ABO gene on
chromosome 9 Th0 ABO protein
9:242
u,
m2
w;
w‘
9:112
w
m
w“
w‘;
w z‘
w};
m2
w
w‘
m,
mm
em
9Q)“:
m h
Sn...” Mk.
Suurcc Wm

***************Ending Page***************

***************Beginning Page***************
***************page number:114**************
111,
01.9 my’
al'l1 munx
"M 'w- lw- y
Iobabllllles alleles alleles , 2
P AA A Q + "A
PA A A AU 2 p ‘pr’
ABO ABO n ‘
PE B ' ' B BE z +
4m P
I, gene gm u
a ° ° 1m 2%,,”
i 2 n
II.“
palamelers unobservable data observable dala
culpul <|— EM Algolilhm <:1—lrlpul

***************Ending Page***************

***************Beginning Page***************
***************page number:115**************
11w.

a, Considerém c5 intriun e§antion de pop-‘1am format din n per’

soane sunL ".4 persoane cu gl'upa sangviné A, 11,; persoane cu gl'upa
sangviné B, n m pnrsuano cu grupa sangvim": AI? §i 110 pcrsoanc cu

grupa sangvina O4 (Evident, n : w“ + nu + r14“ + NU.)

Pornind (1e la aceste date Mobservabileﬁ $5 se deriveze algoritmul

EM pcntru dotcrminarca probabilititilor p,“ p” §i p1,. (Evident,
intrucét suma lor este 1, va ﬁ suﬁcient 55 se determine cloar cloué

dintre ele.)

***************Ending Page***************

***************Beginning Page***************
***************page number:116**************
115,

Indicagii
I. Prcsupnnimd c5 proccsul do asocicrc a alclclor mo§tcnitc dc
cam un individ cle la péringii lui respect?! proprietégile speciﬁcs
evenimentelor aleatoare independente, rezulté c5 probabuuagile
do rcalizarc a combinatiilor (in termcni genetici: ,,fcn0tipurilc“)
AA, Ar), BB, BO. AB §i 00 intr-u populagie oarecare sunt pf‘,
217.1110, 11?,’ 21mm, ‘Zn/m, §i fewer-m 1'3)»
2‘ Considerénd r!,\ : 11,1,\+I!,\U §i MB : m55+r15m unde semniﬁcagiile
numerolor 11M, n m, m,” §i mao sunt similarc cu sclnniﬁcatiilc nu-
merelor "A. um H.151 §i no care au fost precizate mai SUSAV este
natural m in forlnularea algorimmlui EM datele m,‘ §i Hm; 5:1 ﬁe
considerate “ncobscrvabildi Ca pummetri ai modclului, so vor
considera pmbabilimagile 1/4, 1w §i p0‘

***************Ending Page***************

***************Beginning Page***************
***************page number:117**************
117,
a. La pasul E a] algoritmului EM vc§i calcula m,‘ §i 11m,
care reprezima respectiv numiu'ul ,,2\§Leptat“ de aparitii ale
combinagiei de alele AA §i numérul ,,a§£eptat“ de aparigii ale
combinaﬁei de alele RB in pupulaﬁa datﬁ.
Ve§i scrie apui funcgia de lug—verusimilitate a datelor com—
plete (a,0bservabile“ §a ,,neobservabile“), exprimatii cu ajutorul
distribugici Mmmmmmpi. 2mm. pi». 'meg 2174p”. 115,).
4. La pasul M al algoritmului EM, pornind dc la media funcﬁci
de log-verosimilitate care a fast calculaté la pasul E, vegi stabili
regulile de actualizare pentru probabilitégile 1m, [7,, §i m.
Atcntic: sllma accstor probabilititi ﬁind 1. problcma dc opti-
mizare pekcare va trebui 5-;1 0 rezolvaiji la pasul M este una cu
nesmcgu. In acest sens, metoda multiplicatorilor lui Lagrange v5
poatc ﬁ dc £01054

***************Ending Page***************

***************Beginning Page***************
***************page number:118**************
118,
Solution
Notations:
- parameters: p (1144,11.le
(in lam it will be enough to esﬁmate ,m and m,‘ since M +1,” , m l)
o observable data: Tl,,m:{1l.‘,n,; ll WM)
. unobservable daLa: Hm» I (l: m-Y'Ao "ml-"11(1)
(in ml, we will rash'irt NW,“ m ("M 1,5,9)
0 complete dam: HUM”: WW "mull
I n I 71/1 +1“; +7151; + |l<)_ n4 I “A4 +1lm), n’; I "Eli +|l1¢0,
The likelihood of cnmplete data:
[/(I!) “:" lewllm I
,1! l ' mm - lull/ ll lll lll/
(11%)" -(2 11,1 1w)‘ Ml) (21»;1'01 r21,‘ ml (13))
M m WWW‘ 11,“)!le 1w!

***************Ending Page***************

***************Beginning Page***************
***************page number:119**************
119,
The lag-likelihood funrtion:
, M
[(1') I 1“ L0’)
I c ~ m 1mm ~ W 1n<2 w p0) + "nu 111061) ~ "mln(‘21wro)+ "Aul"('lv,\1)u)+nuln(7'?1]
: a’ + 2n“ lnp.‘ + nAo(lnp4 + mp”) A
2 "851mm + “50011115 +1np(;)+ wABUnpA + mpg) + 2 m, 111110
I (1' + 21W 111114 +01,‘ i 7L44)(lll]),‘ +lnp0) +
2 1m); 1111);; + (n); i ,1»;anan ~ 11.1w) + M4n(ln]u + 1mm) + 2 my my‘,
where C and 1,’ are constants which do nut depend on the 17 parameter.
The “auxiliary” functicm:
WM :’ Ewnm =1» *1
: + 2m 111m ~ ("A , mmm +Inﬂol +
21m; 1111);; + (m; i ﬁHR)(1hpg +lnm>l +n4n(lu1u +1“ng + 2 m) mm.
where
m : WWW W1 : EhuAhu- nu‘ W. “0:112'413’. v55’
mm I’ E[11nn\mmzpm]: Epwgm. m; m» wwfllpgﬂpgl]

***************Ending Page***************

***************Beginning Page***************
***************page number:120**************
120,
E step: As indicated by the expression of Q, here we have te compute it“
and 11M, the eepeetea number er individuals having the phenotype (aka,
the nllele pair) 4 4, and reepeetiyely BB.
Firstly, taking inte account that HM (er, equivalently, the phenotype AA),
when seen as a random variable, follows a binomial distribution of param-
rrr z
etere 1m and % its expectation will be:
(1%)" l 211i PH
I W1’
, .
(15452 + Z 1591'?
Similarly,
a“ “:’ Elllmlrynlgypm,"Op/‘Ppﬂilpg'
(1W
= m 2 l m (l) '"E'
(PU) + 2m, P0

***************Ending Page***************


***************Beginning Page***************
***************page number:121**************
121.
M step:
Given the musnaim "A +1"; + ,k, A 1, we will introduce me Lagrange vari-
able/“multiplier” A and solve for the optimisation problem
,, v v \
,IAX+H :1 <p;+l)_pg+l)_p£)+\,]
A mgmax [Q01,1.p5.pl,\p‘j’.p‘,§‘.p‘(§' I + Au A [11,1 +115 + pm]
r4 mm,
A (ugmew [1’ + 2 M4111,“ + (“A A MAXIM“ A I“ 1m] + 2 my 1MB +
A, W 1m
(NH A {155K111 p5 + 1mm) A M8011,“ + 1111/5) A 2 m, 1“ pu +
A(1 A [1,,‘ +1)‘; + mm]
Taking the partial derivatives of the objective function w.r,t. p4, pg and W
and sum“; them leads m;
1 I
1,0114,‘ +1,‘ Arm +11”) AAAnApA A Am“ +1“ +11“)
4
[TQHBE +n5 A n55 MAE) A A A u APB A X0155 + “B AME)
B
3W A MA Wm AWE +2m>) A A A o AM, A AW" A "M A "D A "DD +2710]
(

***************Ending Page***************

***************Beginning Page***************
***************page number:122**************
122,
Now, enforcing the constraint [Ll - mi l pt, : l gives
1 » » ~ s i
X<I711+7|Av m” + 71ml + m + will + '71’7|,l,\+ mi i 77ml + 21m) i l Q
2
Xvi,‘ + m; + fill; + HO) :1
l
Since H : m in]; i 11,"; + no, it follows iii-mellietely that, Y2” : I.
Therefore A I 2”. /
Together with the results obtained on the previous slide, this leads
to the following uydating mlutions:
l l
ﬁg“) I 50m + 11,4 + me)
W) 1 A
PE! I 211 ("as + we + me)
A(l+ll 1 » » , l ,
m, I ﬁg“ i 1144 +118 i "EB + mo) : 501,40 + n50 + 2m)

***************Ending Page***************

***************Beginning Page***************
***************page number:123**************
12.1.,

1» Inlplelneutagi algoritmul EM pk! care Lag conceput la punctul
n 5i rulaQi-l pcntru input-u] M i 180, nu i as mu i 13, no i 28,1
(n I 521),
Ca valori inmate pcnml parametri, vcgi 1mm mai intéi cu 1.1 I

1
11,3 i ll‘) i i’ iar apoi cu ,1,‘ i p0 i 0 1 5i "E i 0.x.
Pentru opm'm vegi cere ca pEU, ,6’; §i 14;“ $5 nu difere (ﬁecare in
part0) cu mai mult dc 10"‘ ma do valorilc calculate la immua
precedenté‘ Comparagi rezultatele obginute pentru ﬁecare din cele
done“: inigializéri‘

***************Ending Page***************

***************Beginning Page***************
***************page number:124**************
124,

Starting values: Starting values:
11,1’ rm i110 i 1/3- 11,1’ I/u i (11011 1m 419%
Iterations: Iterations:
f [1,1 pl; 111: 1 11,1 P” P1:
I 02.505 U.U(ill 0,0881 l 0 2505 0,0817 0 00118
2 0.2185 00505 07311 2 0210.3 070511 017200
'5 0.2142 00502 0 7367 '3 021413 0,0502 0,7355
1 0.2137 00501 017362 '1 02137 070501 017362
5 021110 00501 07303 5 02130 00501 017303
r; 0.2136 00.501 0 73133 13 02136 0 0501 0,7363

Note: The ﬁnal results are the same.

***************Ending Page***************

***************Beginning Page***************
***************page number:125**************
12'»,
Using the EM algorithm for
learning a multinomial distTibution
which depends 0n a single parameter
Application to a bioinformatics task:
computing probabilities for two linked bi-allelic loci
in haploid cells
Liviu Ciortuz7 following
Brani Vidakovic, Georgia Institute of Technology,
Bayesian Statistics course (ISyE 8843A)7 2004,
Handout 12, sec. 1.2.1

***************Ending Page***************

***************Beginning Page***************
***************page number:126**************
12s,
Biological background: Meiosis
Daughter
Nucleill
Daughler
Nuclei
/
\-
n /'
_,
\l ®
/~
lmerphase ‘ Meiosis | \-
Homologous Meiosis ll
Chromosomes
Source Wm

***************Ending Page***************

***************Beginning Page***************
***************page number:127**************
_ _ 127,
Blologlcal background (conﬁd)
-- -_
min
m- m-
m- m-
m» Mailer alpluld ceH ‘ ‘ um“ / mother diploid ceH
‘ “Wm “new :en ‘
‘ m. m.‘ ‘
N. m ‘ ‘ 4/. Mn
m m. ‘ ‘ m, m
1 4/. - j
" M, m "
melusli mm“
“Wm. WM
mm.‘ Wm."
Mum-"mmwm. nun-Mumnmmm.
mm,‘- hlpmlcﬂl
Mcundmmn

***************Ending Page***************

***************Beginning Page***************
***************page number:128**************
Biological background (conﬁd) 12x,
Note: Alleles A and B are dominant w“. a and respectively b.
Gelmtype:
lzaAss'lsuluulzlalAlsls
AA Au aA AA AH uA AA Au aA AA Au “A nu BB ‘Au All
BB BE BB Bb Bb Eb bB liB bE bb bb lili BB Bb liB bb
_,—,_V_,*,_,W_,
AB Ab aB ab
ME “Ah “in m
2A ‘i, l i i- l i u“ ,u
i4 .l .l .l
with ii"! (1 film All’).
We have designated iu magenta colour the offspring phououypo, in blue mo oouuus, i.o.
ulio number of individuals having a col-loin phenotype in A givou population, and in red
lilo corresponding probabilities.
Note ihai
Hull; I W and
i i u u’ I! If)!’ If]; p’i1’(lip)(1ip’)il (l Alum ,7”
Pun) A P(MB>’2 2 i 2 2 2 2’ 1 ,1 1 .

***************Ending Page***************

***************Beginning Page***************
***************page number:129**************
120,

Fie 0 variabilé aleatoare X care ia valori in mulgimea {11. 1'2. m. v4}
, V4 4 4 2+uliuliu:w
§l urmcaza dwmbugm A'Hzlfmmmal(11.T T f T , undo
u‘; cstc un paramctnl cu valor-i in intervalul (0. 1). Cclc patru prob-
abilitégi listate in deﬁnigia acestei distribuﬂi multinomiale sum. in
mmpundenga ‘um-m C“ valnrile 1-, 1-,. 1'; §i W.

a. Presupunem c5 m, 112, m §i H1 sunt "lunar-11 (1e ,,realiz5ri“
ale valorilor mmg, k"; 5i m in totalu] color n ,,obscrvatii“. Pcntrn
ﬁxarea ideilor, vom considera M. i 1251 H; i 1x1 H, i 20 §i m i124,
Calculagi estimarea de verosimilitate maximéi (hlLE) a parametru-
lui Lu

***************Ending Page***************

***************Beginning Page***************
***************page number:130**************
130,
Solution
By denoting n : ll, - 1.2 4 m l ‘1,,
_ Ql 1‘ l ll‘ l A‘ L!
and kowlng that (!t\.!|1,ln,ll,) ~llulullmllllll n T'T f7 ,
it follows um llle vernsimility function will be
‘M ) w 2+,‘ lil- lit» u
L<") Hm‘) llﬂnq'nﬂwﬂ < 1 4 4 4 '
while
my] "2 lllL(('] :lnr' - ",lll(2 l u; - (m l mlnu m l mllw
WhErE 1 is DDnstanL w.r_(. I‘.

***************Ending Page***************

***************Beginning Page***************
***************page number:131**************
131,
i) m) I in 1:2471'5 { in I in m w] (119411;)>1$'(‘2\ m) 4 in (24 M1 v)
(at; 2 \ in 1 i; w (2 \ mu mt
i mt?" Yul‘? i 21m; i "QO i 211w’ 11ml flu‘ i 2|14i‘+n‘v1 i my»?
i (2 \ t,»)(1 Uh,-
’ #0“ + "1 + m + M) n (YUM , 2n: , 2”‘ , m) + 2m
inn’ + Mm n 2/12 n 2m n 7M) + 2m
(2 + t-](l 2 tut-
Nute that the denominator (2 t M1 1w it- alway> nunitivni
By substituting 11,, HQ, m n1 for 125, 18. 20 and respectively 34. the nulnerator
becnmes flan»? +15|-+ 58.
By analysing the sign of this expression‘ it is easy to see thnt for Du!‘ dntn
the function an) reaches its maximum in the interval (0.1) for
2 *L5n\/151+41197 as n15ivm i15i231967 H‘ n
L‘ W T T 002mm?

***************Ending Page***************

***************Beginning Page***************
***************page number:132**************
132.
- -- H 1U‘l*u‘:1iqwlv _
n. me acurn “man-1:1 aleatoure ,\ ~ ‘Vultmmmnl H 5 I'T'T'Z . Valonleluate
de variabila X’, corespunzétor aceswr cinci probabimagL sunt (in ordine) m. r‘. Hz. m §i
v‘.
Observagi c5‘ in raport cu disu-ibuﬁa mummmiala de la punctul a‘ am Hdescompus“
2 > 1 ,
prubabilitatea % in anus probabilimi, 5 5i I’ ca 5i cum e12 ar corespunde uncrr
evenimente disjuncte.
Vom considera 1m, "w M, m §i respectiv m numérul dg "realizérP ale acestor valorL
ma do dam accasta m, gi m vor n ncobservabile. In sdmimb, V0!“ furniza suma
m : m, + "U ca 11am Hubwrvabilé“. mam“: do cclclalte date ubbervabilc, m. M gi 1m.
s5 5e estimeze parametrul V folosind algoritmu] EM. Cum este aceasm estimare fagé
de valoarea obginuté la punclul u?
Indimpie: Veﬁ elabura formulele corespunzﬁtoare pasului E 5i pasului M. Apoi veﬂ face
o implementare 5i veg rula algoritrnul EM (pornind, de exemplu, cu valuarea inmals
u 5 pent"! U] pﬁnﬁ cénd valorile acestui parametru pﬁni la res a“ §asea zecimalé nu
so mai modiﬁcé.

***************Ending Page***************

***************Beginning Page***************
***************page number:133**************
13.x.
Solution: E-step
The verosimility function for the “complete” data is now
7" 1 L, 1w‘ ‘JV L,
p n v I . . ,
( h) “unnammum! (2) (a) ( 4 > ( 1 ) (4)
i mnmmgmlmt 2 '1 1 '
while the con-espunding log-verusimiliLy runcuun can be WHHB“ as
lnP(D\¢‘):(rQ4v1<11u<l U) \ [H12 \H|)ln1'\lnd,
where (1 is u cunstun which dues nut depind on v.
Therefore, the ,,auxiliary“ function will be
QWVU’) i Elm... m m H. n HP" PWW)‘
: 11\:I+(n3 + "3111\(1 i .q + (m + Hm“.-
where
A J 1: ,w i E i W
1112 i pm 1,..yyl.m.,.1,L, 1 ,W ""m m.

***************Ending Page***************

***************Beginning Page***************
***************page number:134**************
13.1,
M-step
0 112+”; mm,
El PD i :
m l“ ( M 1 i ‘ a‘
03 112 4 in, m1 \ in
<51 PD: :,i,i<0
Q 01"’ [“ ( “J (1 iv)’ h: ,
:> the auxiliary function is concave
L)L111’(U\)] n<=>
i- n i I
0i I
(an + mu i u] i i1”; + "ii Q
Vr7H2+771+7VAiIHJ ‘minim
Wm I 11“ fun
n , 7m
where 2
ii“ “é shinhnniz in n. W] :1.‘ in” : W“
A Matlub ilnplcmuntutiun of this EM algorithm products v : n 62682139,
which is close to the MLE estimation obtained in pm in

***************Ending Page***************

***************Beginning Page***************
***************page number:135**************
135,
M
D /”Q \\
A: \H(n(><\w))// \\
O // \\
<
\ / \
O , \
w’ / \
\
°('vW;“"L/i\ \
Q ‘ / ‘ \
Plots made by w J ///Q(w\w‘ ) Qt \
Sebastian Ciubunu j // \ \
2 J /,/ \ \
'\ e // \ \
\ // \‘ \
3 ‘ ' ‘
T \ // ‘
‘ '///
g ‘ N w) m u»
‘ ‘ [J w w w
DB D 2 0.4 D 5 0,5 1 D
V

***************Ending Page***************

***************Beginning Page***************
***************page number:136**************
1:15,
The EM algorithm for solving
a mixture of Is’ categorical distributions,
applied to the problem 0f Word Sense Disambiguation,
i.e. identifying the semantic dumains associated to words in a
text document
CMU, 2012 fall, Eric Xing7 Aarti Singli7 HWS, pr. 3

***************Ending Page***************

***************Beginning Page***************
***************page number:137**************
The objective of this exercise is to derive the update equations of the 13"
EM algorithm for optimizing the latent variables [designating the semantic
domains] involved in generating a text doeument.
Each word will be seen as a randnni variable ii- that can take values 1....v
from the vocabulary of words. ln laet. we will denote eaeh u by an array of v
eornpunents such that il-(l) : 1 if ll‘ takes the value of the t'Lh word in the voeahulary.
l-lenre, 2);] rm) l.
Given a document containing words it,, J e 1.. ..w where iv is the length
of the document, we will assume that these words are generated from a
mixture of‘ K discrete topics:

r i

mill) : Em Phil/i.) and mm.) : H:1,(i)"'[".

lei rel
whore
a, denutes the prior [probability] for the latent topic variable z t,
ii, ‘i’ (ii,[l).. "hm. ....l,(v)). witll M) 2 u for l el ...v and 23L. all) e l for eseh
a : 1.. 1i’. and
in) "I" Pom) : llz : t).

***************Ending Page***************

***************Beginning Page***************
***************page number:138**************
138,
a, In the expectation step, for each word Mr, compute
[11(8) “:" PKZJ I Hwy)»

the probability that “U belongs to each ofthe 1t’ topics, where e is
the set of parameters of this mixture model,
Answer:

W , My. t P(u-,\Z, : my) P(z, : vw)

t : P z : t» \ H :
w I , w, > mm
i m 1>(t-,\th) i m 11L‘ 114mm
25:‘ ~. PM at) 2L‘ m I'LL, .'1.411"»""

***************Ending Page***************

***************Beginning Page***************
***************page number:139**************
1:10,
bi Iii the maximization step, compute o that maximizes marginea inferiuaré
of the log-likelihood of the data

.v
m;- e) ':" 11in mi». a)
1:1
Him: Sunling over (he 13mm topic variable, we can Write my (I) as
“ “‘ Z PM‘ vs)
Ame] I Zliiz my, ~ H) I Zliiquiit)“
4, i
14 ~ w!
Further mi, using Jensen's inequality (see pr. EM-z) we get:
v mi.‘ ~ a) ‘Y
kuQ) > 22W) 111W : 22w)!“ PW i117) + Hm];
M ~ J ' H i
Hem-e compute H as:
N
mum-Z: Z M‘) 1n may“. 0)
H r:l h

***************Ending Page***************

***************Beginning Page***************
***************page number:140**************
1-10,
Answer:
.\‘ n
U i mamﬂXZZI/m)lanfz, i SW)
0
r\ H
I ‘Kn-EHWEZ'IN) In 1%“sz I M) P(Z/ I W)
n
Hm
.\ n ‘
: @an2qu “Emmy”!
L’ 14"‘ /:|
.‘\‘ k ‘v ‘
I Mgnv-AXEZ[,L(§) 1n m+q,(@)21n 1’»(1)“""'
a
H H ‘:1
.\- l\' V
* ME'MZZMM lﬂm+‘17(5)211',(l)1|13.(!)] (14)
,,
id »:\ H

***************Ending Page***************

***************Beginning Page***************
***************page number:141**************
To opkimize ,wh 1.11,
Aﬂer eliminﬂﬁng from (14) the mm; which hm Cons'ﬂnt with respect m ,m we get:
.\ v
2w) Z ‘m 1n 1m
1,, M
We will use h Lagrangian m cnns'rain ,m m he a probabili'y dislrihuﬁnn:
w \ \
C(MU) : 2%,“)211‘](7H11J'_(7)+ A (Z J41; i 1)
H ,Z. 1:‘
Then, solving for 1,0):
U cum) :uaiq,(~)'f‘im \A:U
(mm ,4 mu)
1 N 1 ix
M W2”) “7(1)” *Um W , m
= MUZZLLW (m

***************Ending Page***************

***************Beginning Page***************
***************page number:142**************
Knowing that 2):,341) :1, we have: 142‘
2 , q w (w ,
2% It Q iA I 2201(5) “UL”
Hence, substituting for A in (15). we get:
m i Z1”L,q,<-m</> , ﬂaw (WU)
21,122.114t1wm) 232, 2mm m
2,2‘ 1m») “m $411M m)
It Z a K“)
Z;4'Iy(>1211'/(l) ’ ‘ 1
Note: Intuitively the last expression can be interpreted as the portion
[of Word[ occurrencc]s] that had “11) : 1 among nu words [in the given
document] which are deemed to belong to cluster s,

***************Ending Page***************

***************Beginning Page***************
***************page number:143**************
1-13.
To optimize m, we proceed similarly:
We begin by removing from (14) the terms that are constant with respect
L0 m, thus getting:
V
Z we) 1n a‘
,ei
So, using the Lagrangian with the constraint that 21L‘ m : 1
.\' it
am e 21W) him + A<Z7F.*1).
,ei ei
and solving for 1r‘, we have:
.\' v
a i, (a) 1
i n :[i [i A:li i i:i)i
0mm a) e» 2:; m + e» R 2m
.i'
, 1 a
‘EWZZ, 31A) (16)

***************Ending Page***************

***************Beginning Page***************
***************page number:144**************
1-1-1,
Since 21;, w. i1, it gives ns:
E 417(5) |
Zig :1 <3 TAZZWII
<3 A in»
Substituting for ix in (1s). we got:
W 2;“; w 23L‘ mm 23L‘ mm
’ LL 2w

Note: Intuitivcly the last expression can bc intorprctcd as the portion [of
word[ occurrence]s] that belongs m cluster A among the total of X words,

***************Ending Page***************

***************Beginning Page***************
***************page number:145**************
145,
T0 summarize:
E step:
V 4| IV!
q/(s): %U/ furl/:1, .w and s‘: 1. ,I\
2H '1' HM MUM’
M step:
»
~, , u‘ I
my) I w for S: l_.,.,l\’ and I : 1, , .V
Zr! 11M]
N
, 4 ‘Q
m: M fol-“:1HHJI

***************Ending Page***************

***************Beginning Page***************
***************page number:146**************
llh,
The EM algorithm for
solving mixtures of Poisson distributions
University of Utah, 2008 fall, Hal Daumé III, HW9, pr. 1

***************Ending Page***************

***************Beginning Page***************
***************page number:147**************
1'17,

Tho Poisson distribution is a distribu- ° aa , H
tion over positive ooum values; for a a s is.
count 1 with parameter A, the Poisson ° ‘ "'0

l A‘
has the form POLQUHQ'M) : A- y. s ~ U

(I .'!'. “ ° \
IL Call be pl'oven iliai ilie maximum g [K \fn'w.
likelihood osiimoiioh for x given a so l‘ ~\ ‘m ’-.__
quence of counts who,‘ was simply g :o.u'..,;;.u,,,:"..
1
, 21L, 1!, the mean of the counts. ii 5 u 15 zn
VI i
Let’s consider a generalization of this: the Poisson mixture models This is
actually used iii web garner monitoring. The nlnnber nf accesses to a web
server in a minute typically follows a Poisson distribution.

***************Ending Page***************

***************Beginning Page***************
***************page number:148**************
1'16,

Suppose we have n weh servers we arc momteririg arid we monitor

each ior M rhirmtes. Thus, we have u x l‘\1 eouhts; call T! the
mimher 0f hits te weh server 1, in mimite m. oiir goal is te cluster

the web servers according to their hit frequeriey.

Using the EM algorithm, eoristreet a Poisson mixture model ror

this problem and eerripute the expeetatiehs and maximization

steps for this model‘

***************Ending Page***************

***************Beginning Page***************
***************page number:149**************
1'1"),
Hint: SuppDSc we Whrit li clusters; lct 2, he the laterit variable
telling us which cluster the web server I belongs to (from 1 to
It’). Let, Al denote the parameter for the Poisson distribution for
cluster k, arid m the i Then, the complete data likelihood is:
,7 Av! 7,’,uau *7 H *7 *7
[.1 : '.:.i : nukﬁ: ,2,‘ Y 1,.
(A 1) I'(' H 7J ‘1114' 7i ) Hmi A 1r) my r)
_,_,
h
H I\ .‘il ‘(:rh
e UH [m H Fri/MIA.“mum]
,ei lei ",ei
where
'i:t(:r|..v..1w).withr,:1(JHUUJMlI)fol-1:1..vull.
EB’ (e,.,.v..:r>,i“ii (teem): ll‘ (h. . .lltliririri
hm, is One if I l and zero otherwise.

***************Ending Page***************

***************Beginning Page***************
***************page number:150**************
Solution 150,
The likelihood function:
ll I\' .ll 1 A"“‘ ‘<1, H
Lu“) i HH [m H [Til]
,ZlH ",Zl
The likelihood function:
7 l 7 1, K l, 1 A
mm 'l’ luL(/\ir)iZlez‘,U |Illl7rk+21ll7#]
U ‘ mu-
lil lzl M
n K l,
: 221p?“ [ml + EPA‘ +.l;n,lll.ll i lll(.,,,,)l)]
,Zl l’. NZ.
The auxiliary function:
0le W) ‘*4 Elli,,ll.._l~, "lull/u. ﬁ]
1, ll 7 .1,
: 22P(;1:HJ,./\Wirm) [1117“+2[*)\l+J,,,,ll\)\k*l!\(Jl,>m)1]:|
H lZl "H

***************Ending Page***************

***************Beginning Page***************
***************page number:151**************
151,
E-step:
p531‘ m, i my” W)
Zl¥,,P<-1.\:, :w,»1>,1~>)-P(Z, :Awwm
i Ki" 411,‘; : MW. WW)
211‘If’).P(.,\:,:w.»1\.ﬁw)
i W1” - [[jfz, Pmm(l;mm)
254%‘ ‘ Hf"; PUHMWU, WW»)

***************Ending Page***************

***************Beginning Page***************
***************page number:152**************
152,
M-step:
Since 211‘ m : I, we have to introduce the Lagrange multiplier A:
0 K
i (XHU' W +A1’ m1n~=>
m [Q \ 1 < g
H‘ I'll) Mil; l H‘ m
éxiA:0~:>m :Xém
n is easy m see that 1f" is indeed a maximum paint for Q w“. the pa-
ramcter W4
Imposing the constraint 21L, n1’ ‘ “ I 1 leads w;
1“'"( 1H1<( n
n ‘ ,, n n ,n
XLLM :lﬁgllmn :1~=>1:1¢*:"
M H "I M
T
1 r . . . .
Thcrcfuru. "gm I i 21;‘ pix. which n ulywuya u nunqmgutlvc qnnnmy.
n

***************Ending Page***************

***************Beginning Page***************
***************page number:153**************
153,
Now, regarding the paralneterb A‘:
z) ,. .u 1
i XTXW,T('7:) i1 , Vi :1
0A,“ ﬂ T ) 14:21“ ,2 + ,,,, A‘ 14:
,, 1 .u 1 ,, .‘ll ,,
21)., (#14r ANZJW) :o<_> M 2m (21W) I 11;]7“ <—>
,. .1, y
A0,,‘ I Z,:1pxk<2m:\r)
‘ “1212,21,,
It can he easily sl'mwn um for each I, E {1 HA’), the value ALP“
is positive, and it maximizes Q W.X‘.t. the parameter A,‘

***************Ending Page***************

***************Beginning Page***************
***************page number:154**************
151,
The EM algorithm for solving
a Gamma Mixture Model
G‘ Vegas-Sénchez-Ferrero, M, Martin-Fernéndez, J, Miguel Sanches
A Gamma Mixture Model for IVUS Imaging, 2014
[ adapted by Liviu Ciortuz j

***************Ending Page***************

***************Beginning Page***************
***************page number:155**************
The Gamma Mixture Model 1*”
K ,L

mew) : gmctmnnium), where Cnmm/“rhhﬁﬂ I WWW 3t,
with H‘ : (Mm) furk: 1,, K. H2 (T... ,1'K),:f:t (m. He“), andirmg (in. HM),
in > u for 1:: I. K and 21;, 77k :1,
0 e (i. d. m).
cdneider 1i. .. He" e 1R’q eeeh e, being generated by one eenmenent df the above mix-
tnie, deneted by e, e (1m ,I\').
Find the maximum iiheiiheed eetimetien er the peremeteie a by using the EM eige.
rithm.

Solution
e The verosimility of the "eempieta det-e (he), with r "2 (M. We“), end : “I”
(5‘, . en). can be written as follows:
M" M1"; Hm, my) : thiti, Wynne, an“ ‘e, : H1] lime, e‘; m1‘ I?»
'7‘ 'i‘ ‘A 1 "1 A" (.‘wimAIUM/‘i

where ‘new is the indicator function.

***************Ending Page***************

***************Beginning Page***************
***************page number:156**************
156,
- The log'verusimility function:
t ﬂ I\
w "If 1w 1.1/1 : ‘ ‘11% lnm +lnGamm1l 1, e‘
l . )
H M
, 7 q " K |
""2 “‘ 221%,” [hm in 1M‘ Anny-HAW i 111M, i I]
H H
- T1“.- auxiliary functiun:
, u ":0 mm " “ r‘
wa< '1 : EWWU, 221WH [Inn , m 1.1m *1nl‘(m]+(m i l)ln'|', , 7A]
I’! A’! '
I n I\' r
2"" ZZP(2,:L'\r,.HW)|:I\I1U n 111/1‘ lurmy > (H l)ln.r,‘ J]
_,_, = A
“HZ' 11M n;
n /\ I
I 22w [hm inlnﬂﬂ i lnrm) + (n i m“ r, i T]
H H , k

***************Ending Page***************

***************Beginning Page***************
***************page number:157**************
157,
E step

‘ I (I P1 n k ll

ﬁx“) Hg P[2,:H1, ww/Wgr- I,(11HHHH|[I,.,, ‘ ) ,, ‘1
ZAL, (lawn/111(A ,\:, : w. a) - P(,;, : k’ a)
a,‘

Gmmnuﬁl‘ m) v m
23:, cummm M M
N0te‘l]at*,‘["'>l¥fork \ .1‘ and/ 1. H and any /.

***************Ending Page***************

***************Beginning Page***************
***************page number:158**************
158,
M step: m,
Because 21;, m I 1. we will use a Lugr-uuge multiplier A, and solve as usually:
o If
i ml”+x 1’ w u<>
Um. [QM J < é ‘H
a H u .
H22“ [Inn ulnf; lurm) \ (u mu‘, 7;] :Oc'
H 1 1 H
A i ex i i ~, i,
2M?‘ Hwng,‘ m
U \ H 1 H
1:‘ : A 2w
H

***************Ending Page***************

***************Beginning Page***************
***************page number:159**************
1m.
By substituting this expression into the cunstraint 21; m I 1. We will get:
1 I\ H 1 H I\ 1
X227“ *lQXZZ'M iiwxuiiwAin
M iii iii M
Y
Therefore.
1 i.
711+“ i i _U+H
at
Note that if“ Q 01.1) for Iv: I .It

***************Ending Page***************

***************Beginning Page***************
***************page number:160**************
160,
M step: @k
lzgwwvyiwi» fly’; *an Z (i- iii a) in
6m i [:1 iii ‘3* 3f i ,if p‘ iii ii ii k i
<= Emu. , M) : n a Ziiiiisk : Zw, 4: M 2M. I 2m,
,Zi ,Zi izi ,1. ,Zi

Therefore.

.i Amy

6E“) : 21"“ (Hf; for k : 1.. ..1\'.
"k 2m 'Yii

Note that iii?“ is always positive (bCC'dHSC ii, > 0 for i : l .ii ),
and it maximizes (gun/4M w“ ah,

***************Ending Page***************


***************Beginning Page***************
***************page number:161**************
161,
M step: r‘.
By substituting [the expression of] a?” into Qlolollw we will get:
, ~ 'l
Q(I,li"m\9”') I 22M [1W i I; 1n W“ i Inn“) + (11 i 1)1n1|, i W]
l:l h’! ' h
Then, solving for the partial derivative of Qu. sli+l>lowl Will in,
amnunts to:
H '(Hll (ll
frglw l9 inn“
on
liW“ lnT fr‘ liie("‘kliil"(r )4] *1)1n'l' ii in“
011 lil \i l ‘A k h -' awn
,Ii ll
“ M l a W, PM) ,7 0 1 ,
23" |:*1!AJ‘ i “(Tullilik i m +11\),‘* 15W 0

***************Ending Page***************

***************Beginning Page***************
***************page number:162**************
162,
Since
LhH<I+mL1,,Lf)-ii ,1,” Hugh “i
0H w *0“ W gmig,‘ ‘ ‘v ‘mu ’ u
“La! m La m
and
it follows that
‘i / \
dLQU ‘Fwy/U) u<>
H
H W) , My
v ,, '1, w F ,, 1,
21x“ hm 11‘L“i"wfl\1 l ¢ hm, ‘Liyjn :0
[:1 BMW “"7 XIZWM w

***************Ending Page***************

***************Beginning Page***************
***************page number:163**************
163,
Therefore,
PM) " M)
l i i \
(“7* 1m) g ‘“

s ,. UH] H s ., ,. UH]

UH‘, 2mm 1w will will lVH) 2':in
Z” his2~ ,2, llir+Zq , it:

lil n , ll ll r is , ,, ,v
iii EM Alf/i’ ' iii iii .si EM x41 “M

Hill) < my * 0+1) L'rﬂl I" < MM‘
hill r .i L7}; : LN lllﬁ *LM ‘hm
< 1"‘) irl irl LN lfll ' Fl
sh,
1m , PM ,1“ 21;‘ ﬁlm“ , LL iik'wn h
is’ iii ii
1W1 his‘ if‘ Liznfﬁ‘
Unfortunately, there is no nknwn close form hi n satisfying this sqiraiihh.
r,
However, it can be shown Lhat Lllc [uncLion lily,‘ , % is well-behaved,
ii
yielding h unique solution w HM: iiliuw equation. whiuh will be dunutud if“;
it can he found through certain numerical methods.
Note: The funCLiDn l [7) i hm , % IS the so-called dl-gamma function.
A

***************Ending Page***************

***************Beginning Page***************
***************page number:164**************
16-1,
Note
1t is interesting t‘, see that
if ah the update equations hf this EM algorithm for solving the
i q 1

Gamma lVIixturc Model we substitute 11"" : I and 1i’ ‘ : Z fer

A e 1, . .h', we ohthm exactly the Maximum Likeliood estimations

for the parameters I and t1 of the Gamma distributiun,

***************Ending Page***************

***************Beginning Page***************
***************page number:165**************
1h’),
Deriving the EM algorithm for
estimating the parameters of two random variables
of exponential distribution,
given a set 0f instances generated by their sum
CMU, 2004 fall, T. Mitchell, Z. Bar-Joseph, HWZ, pr. 2'2

***************Ending Page***************

***************Beginning Page***************
***************page number:166**************
ms,
Suppose thnt z. ~ PXpU/M) and Z1 ~ “nu/x2), nnd M ¢ A3. zi and Z; are
independent. Let X I z, + 22 dendte the sum of z, and Z24 Suppose that
{1min ..1,.) are Lid. samples from the distribution ofAt
u. Derive nn expression for the density ul' x in tel-Ins of A‘ and A1.
Hint 1; The density of 2i is [we] : A, w“ for z 2 u, and 0 otherwise. The
density of zl is deﬁned in a similar way.
Hint 2: You could ﬁrst derive e.d.i. (cumulative distribution runetinn) of X,
which ie deﬁned tie Fm : P(Z1+ z2 < 1,) I ju’ fun‘ Adz‘) Y fAAZl) (1:2 41..
Elplanaiiun:
Fm ":’ P(Zv \Zz e r)
I / (j 'me J (My) Mei] 4:2
0 u
, f U we) 'llz) mm ye. ,/ j mm than tel yet
u u -u u

***************Ending Page***************

***************Beginning Page***************
***************page number:167**************
1m,
Exponential probability density luncliun Exponemlal cumulatlve distrlbuilon Iunmlon
2 _ H15
_ 1:‘
_ M5 2
2 — ,an
_ , A
— /:‘5
n ‘ 1 a I s a 1 = = A s

***************Ending Page***************

***************Beginning Page***************
***************page number:168**************
168,
Answer
The c.(l.f. ofX:
Fu-J'LJPLZHZQQuI/ / V“(qr/quMw/ / “Awwwrm ('12 m
U 0 U u
/00012.0v>(\0),
i r , in" H1417“), ,*/\1U
, /U( M): (r r ‘ )Jz,
u 0
, w my‘ , WM, ,f‘, 7m,
i Arm‘ “(Al Am dz, U< Am (ll,
i M ,*)\11 ,Hli/Mln ‘ rm“ "
’ 114,‘ (‘ L)" M
i M 7A,‘ [Mi/MM A,‘ , M 5A1‘ M ‘7M. 7A1‘
i iAgi)“, (a fl)’(a il)’*)\2i)\\( +)\2’)\\' is +1
1 7M 7A, 7A, A, Aze’*"’>qe’*l‘
:1’ 1,‘ ‘i,»\:1ii
MAN“ M: +Aw x, J Arm

***************Ending Page***************

***************Beginning Page***************
***************page number:169**************
lli'Y,
The p.d.f. of X:
, 411m)’ 1 ,M, ,M, i M, 7M 7M.
pm’ a, , ATM MM +MM )UrM‘ ‘ )

***************Ending Page***************

***************Beginning Page***************
***************page number:170**************
170.
br Derive the Erstep and Mrstep of the EM algorithm, and give explicit
expreeeiehe for the parameter rrpdetee in the EM process for eehrputihg the
MLE of /\| and A24
Pnsul E (Expectation): Se eeleuieeza functie Hallxiliarfi“ (media lug-
veroeimiiitatii datulur culnplulu) perrtru iteratih /=

QM i M”) I Firm rrrilluwxz M]
Pnsul M (Mamimizatinu): Se maximimazé media leg-vereeimilitrrtii datelor
complete, calculaté la paslll E, iii report cu A:
AW‘) :;Algllt1\x(J(/\ \ W)
r
Notaﬁile de lnai sus au urmatearele eemhiﬁeetih
A : (A111)
A"! : valuarea pararnetrului A 1e iteratie t
X Z variabila observabilii, cu irret-ehteie M. Mn...“
z : (thr) variabilele ascunse/necibservabile
evzrhd vulorile zi, Z:,,,.. e“, cu ,c (1.2).
aga ihezrt J‘, : 1h t at).

***************Ending Page***************

***************Beginning Page***************
***************page number:171**************
171.
Solution: E step; computation of the “auxiliary” function
00W”) I EMMA“,[lugﬂpwwmm] :EMMM [ME/mo 1mm]
,Z, ‘:1
,Zl
I EMMY, [ZUWRM*A12,i+lnx)\2*)\21n]]
‘:1
I arm,” H, [11]ngh+nlngk7 i Z(A|:,1+ Alma]
m
: nlogA‘ +v1|og/\2 i A‘ ZEWW' NAM] i A12 ENE”, MAM]
H M

***************Ending Page***************

***************Beginning Page***************
***************page number:172**************
172,
Solution: E step; computation of expectations
UM.‘ ‘Mini “'1 /‘,‘, 1|(z‘|\|,.A\"]rlz‘|
0
, w U mmww
U 1,(:,\,¢,1\A”‘> iWNW‘)-,,(:,Z\A§”) i 1mm) AIHI"*M1
i WNW”) i WAN") i WW," U H 7
z , |
: (WJT) A?“ \ [\Y'V A?“ ""
“UH” Apr. ,‘ A, >

I (AEVWU ,‘ul in)“.

m m ("My "Hm
, m *A, 1 iﬂw M. >1 ,1

***************Ending Page***************

***************Beginning Page***************
***************page number:173**************
173,
A A ‘AH’ Anlln
w ‘ ‘ w ‘ ‘ m (w H ‘ ' ‘
wﬂ‘, ‘ W / m l'(m\h->\ m‘ / w,‘ (A A 1 ﬁd.“
1mm» 1 J, -n 2 ‘ aw Awhil
l I‘ H] H\ (Amixmb
: i 1‘ A, i» v‘ > \"“dz,
va rezolva ultin-m integral)‘; rle rrmi sus utilizfanrl formula up, integrare prin vim.
" n w V " O m ‘r!’
I, A""A"' N: “Md; I 1‘ i(u*z *v ‘ﬂu,
Z (3,,.PuL"*A."1:»)"',j (,u;"**."1:,.d:"
K» u
n H 1 I, H I‘ I, ‘w ‘*i'LALMH’!
*5’ M " A1 A”
Frin urinal-u,
1 H, U m)“ M >1‘ 1
E);u-y))(n[1d] i f 1, (M1 A‘ “if
’( ‘ ) ("M A‘, n ,1 AQMM"
l‘ euybxy'xh 1
i AWLM'WMA Mix?)

***************Ending Page***************

***************Beginning Page***************
***************page number:174**************
17-1,
I, I :d + m
a Ep<m\',.wu[1‘z] I EI'lLMM-Ai' 1'1‘ i in] I 1H i 5,41% A M111]
: I, i 111,,th A" 12.x] : I, i 5mm" wwkn]
I.’ , ((x; M’ + 1
: ‘r i f Xi
My,“ m, ,1 A1." , “a
i | .1»,
i Ag) i AV? [My My}, , |

***************Ending Page***************

***************Beginning Page***************
***************page number:175**************
175,
Solution: M step
W“ i mgmemX”)
: \mgz'kninxk'CMogM+Hlug/\!*/\1XENZMMAWAMF *AZXEVUUMJUJLA)
.,» J» H H
a m , n i " r
Jam >4’ Q Migﬂwwm
0+1» n
a /\ : "i > 0
' BﬂEmamhwnlml
o n " ,
ﬁQ(/\\A“/):U <=> ;:Zu,,m.‘mm
r H
a *mn: “ " >0
2 2:1 Fp41,1\1,w;[m]
Observatie:
Se mama imediat c5 aceste 50mm intr-adevfir maximizeazé QM W).

***************Ending Page***************

***************Beginning Page***************
***************page number:176**************
1m
Deriving the EM algorithm for
estimating the parameters 0f two random variables
of Gaussian univariate distribution,
w a set of instances generated by their sum
Stanford, 2016 fall, Andrew Ng, .101“. DuchL, HW4, pr. 2

***************Ending Page***************

***************Beginning Page***************
***************page number:177**************
177,
Cnnrirler rha renewing prnhlcm. There an‘. P papnr’ enhrrrirrerl rn n machinn Irarri»
ing eenierenee. Each of R reviewers reede eeeh paper, and givee ir e snore indicating
huw good he / she rhenghr rhar paper was. We ler .r," rlenere rhe eeore rhar reviewer
r geve re paper ,r. A high score means rhe reviewer liked rhe peper. end repreeenre
a reeernrnendarien from rhar reviewer rhar ir he aeeepred rer rlie conference. A luw
ernre means rhe reviewer riiri nnr lilre rhe paper.
We imagine rhar each paper p has eerne “intrinsic” rrne valne rhar we denote by ll,"
where a lerge velne rneane il'e a guurl paper. Earl. reviewer ie rrying re eatirnatee
based un reading rhe paper, whar 1L" is: rhe eenre reported r,” is rlien reviewer Y's
guess el W.
l-leweverv some reviewers are ,iner generally inelirieel re rhink all papers are good
nrrrl rend rn give all papPrs high ernreer nrher reviPwFrs nrny he parrierrlnrly nasty
and rend re give luw scares re everyrhing. (Similarly different reviewers nrev have
diﬂerenr nnrnnnre n; verinrrre in rhe way rhey review napere, making rnnre reviewere
more eeneierenr / relieble rhen erhere.) We let r, denote Lhe ‘"bias" er reviewer v.
A reviewer wirh bias v, is one whuse eeeree generally rend re be .,, higher rhnn rhey
should be.

***************Ending Page***************

***************Beginning Page***************
***************page number:178**************
17x,
All sorts oi diwerent random iactors inﬂuence the reviewing process, and hence we
will use a model that incorporates several sources of noise. Speciﬁcallyr we assume
that reviewers’ scores are generated by a randorn process given as fullnws:
ta ~ ,th 0;)
ta ~ Mean’)
‘,alvnea e .wv," “their.
The variablea rt, and 1,‘, are independent; the variables tr y z) ior dllierent paper-
reviewer pairs are also jointly independents Also‘ we only ever ohserve the J',,,’5;
thus, the m» ‘s and spas are all latent random variahles.
We would like to estimate the parameters p,“ r5, m, r3. Ii we obtain good estimates
oi the papers‘ “intrinsic wilues" a,” these can then he used to mahe acceptance /
rejection decisions ior the conierence.
We will estimate the parameters by maximizing the marginal likelihood oi the data
(1,” p e 1 .P, r : l, R}. This problem has latent variables y," and 1,,“ and
the maximum likelihood problem cannot he solved in closed form. Sov we will use
EM. Your taslr is to derive the EM update equations. Yuur iinal E and M >£€p
updates should consist only oi addition / subtraction / multiplication / division /
lug / exp / sart oi sralars; and addition / auhtrartirm / multiplication / inverse /
determinant oi matrices. For simplicity, you need to treat nnly luv of, p : 1,. Pl
and {14,12 r r : l .R) as parameters. l.e._ treat w: (the conditional variance oi
t,“ given up, and s,,,) as a ﬁxed, known constant.

***************Ending Page***************

***************Beginning Page***************
***************page number:179**************
170,
as In this pert, we will derive the E-slep:
r. The icint distrihrrtien my,” 1,,‘ my has the form of a rnniiivariate Gaussian
density. Find its assuciated nrean vector and covariance rnatrix in ternis uf the
parameters W, "5,, u“ 1,‘. and "I.
amt: Recognize that 1,” can be written as tr, : y,” + z," A 5,“, where a,“ ~4v(n,.1=)
is independent Garrrsian nuise.
i1, Dcrivr an (‘XPression for ‘MAI/When) "‘:' rm, z,,\t,,,] (Erstcp), using thr rules
for conditioning ch subsets of icintiy Gaussian random variables (see the ncies
on Factor Analysis‘ http://cs22n,stanierd,erin/nctes/cs22aehetessmdrr acceseei at 7
August 21m).
b. Derive the M-sten updater te the parameters (We, aim’),
Hml: 1t nrav help tc express the luwer humid on the likelihuod in ternrs of an expec-
Lation with respect tn (W. 2,”) drawn from a distribution with density q," (mn- z,,, >.

***************Ending Page***************

***************Beginning Page***************
***************page number:180**************
1x0.

Solution
a. Let 1/ denuLe the wlinle set ol' parameters we are estimating.
Then the steps oi the EM algorithm tor our problem are (at a high level):
(E-sLep) For eaeh oi set WW,“ ;,,,)“l' My,“ emitter/"Us
(hi-step) Set 11W" eugnnxﬂsz ‘2" ,L'UHM : ,lnnttwt," 5,‘, m.
important remark for the E-step:
Il'we use Bayes’s Rule to compute pm, s," it,” ), then we’ll get integrals oi Gaussiaus
in the denominator, whirh are toueh to rornoute. lnsteoil, ohservr that

tilt," . s,“ a") : my", an) mt," ltn ,sw)

: MUM I'[-‘-l>|) I’(‘17Yiy|n>lv‘]
is Lint pruduct uf Litre: Gaussian densities, su il. is iLsell' a mullivunulr Gaussian.
density.
As n i-nnsrqneme, tin.- jnint rliatriliutiuu pm, z,,, 1W] is alsn same tyne ui Gaussian
distributiun‘ and we can use the rules for Condihﬂlnvlg annssinns to compute it.
To gel a iurni for its densiLy runetiun, we‘ll exploit. tlie fact tliat a multivariate
Gaussian density is fully paraineterized by its mean vectur and covariance matrix.

***************Ending Page***************

***************Beginning Page***************
***************page number:181**************
1&1,
- To compute the mean vectur, we“ rewrite I,” in the following ww:
1,» : y,” + z,“ 4,7‘
where 5,, ~ Mu n‘) ix independent Gauuxian nuke.“
Them
Elw] I M
Film] I u,
Em] I Em + z," +5,” : Elm + Em] +E[§,,]
: WW. +n:»‘,,+u.
,. T» aw why Hus mum“ horn n» dehulnuu m m? prublm: nuwmem observe Hm the pwmnm HM 5/" Z
.,., w," , :,., mm on any mm value g ,1
ﬂu," : qwdwl : 1,0,, , y», , 1,,‘ : Ewmdm
i \1. ~+ +2‘ ~ )ii‘ ax (fig?)
p ,H K v," ,7, v,“ .4,“ ma v w
\th11 dam 1m mm,“ on m1“, W m 5,,‘ Hence 5,,‘ can ht "gmm M mdrpcnrkm “mum Gmhmun “m
\mh <13 \mmnﬂ'

***************Ending Page***************

***************Beginning Page***************
***************page number:182**************
1&2,
. Tu romPute me mnmnnee mama observe max Vam/w) : a; VGK'JW) : 1,’, and
m,n(y,,,,z,,,) e mm," W] : n (since 5/1,, and 1,. are independent). Also, since W,
1,, and (p, are independeni, we have
mum) : vim/W +:,, ~ em) : vmyWH Vm(z,,,)+ \'m(:,.,>
e "penal
Finally,
own/n, in) : "Miami/n): Emmi/H, + 1y, +6," w)
e L'ou(y,.,.y,,,)+ commim ~ Gui/(5," in)
e mime”;
where the secund in 1m equality fulluws frunl independence uf y,,, 1,. and 5,».
Similarly, we can show that mm, ,1,,,) : Uou(:,,,, ,n,,,> : 1,1. This allows us m write
ii, .15 n oi
m". I”, .1," ~N i», , u T? 1,1
/i,>+|/, ",2 1,} 0,1,“? H1

***************Ending Page***************

***************Beginning Page***************
***************page number:183**************
133,
NDW WC rim use the standard results for Conditinning 0n inbscti 0' variabIri for
multivariate Gaussians (see Appendu‘ A. Mathematical jmmdnllons in Pnllewz cm,
sx/icntum (2nd 211.), R, Duda, P. Han, D. Stork, 2001) m obtain:
,,J ~ . J , ,1," y 2",» 11 2," zv
11,, (1,1,) , v<u,,,.,,,\.1,,,,e>i.\ ([ 11,,1 ] [ 2111 E», H ,
where
, , ,,,, + ﬁn, 111,11)
11,, i [111: 1, [ 4174+ , (1'1)
,1, + mm, 1,1,, 11,)
2,, :1. 1 "l, 1,1 +1! 451,1

***************Ending Page***************

***************Beginning Page***************
***************page number:184**************
Solution 184’
b. For the M-step maximizing the expected log-likelihcmd, we have (letting 5,,[1 denute ex-
pnﬂdlﬁﬂns wiui rnspcnl w qp, (W, ,z,,,) [0r cash Ii and L rrspnctivrly),
W“! 7 My"? Q(ﬁ 4"‘).
where
WWW, 7 '2 ‘Z a, mm W R]
PM‘ l 2 VLWW V i W1

7 2,51, 251, r,,[ Iﬁ 7 217W 7v,“ 77,,‘ i1 7 5,1,“ 7M): 7 2i“ 7V‘ )1]

‘:'“ 2,1,27;[ h-ﬂ‘ 7 ,lzisvni,“ 1117:», ¢/.H1i»,,+i»,‘,>7 3:,‘(Eiillm >‘17zs,.[z.~1|/ +141]

7‘" 2,7,, 21¢ mi 7 in; Vi Mi, y 72W» mm 7 lidu,” Hi M3, z 72M z v, +1151]

***************Ending Page***************

***************Beginning Page***************
***************page number:185**************
1x5,
Th2 equality in the last line fulluws (rum
qux/w] Z u,” i and Evlww W : (Eu w," )1] i E“ m‘) + Brit/WI" : >2,“ i it + iii, » -
Similarly for um“ and mu," f].
setting the partial derivatives w.r_t. parameters M, v‘, 07,, Y, to 0,
\ R i R
imgﬂuwnwiweir“: kguwt (is)
1 " A) , A 1 " ,
*3?an rzr,"1i:u~.,,:?zwz (1U)
iti+iig i1 izt ,1] :Ué
7] .1" a; Mi “mi i,“ v w up
\ r
i z i
0,, : 7t 201,,” y — um- r zit," y it, + “,1 (21>
‘v l l
Z [*7 + ﬁx" u Hts, z m," 1 t, Us] Z t j
1 r
+3 : F gm.“ Hi“ , 2M, t/Y + 11,2) ‘21>

***************Ending Page***************

***************Beginning Page***************
***************page number:186**************
1&6,
Using Lhe above results.
w ran rrstatl‘ m“ E and M mp5 in mm nf artual wmpumim:
(Brawn) For (‘th ,1, 'w computc W, z," using equations (11)‘ (18);
(Mistep) For each p‘ y, cnmpute M, U,‘ (1,1,4 1;‘ using equations (19), (20)‘ (21), (22).

***************Ending Page***************

***************Beginning Page***************
***************page number:187**************
1m,
Using the EM algorithm for
learning a Poisson distribution
when some data 0/!‘8 missing
Liviu Ciortuz7 following
Anirban DasGupta, Probability for Statistics and Machine
Learning, Springer7 2011, Ex. 20.8

***************Ending Page***************

***************Beginning Page***************
***************page number:188**************
18x.
Presupllnem c5 vmn is lnorlelﬁrn mimic numﬁrul de accidente llQDare mm s-au prod";
in n locaﬁi intr-un anumit interval de timp‘ 55 Zicem 0 sapminsinsi. In ace-st smp, VOm
folosi o dimibngie Poisson de paramﬂru ,\v La sér§itul perioadei de mnp respective, ni
so Lransmitc £10 la m din cclc n lucagii cine o Hinrcgierm-c“ (notatli cu T‘), rcprczcnlﬁnd
nnnnirni dc ucciduntc \lguiu'c prudusl: in lucixﬁu z.
in mod implicit, at Ll‘cbui 55 considcrém czi in celc n , m locagii do la care n-am primit
iniegimziii nu H prudus niuiun accident. Insi, in urrnu ,,inspect5\rii“ dutelor suntan-A
determinagi in inani in considerate preaupune'reﬂ c-zi in unele din uceste k incngii Hi
prudus cite nn [singur] accident “Sm. care a fest ,.Lr2c|1t sub tﬁcere“ la rnpnnam.
Agudur, funnulizéuld. Win cunsiLlcru dutch: Hnuubscrvubilc“ z, : numqm : on“, I
l . 2M“, :1, cu m, +1.‘ : n , m, aléhll'i d2 datele observabile 1-‘ .. rm e N. Tum.
aceste date sunt produse de variabile aleatnare nnnand disiribnun Pnnwn de [acelasi]
parametru A.
Elnhnraﬁ algnrﬂmul EM (in speﬁi pasul E 5i pasul M) penh'u Psﬁmarea parm-netrului
A.
Sugestie: in 1m: 55 Se lucreze Ell z, cu , : 1, .m, va ﬁ suﬁcient 55 cansirleraﬁ ca date
neohsarvahile in, 5i m. Mai innu. mnsidenind nulnerele n 5i m cunnscute, va ﬁ suﬁrient
55 lnmgi dear \‘u in ca (ma neobservabili (bineinyeles, pe limgi datele observabile n)‘

***************Ending Page***************

***************Beginning Page***************
***************page number:189**************
1x0,
Answer
n- JUN-2%.‘. .zm-m-u -1,H~Pv'~‘~v"(*)
. 1 x
Poisson p.m.r.= mm i 07 7
The verosimility of complete data:
m) “" I'm Jmn 1W. W‘ 1mm
‘ H "(:YW H'WW H70’- H 7F H7’,
/:\ ,Zv ,Zv‘ FWw' ,Zv‘ u
l M m A“ , 1 M m A"
H“ 1 -w l
I ,7"; LN. I ,M. “Lani
The log-verosimility 0r complete data:
‘(Mg/1111.0): M‘ (1,, \Z'|,,)lu/\ 211m!
,Z, ‘:1

***************Ending Page***************

***************Beginning Page***************
***************page number:190**************
190.
Thu auxiliary l'uncﬁun:
QUW“) “" L,“ i [Mi] *7!)\*(E[Hi‘liAH11+ZU>|XIAiZIHIVV
‘:i ,Zi
E-step:
11in, i i. W is the expected number of unobservable instances 1, having value i‘ out of
the total of n , in unobservable insinnm.
The deﬁnition of the density function for the Poissun distribution implies
j i A‘ i j 1 A" i
l(::l\)\]:(j 7:5 AandlKJ:O\/\):(j W77‘
Therefore Finn, Wi is exactly the expectatinn of the binomial distributinn
An,
v Am
L[7h\,L(.)\“‘] I (u inﬁwv

***************Ending Page***************

***************Beginning Page***************
***************page number:191**************
191.
M-step:
Now we can write
W M v
ng ): in) i [w i MW +2 I, hm i gm I‘
The ﬁrst two derivatives of this function Wm. /\ are:
a AW 1
i u, I , , , , ,
(,MQQM 1 n [(7, m] x +A‘” +2 .,] A
01 ‘,n M" 1
WQOM j i """'>W*;" F

***************Ending Page***************

***************Beginning Page***************
***************page number:192**************
192,
nam the prehletn’s statement we know that n 2 m and 21'; r, 3 ur
At the initializatien step nf the EM algorithm the parameter A is asigned a
positive value (AW), and we will soon see that A'” > u at each iteration r > ll.
Therefore, the second derivative of Q is always negative, meaning that Q is
roncave and therefore it has a maxinlurn.
1n order ta ﬁnd this maximum we equate the ﬁrst derivative ta n, whieh gives
us the update Plruahnn:
1 Mil
Hm e , s

A , n [M m)l+)\<" +2‘)

One can easily see now (ny induction) that A" ' " > u.

***************Ending Page***************

***************Beginning Page***************
***************page number:193**************
193,
Using the EM algorithm for
estimating the selection probability for a mixture
of two (arbitrary) distributions
CMU, 2006 spring, Carlos Guestrin, ﬁnal exam, pr. 8
CMU, 2004 fall, Carlos Gucstrin, HW2, pr. 241

***************Ending Page***************

***************Beginning Page***************
***************page number:194**************
191,
We want to derive an EM algorithm for estimating the mixing parameter
for a mixture of arbitrary probability densities fl and jz.
For example, Mr) could be a standard normal distribution centered at
0, and /2(;!:) could be the uniform distribution between lull. You can
think about such mixtures in the following Way: First, you ﬂip a eoiu.
With probability A lie, the coin comes up heads), you will sample :I' from
density f,, and with probability (1 e X) you sample from denaity fa
More formally, let Mr) I )i/1(.1)+ (1 emu i), where j, and /_> are arbitrary
probability density funetiona on TR, and A e [u I] is an unknown mixture
parameter,

***************Ending Page***************

***************Beginning Page***************
***************page number:195**************
19'»,
a.
Given a data point r, and a value for the mixture parameter A,
eompute the probability that .i' was generated from density A‘
hi
Now, suppose you are given a data set {i}. . “1,, } drawn i.i.dl frnm the
mixture density, and a set ofcoin ﬂips (a. :2. v .1“), sueh that a l means
that i, is a sample frum fl, and zl : n means that :I', was generated from
density f2.
For a ﬁxed parameter A, eompute the eomplete log-likelihood of the data,
iiel, 1l|P(.'l'\,zl. i,z.s,. Hinzem
e.
Now, snppese you are given only a sample {.rr .ru} drawn iiill front
the mixture density, without the knowledge about which component the
samples were drawn from (i.e., the s, are unknowny
Using your derivations from part ii and h, derive the E- and M-steps fer
an EM algorithm te eempute the maximum likelihood estimate (MLE) of
the mixture parameter Al

***************Ending Page***************

***************Beginning Page***************
***************page number:196**************
196,
Solution
. i i i w i L“)
a' PM’ “X * '1’ mx :11) i 0(1)‘
b. P0111 Mt ,Mum:nyﬂpuhzm:111L,(1>(1,\:.,M1mm)»
__ i Mm) if:,:l
PWWM PLZ'W i {[1 mm) if:,:n
I M'maz'uw‘ "/Zm'
Therefore,
111P(|‘.:‘|2.12 _7H_;")\]*Z|Y\T’[1,_Z,)\]
.:\
Z Zn. (rmmm , A)":'[1(1,)"‘)
H
:annA . ln/|(.w,,)) x (1 mum A) \ 1.1mm»
H

***************Ending Page***************

***************Beginning Page***************
***************page number:197**************
197,
‘.- <
v ,,
E'Mp: (1b,) "‘:" P(4,:1\'|,,,A‘~'1)”:'" 2%’;
M-step:
AWN’iurgymeﬂlnHPL:1,:1..|;,:;. ,WZHW
: nrgumXUnA-241(Z|)+|h(l , A] Zn , (1(9)):
A , ,,
x l ,
0 1 "iv
ﬁwmﬂwﬂmuim m; m
¢ (-(1 A):A(n (-)='(-:M='A:£:M
,, H
W‘ ” no)
> Wm i ,
~ 2mm
Note- £('ln/\+(li )hliiAJJ ,£,(,,, 1i‘ <0 > W“ Barres ondsma
'w‘ ' ‘ ‘ A (1%)!’ P
maximum.

***************Ending Page***************

***************Beginning Page***************
***************page number:198**************
15m,
Note
The EM algorithm can [be naturally extened so as to] handle mix-
Lures of an arbritrary (although ﬁxed) number of probabilistic
distributions.

***************Ending Page***************

***************Beginning Page***************
***************page number:199**************
190.
Exempliﬁcation [for a mixture of 3 densities]

Source: Brani Vidakovicr EM Algorithm hm Mixtures [Handout 12]
A sample of size 150 is goneraLed ri-em
HM: Inixtlu'c

, 0 HAS

[(1] :rmw a 2')H7.i\,'\f(1].ll a’) l uzwz 1).
where .v dehetee the nnnnal distribllr ‘l
ﬁn“.
The mixing weights are estimated by the m
EM algorithm.
ill I 20 iteratiuns of the EM elgerithm m r
yielded the weights (04971 02731 and V ‘ f‘
u 22ml. =1“ y t
The nearby ﬁgure shows the histogram _!I II l.‘-
of data, the lheoreﬂcal mixture (dolled “ -1ﬂ .5 5
line) and the EM esﬁmate (solid line).

***************Ending Page***************

