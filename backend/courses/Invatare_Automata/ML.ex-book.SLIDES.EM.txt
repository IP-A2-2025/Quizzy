***************Beginning Page***************
***************page number:1**************
1.
The Expectation-Maximization
(EM) Algorithmic Schema
Contains:
ex. 1, 2, 5, 6, 7, 8, 11, 27, 14, 31, 12, 34, 35, 15, 16, 17, 18
from the 2023f version of the ML exercise book by L. Ciortuz et a1.

***************Ending Page***************

***************Beginning Page***************
***************page number:2**************
2.
Algoritmul EM, fundamentare teoreticéi:
pasul E [gi pasul M]
CMU, 2008 fall, Eric Xing, HW4, pr. 1.1-3

***************Ending Page***************


***************Beginning Page***************
***************page number:3**************
3.
Algoritmul EM (Expectation-Maximization) permite crearea unor
modele probabiliste care pe de 0 parte depind de un set de parametri
€ iar pe de altii parte includ pe léngéi variabilele obignuite (“observabile”
sau “vizibile”) :13 §i variabile necunoscute (“neobservabile”, “ascunse” sau
“latente”) z.
in general, in astfel de sitanii/modele, nu se poate face in mod direct
0 estimare a parametrilor modelului (€), in aga fel incét sﬁ se garanteze
atingerea maximului verosimilitéigii datelor observabile at.
in schimb, algoritmul EM procedeazé in manieré iterative, constituind ast-
fel 0 modalitate foarte convenabilﬁ de estimare a parametrilor €.
Deﬁnim log-verosimilitatea datelor observabile (at) ca ﬁind 10gP(a: \ 6), iar
log-verosimilitatea datelor complete (observabile, :c, §i neobservabile, z) ca
ﬁind 10gP(x, z | €).
Observaiie: Pe tot parcursul acestui exercigiu se va considera funcigia 10g
ca avénd baza supraunitaréi, ﬁxaté.

***************Ending Page***************

***************Beginning Page***************
***************page number:4**************
4.

a. Log-verosimilitatea datelor observab'ile (x) se poate exprima in funcgie
de datele neobservabile (z), astfelza

KW) 11g. 10gP(x | <9) I 10g (Z P(x,z | 9))
in continuare vom nota (:u q 0 functie / distribugie de probabilitate deﬁnitéi
peste variabilele ascunse/neobservabile z.
Folosiigi inegalz'tatea lui Jensen pentru a demonstra cii are loc urmﬁtoarea
inegalitate:

P(a:, z I 6)
10ng | H) 2 Zq<z>1@g(— <1)
Z (AZ)
pentru orice x (ﬁxat), pentru orice valoare a parametrului (9 §i pentru orice
distribuigie probabilisté q deﬁnitéi peste variabilele neobservabile z.
a Regine‘? c5 :Jc, vectorul de date observabile, este ﬁxat (dat), in vreme ce z, vectorul de date neobservabile, este

liber (variabil).

***************Ending Page***************


***************Beginning Page***************
***************page number:5**************
. 5.
Observagle (1)
Semniﬁcagia inegalitﬁgii (1) este urmﬁtoarea:
Funcgia (de fapt, orice funcgie de forma)
def. P(:1:,z | (9)
F0179) I Q(Z)1Og (—
Z; (1(2)
constituie 0 margine inferioarﬁ pentru funcgia de log-verosimilitate a
datelor incomplete / observabile, 5(6) n25. 10g P(9c | 9).
Remarcaigi faptul (:5 F este 0 funcgie de douii variabile, iar prima variabilél
nu este de tip numeric (cum este 9), ci este de tip funcgional.
Mai mult, se observii (:5 expresia funcigiei F este de fapt 0 medie,
P x z €
EM [10g Q] 7
(AZ)
atunci cémd x, q §i parametrul 9 se consideré ﬁxagi, iar z este léisat sé
varieze.

***************Ending Page***************

***************Beginning Page***************
***************page number:6**************
6.
Solugle
Inegalitatea lui Jensen, in contextul teoriei probabilitiitilor:
consider-51nd X este 0 variabilé aleatoare (unaré),
dacéi 90 este 0 funcgie (realéi) convexé, atunci g0(E[X]) g E[90(X)];
dacé 90 este funcgie concave, atunci 4,0(E[X]) Z E[g0(X)].
Aici vorn folosi funcigia 10g cu bazéi supraunitaré (funcigie concavéi), deci aplicénd inegal-
itatea lui Jensen vorn 0b§inez 10g(E[X]) Z E[1og(X)].
Log-verosimilitatea datelor observabile este:
no . P , 8
KW) It 10gP($ \ (9) I 10g (Z P(a;,z I (9)) :10g(2q(z)(x(—z)l)>
Z Z q Z
def. P($,z | 6)])
I 10g (E Z [—
q( ) q<Z)
. .V.. . A . . P(a;,z\6) v
Conform 1nega11ta§11 lu1 Jensen (lnloculnd X de mal sus cu T), rezulta:
q z
£(9) nit 10gP(:c | 9) > E [10g —P(£E’Z I 6)] dif' Zq(z)10g —P(yc,z ‘ 6)
_ ‘1(2) (1(Z) Z 61(2) ’

***************Ending Page***************


***************Beginning Page***************
***************page number:7**************
7.
Notaigie
in continuare, pentru a v51 aduce mereu aminte c5 distribugia q se referé
la datele neobservabile z, vom folosi notagia q(z) in 10c de q.
in consecingé, in cele ce urmeazﬁ, in fundgie de context, (1(2) va desemna
ﬁe distribu§ia q, ﬁe valoarea acestei distribu§ii pentru 0 valoare oarecare
[a variabilei neobservabile] z.
(Este adeviirat 051 aceastéi lejeré ambiguitate poate induce in eroare citi-
torul neexperimentat.)

***************Ending Page***************

***************Beginning Page***************
***************page number:8**************
8.
b. V5 reamintim deﬁnitia entropiei relative (numitéi §i divergenta
Kullback-Leibler):
P z :13, (9
KL<q<z> H P<Z \ w» I - Zq<z>1og(%)
Arﬁtati c5
10g PCB | 9) I F(q(Z), §) + KL(Q(Z) || P(Z | $79))-
Observatie (2):
Semniﬁcatia egalitiitii care trebuie demonstraté la acest punct este foarte
interesantéi: diferenta dintre functia obiectiv K6’) n25. 10gP(x \ 9) §i marginea
sa inferioaréi F(q(z), 9) — a se vedea punctul a — este KL(q(z) H P(z I at, 6’)).
Tocmai pe aceasté chestiune se va “construi” punctul ﬁnal, §i cel mai
important, al problemei noastre.

***************Ending Page***************


***************Beginning Page***************
***************page number:9**************
9.
Observagie (3)
Ideile de baza ale algoritmului EM sunt doua:
1. in loc sa calculeze maximul funcgiei de log-verosimilitate logP(:v l €) in
raport cu <9, algoritmul EM va maximiza marginea sa inferioara, F(q(z), (9),
in raport cu ambele argumente, q(z) §i <9.
2. Pentru a cauta maximul (de fapt, un maxim local al) marginii in-
ferioare F(q(z),9), algoritmul EM aplica metoda cregteri'i pe coordonate
(engl., coordinate ascent): dupa ce ini§ial se ﬁxeaza M0) eventual aleatoriu,
se maximizeaza iterativ functia F(q(z),6), in mod alternativ: mai intai in
raport cu distribuﬁa (1(2) §i apoi in raport cu parametrul 6.
Pasul E: q(t)(z) I argmaXF(q(z), 905))
q(Z)
Pasul M: 9U“) I argmaXF(q(t)(z), 6’)
6

***************Ending Page***************

***************Beginning Page***************
***************page number:10**************
10.
Soluigie
mica), w ‘if Z q<z>10g (W)
P z xﬁ ~P a: <9
z 261(2) [10g —P(Zq(‘5’m +log P(a: | m]
I Zq(z) 10g (W) + Zq(z) 10gP(:1: | €)
Z —KL(q(z) || P(Z | x,(9)) +10gP(iv | 9) - 261(2)
Q27,
i lOgPCE l 9) I F(Q(Z)>9) + KLMZ) H P(Z \ $79))-

***************Ending Page***************


***************Beginning Page***************
***************page number:11**************
11.
0bserva§ie (4)
Conform proprietégii KL(p H q) Z O pentru Vp,q, rezultii KL(q(z) H P(z I
x, €)) Z O.
Agadar, din egalitatea care tocmai a fost demonstratéi la punctul b 0b§inem
(din n0u!, dupéi rezultatul de la punctul a) (:51 F(q(z),6’) este 0 margine
inferioarii pentru log-verosimilitatea datelor observabile, KW) n2. 10g P(:z: | <9).

***************Ending Page***************

***************Beginning Page***************
***************page number:12**************
12.
c. Fie 96) valoarea 0b§inut51 pentru parametrul / parametrii (9 la iteraigia t
a algoritmului EM. Considerénd aceastﬁ valoare ﬁxatﬁ, arétaigi (:5 maximul
lui F in raport cu argumentul / distribugia q(z) este atins pentru distribugia
P(z \ :13, g(t)), iar valoarea maximului este:
q z

***************Ending Page***************


***************Beginning Page***************
***************page number:13**************
13.
Solugie
Trebuie s5 maximizém F (q(z), (96)) — marginea inferioaré a 10g-
verosimilitéﬁi datelor observabile x — in raport cu distribugia q(z).
Pe de 0 parte, rezultatul de la punctul a ne spune c5 F(q(z), 8) g 10gP(x | <9),
pentru orice valoare a lui (9; in particular, pentru Wt) avem
10gP(1'\ 9w) Z F(q(Z),§(t))
Pe de alté parte, dacé in egalitatea demonstratii la punctul b se inlocuie§te
6’ cu <9“), rezulté:
10g 13(1' I 9(0) I F(Q(Z), 9(a) + KL(q(Z)HP(Z \ 1379(3))
in ﬁne, dacé alegem (1(2) I P(z | 33(6), atunci termenul KL(q(z)|\P(z I
x, 9(6)) din dreapta egalitiiQii de mai sus devine zero (vezi exercigiul [PS-31]
de la capitolul de Probabilitéiﬁ §i statisticéi).
Agadar, valoarea maxqw F(q(z), (9(6) se 0b§ine pentru distribugia q(z) I P(z |
x, 9(6).

***************Ending Page***************

***************Beginning Page***************
***************page number:14**************
14.
Acum vom calcula aceasté valoare maximéz
10g PW‘ | W) I Hiafﬂqv), 9w) I F(P(lv I 9w), 9w)
q z
(t)
deiF (t) P(x, z \ Q )
_ 21%| M )10g<—P(mje(t))
P(:z3, z | 300)
— EPW” [10g W
: EP<Z|$,9(@) [10gP(:13, z|6(t)) —10gP(z|x,(9(t))]
= 62(9“) W”) +H[P(Z | Mm
unde Q<9 I 906)) n25. EP(z|ac,6(t))[10gP($vz I 9N‘

***************Ending Page***************


***************Beginning Page***************
***************page number:15**************
15.
0bserva§ie (5)
Noténd Gt((9) dIf' F(P(z | x, W9), (9), din calculul de mai sus rezulté 05
Gt(€(t)) I 10gP(x | W”) I 62w“) | (9(t)) + H(P(z | x,€(t))). Se poate demon-
stra u§0r — procedénd similar cu calculul de mai sus — egalitatea
G143): 62(9 | 9(a) + H[P(Z i I, 903)]
Observénd (:5 termenul H [P(z | at, 9(0)] din aceasté ultiméi egalitate nu de-
pinde de €, rezultéi imediat c5
argmax Gtw) I argmaxQW i W»)
e e
in consecinigii,
6<t+1> dIf' argmaXF(P(z i :13, 9w), <9) I argmax G49) I argmaXQ(9 i (9(6)
0 0 0

***************Ending Page***************

***************Beginning Page***************
***************page number:16**************
16.
and}
From: ‘ IDE Pfx;9)
What is the expectation maazimiza- 6.111%?
tion algorithm?
Chuong B. Do, Seraﬁm Batzoglou, 6LT] A"
Nature Biotechnology,
vol. 26, no. 8, 2008, pp. 897-899
gr-l
gr

***************Ending Page***************


***************Beginning Page***************
***************page number:17**************
17.
Egalitatea precedentéi este responsabilii pentru urmétoarea reformulare
(cea uzualé!) a algoritmului EM:
Pasul E’: calculeazé Q(<9 | (9(0) : EP<Z|$,6(t))[10gP(x, z | €)]
Pasul M’: calculeazé (WM) I argmaxQW \ 305))
a

***************Ending Page***************

***************Beginning Page***************
***************page number:18**************
18.
Algoritmul EM:
monotonie / convergenﬁi
prelucrare de Liviu Ciortuz, dupé
en.wikipedia.org/wiki/EXpectation-maximization

***************Ending Page***************


***************Beginning Page***************
***************page number:19**************
19.
Pentru a maximiza funcigia de log-verosimilitate a datelor observabile, i.e.
HG) déf' 10gP(x | 6’), unde baza logaritmului (nespeciﬁcatﬁ) este consideratéi
supraunitaré, algoritmul EM procedeazé in mod iterativ, optimizénd 1a
pasul M a1 ﬁecﬁrei iteratii (t) 0 functie “auxiliarﬁ”
<t> dif' 1 P e

reprezenténd media log-verosimilitégii datelor complete (observabile §i
neobservabile) in raport cu distribuigia condigionalé P(z \ x, 6w).
Vom considera iteragiile t I 0,1,. .. §i 605+” I argmaxe 62(9 | 96)), cu 9(0) ales
in mod arbitrar.
Demonstraigi (:5 pentru orice t ﬁxat (arbitrar) §i pentru orice € astfel incét
Q(€ \ @09) Z wa \ 3(6) are loc inegalitatea:

10gP<IE | 9) — 10g 13(56 | 9w) Z 62(9 \ W) — 62(9“) | W) (2)

***************Ending Page***************

***************Beginning Page***************
***************page number:20**************
.. 20.
ObSQPVﬂ§11
1. Semniﬁcagia imediata a relalgiei (2):
Orice imbunatalgire a valorii funcigiei auxiliare Q(6 l 9W) conduce la o
imbunataigire cel pugin la fel de mare a valorii funcgiei obiectiv, 6(9).
2. Daca in inegalitatea (2) se inlocuiegte <9 cu 8W1) I argmaXQQw l 9(0), va
rezulta
(t-l-l) (t)

logP(:1: | Q )2 logP(a: l 9 ).10g P(x/ 6)
in ﬁnal, vom avea 10g P(x/ 6<t+1))_
H66») g 60905)) g Z(<9(t+1)) g . E

. log P(x/6(t))-------------
Slrul acesta (monoton) este f 5
marginit superior de 0 (vezi Q(6(t+1) |9(t))
deﬁnigia lui E), deci converge la Q(9“)|9“))-~~~ }
o anumita valoare W. In anumite Q (6'6 (0)?
cazuri / conditii, aceasta valoare f
este un maxim (in general, local) 5 E
al funcgiei de log-verosimilitate. 6”) 6””) 9

***************Ending Page***************


***************Beginning Page***************
***************page number:21**************
21.
Observaﬁi (cont.)
3. Conform aceleia§i inegalitéti (2), la pasul M de la iteragiat a algoritmului
EM, este suﬁcient ca in 10c $5 se ia 805+” I argmaX6Q(<9 | 605)), sé se aleagé
905+” astfel incét Q(€(t+1) \ g(t)) > Q(6’(t) | (905)). Aceasta constituie versiunea
“generalizatd” a algoritmului EM.

***************Ending Page***************

***************Beginning Page***************
***************page number:22**************
22.
Demonstratja rela§iei (2)

P(x,z | 9) I P(z \ 56,9) -P(x | 9) I>10gP(:U | (9) IlogP(:E,z \ 6) —10gP(z \ wﬁ) I>

21w \ 93,620») -10gP(x \ a) I

;,_/

1

21w \ 11,80”) -10gP(£U,Z | e) - 2sz \ 513,90”) -10gP(Z | 56,9) I

10g P(x | a) I Q<e | W) _ Z P(Z \ :10, aw) - 10gP(Z | w, a)
Ultimul termen din egalitatea aceasta reprezintéi 0 cross-entropie, pe care 0 vom nota
cu CH(9 | €(t)). A§adar,

10g 13(93 | a) z Q(6 | W) + owe | aw)
Aceastéi egalitate este valabiléi pentru toate valorile posibile ale parametrului 6. in
particular pentru 9 I e“), vom avea:
10gP(a: | W) I Qw“) | W) + 0mg“) \ W)

***************Ending Page***************


***************Beginning Page***************
***************page number:23**************
23.
Demonstragia relagiei (2), cont.
Scézénd membru cu membru ultimele doué egalitéﬁ, obginem:
10g 13(33 | a) _ 10g P(:1: y W) z Q(6 y W) _ 43(6)“) \ W) + 011(6) \ W) _ 011w“) \ W)
Conform inegalitégii lui Gibbs, avem CH(6 | W) 3 011m“) \ aw), deci in ﬁnal rezultéi:
10gP<w I 6) —10gP<w \ W) 2 62(9 | W) — Qw“) \ W)

***************Ending Page***************

***************Beginning Page***************
***************page number:24**************
24.
10g P(x/6)
Gt+](9 ) q
I I H[P(Z/X;9(t+1))]
64w)- mmw”)

i Qf(e|0f”)
i i § H[P(Z/X; 6”’)1
6'”) 6min) émz) 6

***************Ending Page***************


***************Beginning Page***************
***************page number:25**************
25.
A mixture of Bernoulli distributions and

a binomial distribution:

NIL-Estimating the parameter using 4 methods:

1. the analythical method, 2. the gradient ascent method,
3. Newton’s method, 4. the EM algorithm

Liviu Ciortuz, starting from:

CMU, 2014 fall, W. Cohen, Z. Bar-Joseph, HWl, pr. 2.b

***************Ending Page***************

***************Beginning Page***************
***************page number:26**************
26.

Presupunem 05 avem douii monede: una este perfectéi, avélnd deci probabili-
tatea de apariigie a fegei cu stema p1 I 1/2, iar cealalté monedéi este mésluité
/ imperfecté, avénd probabilitatea de apari§ie a stemei p2 : 1/3.
Facem 100 de aruncéiri dupéi cum urmeazéi. De .

v . v Z~Bern0ulll
ﬁecare data alegem una dmtre cele doua monede.
Cu 0 probabilitate necunoscutii 7T, alegem mon- War
eda perfecté, iar cu probabilitatea 1 — 7T alegem
moneda misluité. Consideréim c5 am 0b§inut de 1 _ 0 _
40 de ori stema din totalul celor 100 de aruncéiri. X~Bem0ulgllp p X~Bem0ulh 0
a. Calculagi in manieré directii / analiticéi W112
estimarea de verosimilitate maximéi (MLE) a
parametrului 7T. H/l T/O
b. in locul metodei analitice (de la punctul a), pentru estimarea in sensul
verosimilitfigii maxime (MLE) a parametrului 7r se poate folosi medoda gra-
dientului sau metoda lui Newton. Deduceigi regulile de actualizare pentru
parametrul 7T in cazul medodei gradientului §i respectiv in cazul metodei lui
Newton.

***************Ending Page***************


***************Beginning Page***************
***************page number:27**************
27.

c. Pe léngé cele trei metode de mai sus, pentru estimarea in sensul
verosimilitégii maxime (MLE) a parametrului 7T se poate folosi §i algoritmul
EM.

Elaboraigi varianta / ,,instan1;a“ algoritmului EM pentru problema de fatéi, sta-
bilind mai intéi cine sunt variabilele observabile §i respectiv variabilele neob-
servabile. Scrieigi expresia funcigiei care trebuie optimizaté, iar apoi deducegi
formulele de actualizare pentru cei doi pa§i (E §i M) din corpul iterativ a1
algoritmului.

d. Implementagi algoritmul EM pe care l-agi obiginut la punctul c. Comparagi
numéirul de iteralgii, precum §i timpul necesar pentru a se ajunge la
convergentéi pentru cei trei algoritmi: algoritmul EM, metoda lui Newton §i
metoda gradientului ascendent. Vegi folosi in toate cele trei cazuri aceea§i val-
oare ini§ialii 7T(0) I 0.1, precum §i aceea§i condiQie de oprire, |7T(t+1) —7T(t)\ < 10_4.

***************Ending Page***************

***************Beginning Page***************
***************page number:28**************
28.
Solugie
a. Fie X 0 variabilé aleatoare avénd distributia probabilisté descrisé de mix-
tura de distribu§ii Bernoulli din enunfg. Vom desemna cu Z : 1 (respectiv
Z I 0) moneda perfectéi (respectiv, cea imperfectéi), vom nota cu H fata
stemfi (engl., head) §i apoi vom considera urmﬁtoarea probabilitate:
q “2' P(X I H) F'QT' P(X I H,Z I 1) + P(X I H, Z I 0)
: P(X:H\Z:1)-P(Z:1)+P(X:H\Z:O)-P(Z:O)
1 1 1 7r
I _ . _ . 1 _ I _ _
2 7T + 3 < 7T) 3 + 6’
ceea ce ° l'céi 1 2 7T
1m 1 — : — — —.
P q 3 6
Dacéi X’ este 0 variabilé aleatoare B§rn0ulli echivalenté cu mixtura daté in
enunig, putem scrie X ’ ~ Bernoulli (q). In sférgit, intrucét nu ni s-a precizat 0r-
dinea in care au fost 0b§inute cele 100 de rezultate / ,,0bserva§ii“ (de tip stemé
sau ban), vom lucra cu 0 [a treia] variabilé aleatoare, X ” ~ binomial(r;n,q),
unde r : 4O §i n I 100. Agadar, functia de verosimilitate a datelor este:
1 7r 40 2 7T 60
L :040 401_ 60:040(_ _) _(___)_
<71) 100q ( (I) 100 3 + 6 3 6

***************Ending Page***************


***************Beginning Page***************
***************page number:29**************
29.
Putem scrie acum funcigia de log-verosimilitate a datelor: fin?
m) I 1n<L<7T>> I 1n 0100 + 401m (_ + _> + 60 1n (_ - _).
3 6 3 6 '°
Derivata intéi §i derivata a doua pentru functjia de log-vetigosirgilitefi'fe 511016 resOfJectiir
urmétoarele expresii:
l'( > 40 1 60 1 40 60 40 — 100w
7T I —-———-—:———:—
%+% 6 %—% 6 2+7T 4-7T (2+?)(4-7r)
40 60
l” I ————<O,V G0,1,
(7T) (2+?)2 (4_7T)2 7T [ ]
ceea ce implicé faptul c5 functgia Z (ca §i L) are un singur punct de maxim, iar acesta
4O
este 0b§inut egalémd prima derivaté cu 0: £’(7T) : O (i) 7T : TOO : 0.4 € [0,1]. A§adar,
7TMLE I 0.4.

***************Ending Page***************

***************Beginning Page***************
***************page number:30**************
30.
b. Pentru metoda gradientului ascendent, regula de ,,actualizare“ este
urmétoarea:
+ g“ )a. + 40—1007r
7r I 7T 7T I 7T —,
1s+1 t 77 t t 77(2+1r)(4—1r)
unde 17 este rata de invavta're.
Pentru metoda lui Newton, regula de ,,actualizare“ este urmﬁtoarea:
WM)
7r I 7r — —
t+1 t WWW)
€’(7Tt) g 26(2 — 57f) (2 —|— 7T)2(4 — 7r)2 _ _ (2 — 5w)(2 —|— 7r)(4 — 7r)
WM) _ (2 + 7T)(4 — 7r) 26pm — m2 + 3(2 + 702] _ 5W2 — 47v + 44 '
A§adar,
WHAT” 57rt2-4m+44 '

***************Ending Page***************


***************Beginning Page***************
***************page number:31**************
c. Asociind ﬁecérei ,,0bserva1;ii“ din cele 100 despre care este vorba in enuni; 0 variabilé 31-
aleatoare Xi ~ Bernoullﬂq) §i noténd X : (X1,...,X100), functia de log-verosimilitate a
datelor ,,0bservabile“ va ﬁ scriséi astfel:
m) :1nP(X|7T) 2111 (cfgomxi I H)40 P(Xi I n60) I 1n(Ci180q40 (1 _ (1)60).
W v
q —q
Dacé notéim cu 21 numéirul (neobservabil) de aparitii ale stemei pentru moneda 1 (din
totalul celor n5 I 40 de aruncéiri) §i cu 20 numiirul (neobservabil) de aparigii ale banului
pentru moneda 1 (din totalul celor nB I 6O de aruncéri), log-verosimilitatea datelor
,,c0mplete“ va putea ﬁ scrisé astfelza
d ' d 100
ewmpw If‘1nP<X,Z|7T> “"I' Zln (Pm-m, 7r) - Pal-m) <3)
1:1
I 51 1n(7rp1) —|— (ng—21)ln((1—7r)p2) + 201n(7r(1—p1))+ (nB—§O)1n((1—7T)(1—p2))
I 51ml7T + 111191) + ("s — 51)(1n(1 _ 7T) +1n192)
+20(1n7r +1n(1 —p1))+(nB — 20)(1n(1 — 7T) +1n(1 —p2)).
Observatie: in relagia (3) am considerat variabilele aleatoare (neobservabile) Z1 luénd valoarea 1
dacé ,,0bserva‘gia“ X1- : 90¢ a fost realizaté folosind moneda 1, §i respectiv valoarea 0 dacé s-a folosit
moneda 2.
a Putern considera n5 §i nB ca ﬁind datele ,,0bservabile“.

***************Ending Page***************

***************Beginning Page***************
***************page number:32**************
32.
Pasul E
Acum vom putea calcula funcgia ,,auxiliar5“ Q(7T\7r(t)), folosind proprietatea
de liniaritate a mediilor:
de . ~ ~
WW) If Ewwmpm I Emmm +1I1P1)+(ns — Emunu — 1r) +11%)
+E[50](1H7T +1I1(1 —P1))+(nB — E[50])(111(1 — 7T)+11'1(1 — 292))
I c +(E[21] + E[20]) 1117'!‘ —|— (n3 —|— n3 —E[21]— E[20])1n(1 — 7r). (4)
const. 100
Mediile E[51] §i E[ZO] se calculeazé Qinénd cont cii 21 ~ Binomial(40, q?) §i
50 ~ Binomial(60, (1613))’ unde
(t) nit. P(Z- _ 1|X' _ 1 7T(t)) F.B.,£.P.T. 7T(t) p1
Q1 _ Z — Z _ 7 — 7T(t)P1 + (1 — 7T(t))192
(t) 1 _
(t) nit, . _ . _ (t) F.B.,£.P.T. 7T < p1)
_ PZZ_1XZ_O, _ —,
q‘) ( ' 7T > WW1 —p1> + <1 — w<t>><1 —p2>
ceea ce — dat ﬁind c5 E[bz'n0mz'al ("1"; n,p)] I np — implicii
Evil] I 40g?) §i 1%] I ﬁoqé”.

***************Ending Page***************


***************Beginning Page***************
***************page number:33**************
33.
Pasul M
871' 7T 1 — 7T
8Q ~ ~ ~
87W I 0 <I> (1 —ﬁ’?(E[21] + E[Zo]) I ﬁns + RB —W)
E ~ E ~
i 7T I [21] + [20]. (5)
Tbs + RB
Se poate constata u§0r c5 derivata a doua a funcgiei Q(7r]7r(t)) in raport cu 7T este negativii
pe tot domeniul ei de deﬁni§ie, ceea ce implicéi faptul c5 solutia primei derivate (care a
fost calculatéi mai sus) este punct de maxim pentru Q(7r|7r(t)).
Observaji semniﬁcaigia rezultatului (5): EMS] —|— E [n5] reprezintéi céte aruncéiri au fost
fiicute (in medie) cu moneda 1 (la iteratgia t), deci este ,,natural“ ca 7T s5 deviné (pentru
itera§ia t-l- 1) raportul dintre EMS] + E[nB] §i numéirul total de arunciiri, n5 —|— nB.
Concluzionémd, regula de actualizare pentru Pasul M a1 algoritmului EM pentru re-
zolvarea problemei de estimare a parametrului 7T a1 distribuli'iei probabiliste descrise in
enungul problemei este urmﬁtoarea:
t t t 1:
7T(t+1) I 40615) —|— GOqé) I 2q§ ) + 3(16 )-
100 5

***************Ending Page***************

***************Beginning Page***************
***************page number:34**************
34.
Pseudo-codul algoritmului EM
pentru rezolvarea problemei de tip MLE din enunt;
Initializare:
atribuie o valoare arbitraré’ HO) Tn intervalul (0,1) pentru parametrul 1r;
Corpul iterativ:
pentru t : O, . . . ,T — 1 (cu T fixat Tn avans)
(sau: péné’ cénd hr“) — 7r<t+1)| < 6, cu a fixat Tn avans) executé’
Pasul E:
q<t> I 7T“) P1 .
1 7T<t>P1+(1—7T(t))P2’
q<t> I w.
0 7T<t><1 —p1>+ <1 — WW1 -p2>'
Pasul M:
(t) (t)
7T(t+1) I 2q1 + 3% .
5 I
Returneazé’ 7T<t+1);

***************Ending Page***************


***************Beginning Page***************
***************page number:35**************
35.
7T<P>I7T<10> H50) (178)
m

| | | |

: : : : 1n P(XI7T)
| | | |
—101 I I I I
| | | |
| | | |
| | | |
| | | |
: : : :
Q( W9)» I g g
I I '

(177)
7T 7T
_102 | I I (49> Q< I )
I I I I QWT )

| | | |
| | | |
| | | |
| | | |
| | | |
| | | |
| | | |
| | | |

0.00 0.25 0.50 0.75 1.00

***************Ending Page***************

***************Beginning Page***************
***************page number:36**************
36.
Gradient ascent method (07 I 0.001, 77 I 0.01, 77 : 0.1)
i250 i250 i250
4.75 4.75 -2.75
-3.00 -3.00 -s.oo
4.2.5 45.25 -3.25
45.50 45.50 -s.5o
-3.75 -3.75 45.75
-4.00 -4.00 -4.00
-4.25 -4.25 -4.25
1450 4.50 1450
0.0 0.2 0.1 0.6 0.8 1.0 0.0 0.2 0.1 0.6 0.8 1.0 0.0 0.2 0.1 0.6 0.8 1.0
Newton’s method, and the EM algorithm
Numarul de iteratii necesare pen-
tru a se ajunge la convergenta, cand
_2_50 —2.50 6 I 10_4:
1275 *2-75 49 — metoda gradientului (daca 1; I
-3.00 -3.00 O . 01) 9
. r 3 — metoda lui Newton,
i520 EM’ 178 — algoritmul EM.
-3.50 4,50
.1 M. Timpul necesar pt. executarea aces-
id” *3” tor iteratii:
i400 *4'00 0.00054 sec. — metoda gradientului,
142;, *4-25 0.00041 sec. — metoda lui Newton,
1450 1450 0.02597 sec. — algoritmul EM.
0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0

***************Ending Page***************


***************Beginning Page***************
***************page number:37**************
37.
The EM algorithm for solving
a Bernoulli mixture model
CMU, 2008 fall, Eric Xing, HW4, pr. 1.4-7

***************Ending Page***************

***************Beginning Page***************
***************page number:38**************
38.

Suppose I have two unfair coins. The ﬁrst lands on heads
with probability p, and the second lands on heads with prob- Z~Bern0ulli
ablllty q. W31
Imagine n tosses, where for each toss I choose to use the ﬁrst 1 0
coin with probability 7T and choose to use the second with X~Bern0ulli1 X~Bern0ulli0
probability 1 — 7r. The outcome of each toss 2' is x,- E {0,1}. 1-p

I7 _q
Suppose I tell you the outcomes of the n tosses, a: ng'
{x1,$2,...,a;n}, but I don’t tell you which coins I used on 1 0
which toss.
Given only the outcomes, as, your job is to compute estimates for 6 which is the set of
all parameters, (9 I {p, q,7r} using the EM algorithm.
To compute these estimates, we will create a latent variable Z, where z,- G {0, 1} indicates
the coin used for the nth toss. For example 22 I 1 indicates the ﬁrst coin was used on
the second toss.
We deﬁne the “incomplete” data log-likelihood as 1n P(:1;\6) and the “complete” data
log-likelihood as lnP(a:, zld).

***************Ending Page***************


***************Beginning Page***************
***************page number:39**************
39.
a. Show that E[zZ-|xZ-,€] I P(zZ-:1|xZ-,9).
b. Use Bayes rule to compute P(zz- : llatl-ﬁw), where 96) denotes the pa-
rameters at iteration t.
c. Write down the complete log-likelihood, 1n P(.ZE, 2'16).
d. E-Step: Show that the expected log-likelihood of the complete data
Qw | W) "g EP<Z|$,@<t>>[1nP<w, Z | 9)] is given by
Q(€ l 905)) I ZElZ'L l 5133,96“ - (lnvr —|— x1- lnp —|— (1 — x1)ln(1—p))—|—

1:1

—|— (1 — E[zZ | 5137;,6’(t)]) ' (ln(1— 7T) —|— 51:7; lnq + (1 — 51:2)ln(1— q))
e. M-Step: Describe the process you would use to obtain the update
equations for pa“), q<t+1> si Ht“).

***************Ending Page***************

***************Beginning Page***************
***************page number:40**************
40.
Solution
a.
ﬁzz-me] I Z Z¢P(ZZ-|33i,§):0'P(ZZ-:0|jS,§)+l-P(ZZ-:1‘wi,@)
z€{0,1}
b.
P” ‘ (1 — p)1_“”'1T + q” ' (1 — (1)1-9” ‘ (1 — 7T)

***************Ending Page***************


***************Beginning Page***************
***************page number:41**************
41.
C.
Note (in ROmHniﬂn): Din punct de vedere metodologic, pentru a calcula P(a:,z\9)
ne putem inspira de la punctul precedent: observém 05 la numitorul frac§iei care ne
dii valoarea lui P(z,'|xZ-, 6) avem P(a:Z-, 21 I 1W) §i P(a:Z-, zi I 0W). Pornind de la aceste douii
expresii, ne vom propune s5 1e expriméim in mod unitar, adicii sub forma unei singure
expresii, folosind artiﬁcial emponenjz'e'rz'z' (engl., the exponentiation trick).
lnP(x, Z | e) mép' ban P(:1:7;, ZZ- \ 9):1I1HP($¢ \ Z a) - Pel- y e)
2'21 2'21
TL
. _ . Z- . _ . 1— i
z mH (1W1 —p)1 $1702 ((1%(1 — (1)1 $41 — 70) z
':1
n2
I Z 1n ((pw — ml-QCW <qu — q>1w<1 — MM)
izl
TL
I Z [21111 (19%(1 — p)1—mivr)+(1 — 21) 1n (qxiﬂ — (1)1-061-(1 — 7T))]
"L'Il

***************Ending Page***************

***************Beginning Page***************
***************page number:42**************
42.
d.
Qw | W) "2' EP<Z|$,@@>>[1HP($,Z \ W
Z EP<wﬁ<t>>i§ [ZZ- 1n (19%‘(1 — p)1—”%w) +
Z (1 _ Z1) 1n (q$i(1 — q)1_m"(1 — WM]
I Z [EM | 33-, W] -1n(pxi(1 — pf-miw) +
+ (1_ Em | whmwp - (1nqwi<1— q>1—$i<1— 70)]
I Zn: [Em | x W] - (1m + $1- lnp + (1 _ 5131-) ln(1 — p)) +
Z21 + (1_ Epi | :1: M) - (mu _ 7T) + x7; 111g + (1 — 1») 1n(1 — (0)]

***************Ending Page***************


***************Beginning Page***************
***************page number:43**************
43.
e.
(t) ﬁgs. E1? | x‘ (905)] (1:1 (p(t))w1 . (1 —p(t))1—wi WM)
2> 62(91 €(t)) 2 Z Lug-t) (11171 + $1- lnp —|— (1 — xi) 111(1 —P)) +
121
+ (1 - 15”) - <1n<1— 71> + 1mg + <1 - 11> 1n<1 — (1)]
@Q(9 | 8(1)) n 11> (w 1— w) 1 n <1 1 ” <1
—:0<:> m- ——— :0<:>— #111:— xii-P11-
8p Z p 1—p p; H; < >
<2 (1—p) 2111611 I p2u§t)(1—wi) <2 Z #911: p (Z u§t)(1—wi) + Z @011)
121 121 121 121 1'21
‘i’ Z MPQE I PE My) 2 PM) I —n1 <1) Q [0,11
1:1 1:1 21:1 #1;

***************Ending Page***************

***************Beginning Page***************
***************page number:44**************
44.
(9 € <9“) n x1- 1—:UZ- TL 1— it) z
Q(8| ):0@Z(1_”§t)) (__ 1 >:0:>q<t+1):22—n1(—m(t))x€ [071]
q 1;:1 q — q 21:1(1 — #1‘ )
(962W l 9w) n Mt) 1 — Mt) 1 n (t) 1 n (t)
—:0<:> #——Z :0<:>— .:— 1_.
(97f 22; 7T 1—7T ngz 1—7T;( 'LLZ)
t t
1:1 izl izl izl izl
n (t) _ n n (t) _ (15+1) _ 1 n (t)
<:> . _ 1 <:> . _ :> — — - € 0,1
g 1% 7r g g ,uz mt 7T n g M i i
ote. It can be eas1ly shown that the second dem'vatz'ves (3—]92’ @—q2 and w) are all
negative on the respective domains of deﬁnition. Therefore, the above solutions (p(t+1),
q<t+1> and 7T<t+1)) maximize the Q functional.

***************Ending Page***************


***************Beginning Page***************
***************page number:45**************
45.
The EM algorithm for mixtures of Bernoulli distributions: pseudo-code
Initializare:
atribuie valori arbitrare (7T(O),p(0),q(0) Tn intervalul (O, 1))
pentru parametrii 7T, p 5i respectiv q;
Corpul iterativ:
pentru t : 0, . . . ,T — 1 (cu T fixat Tn avans)
(sau: péné' cénd log-verosimilitatea datelor observabile nu mai cre$te semnificativ),
(sau: péné' cénd Mr“) — 7r<t+n| < 6, Ipw —p(t+1)] < a, ‘(103) — q(t+1)| < 6,
cu 6 ﬁxat Tn avans)
executé’
Pasul E: pentru i : 1, . . . ,n, calculeazé'
(t) _ (206))”‘(1—P(t))1—mi'7T(t) .
#1‘ — (p(t))mi-(1—p(t))1_$i~7T(t)-|-(q(t))$i-(1—q(t))1_$i-(1—7T(t))'
Pasul M:
p(t+1) _ 21:1 M631‘ q(t+1) _ 2i=1<1_#¢())93i 7T(H1) _ l 2n H05).
— t 1 — t 1 — ‘:1 i 1
221:1 #1 2?:1(1_M ) n Z
Returneazéi 7T<t+1),p(t+l), (ff/+1);

***************Ending Page***************

***************Beginning Page***************
***************page number:46**************
46.
L. Ciortuz, S. Ciobanu:
Exemplifying a simpler version of the EM / BMM algorithm
starting from the dataset used at
CMU, 2005 fall, T. Mitchell, A. Moore, midterm, pr. 1.3
A. supervised B. unsupervised
-|-— -|-— Z~Bem0ulli
-|-— -|-— W"
1 1 1 (Head) 1 ‘.7 1 (Head) 1 0
2 0 0 (Tail) 2 ? 0 (Tail) X~Bernoulli1 X~Bernoulli0
3 0 0 (Tail) :> 3 ? 0 (Tail) 6 1-6 29 146
4 O O (Tail) 4 ‘.7 O (Tail)
5 0 1 (Head) 5 '? 1 (Head) 1 0
(X|Z I 1) ~ Bernoullﬂd) Z ~ Bernoullﬂﬂ), with 1T € (0, 1),
(XIZ : 0) N BGTHOUZH (2(9), X ~ wBeTnoullz' (6) +(1 — 7r)BeTn0ull2' (29),
with Q € (0, 1/2). and 0 6(0, 1/2).
Note: In the neXt ﬁve slides we will assume that 7T is ﬁxed.

***************Ending Page***************


***************Beginning Page***************
***************page number:47**************
47.
E step:
F- liayes 1T (@(t))‘“(1 — 9“))1_”” w (t)
(comm) “2' 1nP(X, Zl9)
I 21 111w) + (1 _ Z1)1n(26(1 _ m) + Z21n((1 _ an) + (1 _ 22) 111((1 _ 29)(1 — m) +
Z3 111((1 — QM) —|— (1 — Z3) 111((1 — 26)(1 — 71)) +
Z4 ln((1 _ em) + (1 _ Z4) 111((1 _ 2e)(1 — 71))+ Z5 1n(611) + (1 — Z5) 1n(2e(1 - 71))
WW) "2' Ewcomplwn
I E[Zl] 111w) + (1 _ E[Z1]) 1n(2@(1 _ 7Q) + 15122] 111((1 _ en) + (1 _ E[Z2]) 111((1 - 2e)(1 - m) +
E[Z3]11’l((1 - en) + (1 - E[Zg]) 1n((1 - 2@)(1 _ 71))+
E[Z4] ln((1 _ em) + (1 _ E[Z4])1n((1 _ 29)(1 - m) + E[Z5]1n((97r) + (1 - E[Z5]) 1n(2e(1 - m)
7‘ Cgmt'const. + 15121] 1m + (1 _ E[Zl]) 1116 + 15122] 111(1 _ e) + (1 _ E[ZQ]) 111(1 _ 2e) +
E[Zg] 1n(1 _ a) + (1 _ E[Zg])111(1 — 26) + E[Z4]1n(1 _ e) + (1 _ E[Z4]) 111(1 _ 2e) +
z 007151. + 21119 + (15(22] + 15(23] + E[Z4]) 1n(1 - a) + (3 - (E[ZQ] + E[Z3] + E[Z4])) 111(1 _ 2e)

***************Ending Page***************

***************Beginning Page***************
***************page number:48**************
M step: 48-
96+” déf' argmaXQ(6\6(t))
ee(0,1/2)
6 2 ElZg] —|— E[Z3] —|— E[Z4] 2[3 — (E[Z2] —|— E[Z3] —|— E[Z4])]
aeQ< I > e 1 _ 6 + 1 _ 2e
<:> 2(1 — 6)(1 — 26) : (E[Zg] + E[Z3] + E[Z4])9(1 — 2Q) + 2(3 — (E[Z2] + E[Z3] + E[Z4]))6(1 — 6)
e 2(1 — 6><1 — 28> I (165% HS) + mm — 26> + 2(3 — (it?) + Hg) + HSP>>6<1 — 6)

ea62+b9+c:0 with a: 10, b: —12+/1§t>+u§t>+#§f), 0:2e1R (7)

Note that 20 20
/—’_ /—/_

6_2Q((9|Q(t)) I _Z _ Hg) + My) + Hit) _ 4(3 — (Hg) + Hg) + My)» < 0

@192 62 (1 — 6)2 (1 — 2(9)2 7
so Q(9|9(t)) is a strictly concave function, so it has a unique maximum on (O, 1/2).
,ugt) € [0,1] due to the relationship (6), therefore A I b2 — 4ac I b2 — 8O Z 1 > 0, which
implies that the solutions to the above 2nd degree equation (denoted 61 and respectively
<92) are real nombers. It can be shown (by using high school mathematics) that 91 > O,

—b — \/ b2 — 4
62 > 0, and moreover 61 < 1/2, and 92 > 1/2. Therefore, the solution 2—ac is
a

the one corresponding to the maximum value of Q(9\€(t)) in the (0,1/2) interval.

***************Ending Page***************


***************Beginning Page***************
***************page number:49**************
49.
So, the updating rule for the M-step is
9(t+1) I _b _ V b2 _ 4ac' (8)
2a
Now, to summarize, the updating rules for this version of the EM
algorithm are the relationships (6) and (8).

***************Ending Page***************

***************Beginning Page***************
***************page number:50**************
50.
Pseudo-codul algoritmului EM
pentru rezolvarea acestei mixturi de distribu§ii Bernoulli
Initializare:
atribuie o valoare arbitraré’ 6(0) Tn intervalul (0,1/2) pentru parametrul 6;
Corpul iterativ:
pentru t : 0,... ,T — 1 (cu T fixat Tn avans)
(sau: pénéi cénd ‘9W — 6(t+1)\ < a, cu a fixat Tn avans) executé'
Pasul E:
MU) ﬁg‘ 7T (6(t))$i(1 _ 6(t))1—$i .
2 7T(9(t))aci(1 _ 6(t))1—:13¢ _|_ (1 _ 7T)(2(9(t))$i(1 _ 2Q(t))1—ww
Pasul |\/|:
‘/ 2
g(t+1) I —b— b —4ac' cu
2a
a : 10, b : —12+,ug) +pgt) +Iugf) 5i c : 2;
Returneazé’ 605+”;

***************Ending Page***************


***************Beginning Page***************
***************page number:51**************
51.
Execution of two iterations of the EM / BMM algorithm,
when 7r = 0.5 (ﬁxed)
[plots made by Sebastian Ciobanu]
<|r |n(p(X|6)) i i E <|r n(/ : E \ E
CC" i i Q<9|6(0)) a‘) Q(6|9(O))+ln2*H(Z|X,elm)
'T 'T EQ(e|Ee(‘)) + |n2*H(Z:|X, e 1)
I 0.0 0.1 0.2 0.3 0.4 0.5 I 0.0 0.1 0.2 0.3 0.4 0.5
0 0

***************Ending Page***************

***************Beginning Page***************
***************page number:52**************
52.
———1
ui——
———l
———l
———l
———l
———l
“|——
———l
“|——
“|——
———l
0510) I 0.3333333, 090) I 0.6111111, 0:90) I 0.6111111, 05,10) I 0.6111111, MSG) I 0.3333333

***************Ending Page***************


***************Beginning Page***************
***************page number:53**************
When 7T is free: 53-
E step:
E[Zi|33i,@(t),7T(t)] : P(ZZ : 1‘£U¢,9(t),7f(t))
F. BIayes 1r“) (9(t))mi(1 — 6(t))1—mi nét. (t)
We) (96))081- (1 _ 9<t>)1—m1- + (1 _ 7T(t>)(29(t))w¢(1 _ 29<t>)1—w¢ m
Q(8,7T|6(t),71'(t)) ﬁg’ EMCOTTWKQ? TO]
: E[Zl] ln(97r) + (1 — E[Z1])1n(29(1 — 7r)) -|- E[Z2] ln((1 — 0)7r) -|- (1 — E[Z2])1n((1 — 26)(1 — 7T)) +
E[Zg] ln((1 — 6)1r) + (1 — E[Z3])1n((1 — 26)(1 — 7r)) +
E[Z4] ln((1 — 6)1r) + (1 — E[Z4])1n((1 — 26)(1 — 7r)) + E[Z5] 1n(67r) + (1 — E[Z5]) 1n(26(1 — 7T))
M step: 9<t+1> same as before, but using the ,ugt) from this E step.
7r<t+1> dg' argmanng) Q(6,7r|(9(t),7r(t))
%Q(@m!9(t)m<t)):0 e
8
(5_(E[Zl] + E[ZQ] + E[Z3] + E[Z4] + E[Z5])) 1H(1—7T)] z 0 e
E[Z1] + E[Z2] + E[Zg] + E[Z4] + E[Z5] _ 5—(E[Z1]+ E[Zg] + E[Z3] + E[Z4] + E[Z5]) <z>
1 7T _ 1—7T
7T I 5(E1Z1] + E1Z21+ E1Z31+ E1Z41+ E1Z51)
Therefore 7T<t+l> I éwgt) —|— ,ug’) —|— ,ug’) + Hit) + u?) € [0, 1]. Note: Q(6,7T|9(t),71‘(t)) is concave W.r.t. 7T.

***************Ending Page***************

***************Beginning Page***************
***************page number:54**************
54.
Pseudo-codul acestei noi variante a algoritmului EM
pentru rezolvarea mixturii de distribugii Bernoulli
Initializare:
atribuie o valoare arbitraré’ 9(0) Tn intervalul (O, 1/2) pentru parametrul 6 5i
o valoare arbitraré’ 7T(0) Tn intervalul (0,1) pentru parametrul 7r;
Corpul iterativ:
pentru t : O, . . . ,T — 1 (cu T fixat Tn avans)
(sau: péné cénd ‘96) — 9(t+1)\ < a, cu a fixat Tn avans) executé'
Pasul E:
(t) "gt- 7T(t) (900)061-(1 _ 9(t))1—wi .
Pasul |\/|:
‘/ 2
@(Hl) I —b— b —4ac' cu
2a
a I 10, b I —12+u§t)+u§t)+u§f) 5i c z 2;
1 t t t t t
WW1) I 5M) +u§> w? H61) +u§))€[071];
Returneazé’ 603+” 5i Ht“);

***************Ending Page***************


***************Beginning Page***************
***************page number:55**************
55.
Execution 0f the EM / BMM algorithm, when 7r is also free
[plots made by Sebastian Ciobanu]
Z
O
0 2 4 6 8 1O 12 14 16 18 20 0.0 0.2 0.4 0.6 0.8 1.0
Number of iterations n

***************Ending Page***************

***************Beginning Page***************
***************page number:56**************
5 6.
———-———--|
—i————————
—|————————
—|————————
—|————————
—|————————
—|————————
—|————————

***************Ending Page***************


***************Beginning Page***************
***************page number:57**************
57.
Revisiting the case when 7T is ﬁxed
Datoritéi proprietéigii de liniaritate a mediei, urmeazﬁ 05 media sumei unor variabile
aleatoare este surna mediilor lor. Folosind aceastéi proprietate simpléi vorn aréita
acurn c5 putern s5 reformulérn algoritrnul nostru EM pentru estimarea parametrilor
unei mixturi de distribuigii Bernoulli sub 0 alté formﬁ, foarte convenabiléi.
La rezolvarea datii anterior pentru pasul E (cénd probabilitatea de selectgie, 7T, era
consideratii ﬁxatii), am 0b§inut
(t) _ . _ . (t) F_ @1165 7r(i9(t))$i(1 _ 9(t))1_:c¢
m —P(Z@—1\w@,@ ) — —. . . -
7T (9<t>)w1(1 _ mop-$1 + (1 _ 7T)(29<t>)w1(1 _ 29(1r>)1—w1~
Putem scrie
pentru cazul 00¢ : 1 (adicéi, pentru 51:2- E steméi)
(t)
(any ._ ._ (t) _ 7T9
ql — P(ZZ — Hm — 1,6 )_ 7T6(t) + (1 — 7T) 26W’ (9)
pentru cazul 001- : 0 (adicéi, pentru xi E ban)
(t) “it P(z- — 1|x-— 0 605)) — —7T(1 — 6(0) (10)
‘10 — F 1- ’ _ m1_e<t>)+(1_w)(1_ze<t>)'

***************Ending Page***************

***************Beginning Page***************
***************page number:58**************
58.
Fie zl numérul (neobservabil) de aparigii ale feigei stemd pentru moneda 1, din
totalul de n5 n25. 2 apariigii ale stemei in datele noastre.
Similar, ﬁe 2:0 numéirul (neobservabil) de aparitjii ale fetei ban pentru moneda
1, din totalul de n5 ngt' 3 aparitii ale banului in datele noastre.
Functia de verosimilitate corespunzéitoare a datelor [din tabel] este
L(9) : 6Z1(1 — (9Y0 - (28)”S_Z1(1 — 26)”B_ZO,
iar functjia de log-verosirnilitate este
KW) I z11n6 + z01n(1 — t9) + (n5 — z1)1n(2€) + (n5 — z0)1n(1 — 29),
ceea ce conduce imediat la noua expresie a funcgiei auxiliare:
Q<6|6(t))dg'E[@(9)]
lin'zmed' E[Z1]1n@ + E[z0] 1n(1 _ e) + (n5 _ E[Z1])1n(2e) + (n3 _ E[ZO])1I1(1 _ 2e).

***************Ending Page***************


***************Beginning Page***************
***************page number:59**************
59.
La pasul E, mediile
0 E[z1], adicé numérul a§teptat (engl., expected number) de aparigii ale fegei
stemd pentru moneda 1 din totalul de n5 nét' 2 apariigii ale stemei in datele
noastre, §i
o E[z0], adicéi numiirul a§teptat (engl., expected number) de aparigii ale fe§ei
ban pentru moneda 1 din totalul de nB nit 3 apari§ii ale banului in datele
noastre,
se calculeazé — la iteragia t — folosind ﬁe proprietatea de liniaritate a mediilor
ﬁe formula mediei distributiei binomiale:

Em I n8 - q?) §i Em I n5 - qu (11>
in aceastéi nouéi formulare a algoritmului EM pentru problema noastréi, pasul
E este constituit de formulele (9) §i (10), iar pasul M se elaboreazﬁ dupé cum
urmeazé.

Stim c5
@(tH) I argmax Q(9\6(t)). (12)
06(0, 1/2)

***************Ending Page***************

***************Beginning Page***************
***************page number:60**************
Dacﬁ maximul func§iei Q(6|6(t)) se situeazé in interiorul intervalului (0, 1/2), atunci cu 60.
necesitate vom avea
6
%(E[z1]1n6 + E120] 1n(1 _ e) + (n5 _ E[z1])1n(26) + (11B _ E[ZO])1H(1 _ 2m) I 0
E[z1] E[z0] 2(n5 — E[z1]) 2(nB — E[z0])
<:> — — — — - — I 0
a 1 _ a + 2e 1 _ 2e
<i> 286173) _ "B ' gist). + 2("8 — 718-611”) _ 261B — "B @516) I 0
6 1 — 6 26 1 — 26
(i) ns - q?) _ nB ~qét) + Zns(1 — q?) _ 2nB(1 — (180) Z 0
6 1 — 6 29 1 _ 26
<i> n5(1 _ e)(1 _ 29) _ anffwu _ 29) _ 2nB(1 _ qgﬂwu _ e) I 0
(I) n5 —|— 6(—3n5 —W— ZnB +Zanét)) + 62(2n5 +M+ 277,3 —M) I 0

<:>2(ng+nB)62 — (37151-2713 —an(()t))6—|-ng :0. (13)
Se constatéi u§0r c5 ecuatgia (13) este de fapt aceea§i cu ecuaﬁa (7) pe care am 0b§inut-
0 la pasul M atunci cénd probabilitatea de selec§ie 11 era consideratéi ﬁxatéi. Prin
urmare, solu§ia problemei de optimizare (12) — adicé, regula de actualizare a valorilor
parametrului 6 la pasul M pentru aceastéi nouéi versiune a algoritmului EM — va avea
exact forma (8).
Recapitulénd, regulile de actualizare pentru aceastii versiune a algoritmului EM sunt:
la pasul E relaigia (10), iar la pasul M §i varianta regulii (8) pentru ecua§ia (13).

***************Ending Page***************


***************Beginning Page***************
***************page number:61**************
61.
Pseudo-codul algoritmului EM
pentru rezolvarea acestei mixturi de distribu§ii Bernoulli
Inijcializare:
atribuie o valoare arbitraré’ 9(0) Tn intervalul (0,1/2) pentru parametrul 6;
Corpul iterativ:
pentru t I O, . . . ,T — 1 (cu T fixat Tn avans)
(sau: péné’ cénd ‘6W — GUM), < a, cu a fixat Tn avans) executé
Pasul E:
(t) _ 7T (1 — (905)) _
q‘) _ m1 _ 6W) + (1 - 7T) (1 _ 20w)’
Pasul M:
@(tH) I (—b — vb2 — 4ac)/(2a), cu
a I 2(n5 —|— n3), b I —(3n5 + ZnB — anét)) 5i c I n5;
Returneazé’ 605“);

***************Ending Page***************

***************Beginning Page***************
***************page number:62**************
62.

Observajiz':
1. Din formula (13) se vede faptul cé nu este necesar sé mai calculéim git)
la pasul E. Chiar §i dacé ar ﬁ trebuit $5 calculém git), pasul E tot ar ﬁ fost
mai eﬁcient in noua versiune decét in versiunea ,,clasicéi“ a algoritmului EM
pentru rezolvare de mixturi de distributii Bernoulli, ﬁindcéi acolo calculam
n medii ,ugt). Acest fapt este foarte semniﬁcativ pentru cazuri in care avem
foarte multe instange 1102-!
2. Acest ultim tip de estimare a Z~Bern0ulli
parametrului / parametrilor unei
distributii probabiliste cu ajutorul WW
algoritmului EM este posibil datorité 1 0
faptului cii au 10c relagiile (11). X~Bern0ulli1 X~Bern0ulli 0
Ilustriim aceastii importantéi 9 1-6 26 1-29
,,dependen§5.“ in ﬁgura aléituratii
(pentru a facilita retinerea ei de 1 0
céitre cititor!). V51 reamintim c5 n5
§i nB sunt datele / variabilele ob- -.,-_'.'::_;;;:-..__
servabile, iar 21 §i 20 sunt variabilele ~A‘. . V V0) 1 . .WA (t)

_ Z1~Bm0mlal (nS,q1 ) Z0~Bm0mlal%¢B,q0 )
neobservabﬂe.

***************Ending Page***************


***************Beginning Page***************
***************page number:63**************
63.

Estimating the parameters of a mixture of

vectors of Bernoulli variables, which are independent
and [respectively] identically distributed
A. when all variables are observable: MLE, in the direct manner;
B. when some variables are unobservable: the EM algorithm
Liviu Ciortuz, following
“What is the expectation maximization algorithm?” ,
Chuong B. Do, Seraﬁm Batzoglou,
Nature Biotechnology, vol. 26, no. 8, 2008, pag. 897-899

***************Ending Page***************

***************Beginning Page***************
***************page number:64**************
64.
Fie urmétorul empe'ri'ment probabilist:
Dispunem de doué monede, A §i B.
Efectuém 5 serii de operagiuni de tipul urmétor:
— Alegem in mod aleatoriu una dintre monedele A §i B, (:u probabilitate
egaléi (1/2);
— Aruncélm de 10 ori moneda care tocmai a fost aleasii (Z) §i notéim
rezultatul, sumarizat ca numélr (X) de fege ‘head’ (r0. ‘stemé’) 0b§inute
in urma aruncérii.

***************Ending Page***************


***************Beginning Page***************
***************page number:65**************
65.

A. La acest punct vom considera (:5 s-a obginut urméitorul rezultat pentru
experimentul nostru:

2' Zi Xi

1 B 5H (5T)

2 A 9H (1T)

3 A 8H (2T)

4 B 4H (6T)

5 A 7H (3T)
Semniﬁcaigia variabilelor aleatoare Zi §i X1- pentru 2' I 1, . . . , 5 din tabelul de
mai sus este imediaté.

***************Ending Page***************

***************Beginning Page***************
***************page number:66**************
66.

i. Calculagi 6A §i 63, probabilitiiljle de apariigie a fe§ei ‘head’ / steméi pentru
cele doué monede, folosind definiiz'a clasicd pentr'u, probabilitatea eveni-
mentelo'r aleatoa're, §i anume raportul dintre numérul de cazuri favorabile
§i numérul de cazuri posibile, relativ 1a intregul experiment.
Riispuns:
Analizénd datele din tabelul din enun§, rezultéi imediat

A 24 A 9

6 :—:0.8 '(9 :—:O.45.

A 24+6 §1 B 9+ 11
De observat (:5 termenii 6 §i respectiv 11 de la numitorii acestor fracgii
reprezintﬁ numéirul de fe§e ‘tail’ /ban care au fost 0b§inute 1a aruncarea
monedei A §i respectiv B: 6T : 1T + 2T + 3T, 11T I 5T + 6T.

***************Ending Page***************


***************Beginning Page***************
***************page number:67**************
67.
Maximum likelihcmd
o HTTTHHTHTH 5--H.5T
,. 24
a HHHHTHHHHH QHQIT HA=2—4+5=0.50
o HTHHHHHTHH EH.“ _ g
Eﬂ=m=ﬂ45
o HTHTTTHHTT 4H.ET
a THHHTHHHTH ‘F'H,_-ET
/ 24H,ET 9H,11T
55215.1Dmsaasparsat

***************Ending Page***************

***************Beginning Page***************
***************page number:68**************
68.
Observaigie
Dacéi in locul variabilelor binare Z,- € {A B} pentru 2' I 1, . . . , 5 introducem
in mod natural variabilele-indicator ZM E {0,1} §i Zi,B G {0,1} tot pentru
2':1,...,5, deﬁnite prin ZM :1 iff Z,- : A, §i Zi,A I 0 iff Z135 : 0, atunci
proceséirile necesare pentru calculul probabilitégilor/parametrilor (9A §i (9B
pot ﬁ prezentate in mod sintetizat ca in tabelul de mai jos.“
i Zi,A Z133 Xi
1 0 1 5H
2 1 0 9H i
3 1 0 8H
4 0 1 4H
5 1 0 7H
a Prezentéim acest “artiﬁciu” ca pregﬁitire pentru rezolvarea (ulterioaréi a) punctului
B a1 prezentei probleme.

***************Ending Page***************


***************Beginning Page***************
***************page number:69**************
69.
Xi ' Z1314 Xi ' 24,5
0H (0T) 5H (5T)
9H (1T) 0H (0T)
8H (2T) 0H (0T)
i 0H (0T) 4H (6T) :>
7H (3T) 0H (0T)
2;; Xi ' 24,14 = 24H 215:1 Xi - 21-73 I 9H
2211(10 — Xi) - Z44 Z 6T 211(10 — Xi) ' 22,3 Z 11T
A 24
9 I — I _
{ A 24 + 6 O 8
i 9
é I — I .4
B 9+ 11 O 5

***************Ending Page***************

***************Beginning Page***************
***************page number:70**************
70.

. . . not. . . . .
zz. Calcula§1 L1(9A, QB) I P(X, Z | 6A, <95), func§1a de ver051m111tate a datelor

not. . not. A .. .
X :< X1,...,X5 > §1 Z :< Z1,...,Z5 >, 1n raport cu parametru (9A §1
respectiv QB ai distribu§iilor care modeleazé aruncarea celor doué monede.
Observatie: Facem presupunerea (:51 am reginut succesiunea [tuturor] rezul-
tatelor obginute la aruncérile celor doué monede. Precizarea de facto a
acestei succesiuni nu este esentialé. Dacéi nu s-ar face aceasté presupunere,
ar trebui 55 $5 lucrém cu distributia binomiala”.

***************Ending Page***************


***************Beginning Page***************
***************page number:71**************
71.
Réspuns:
Calculul verosimilitégii datelor:
df ‘ d 5
L1(9A,9B) é P(XaZA>ZB | 6Aa€B) mzep' HP(X11>ZZ',A>Z¢,B | 9AﬁB)
1:1
5
I HP<X¢ \ Zi,A,ZZ-,B;@A,§B) - P<Zi,A,ZZ-,B y 9193)
1:1
I P(X1\ZB,1 I 1,919)‘ 1/2-
P(X2 1 ZAQ I 1,914) - 1/2-
P(X3 1 Z143 I 1,914) ' 1/2-
P(X4 1 Z374 I 1,€B)-1/2-
P(X5 1 Z1475 I 1,914) ' 1/2
1
I 6%(1 — <95)5 - 621(1 — 6A)-6§1(1 — 6A)2-<9j13(1— 8B)6-6;(1— 9A)?’ ' i
1
I i €j4(1 — (9A)6 993(1— QB)11

***************Ending Page***************

***************Beginning Page***************
***************page number:72**************
72.
iii.Calcula1;i éA n25. argmaXQA 10gL1(€A,€B) §i éB mg. argmaXQB 10gL1(9A,6B)
folosind derivatele parigiale de ordinul intéi.

Observaii'i:

1. Baza logaritmului, ﬁxatii dar liisatﬁ mai sus nespeciﬁcatéi, se va considera
supraunitaré (de exemplu 2, e sau 10).

2. Lucrénd corect, vegi 0b§ine acelagi rezultat ca la punctul i.

***************Ending Page***************


***************Beginning Page***************
***************page number:73**************
v 73.
Raspuns:
Funcija de log-verosimilitate a datelor complete se exprima astfel:

log L1(6A, GB) I —5log2 —|— 24log€A —|— 6log(1 — 9A) —|— 910g €B +1llog(1— €B)
Prin urmare, maximul acestei funcgii in raport cu parametrul 9A se cal-
culeaza astfel:
610gL1(9A (9B) 24 6 4 1 A
—’:O (I) ———:O<:)—:—<:>4—46 :@ @Q :08

aeA 6A 1_eA eA 1_6A A A A
810 L € 6 A
Similar, se face calculul §i pentru W §i se obgine QB I 0.45.“
B

Cele doua valori obginute, 9A §i QB, reprezinta estimarea de verosimilitate
maxima (MLE) a probabilitagilor de aparigie a fetgei ‘head’ (‘stema’) pentru
moneda A §i respectiv moneda B.

a Se veriﬁca ugor faptul ca intr-adevar radacinile derivatelor parQiale de ordinul intai
pentru funcgia de log-verosimilitate reprezinta puncte de maxim. Pentru aceasta se
studiaza semnele acestor derivate.

***************Ending Page***************

***************Beginning Page***************
***************page number:74**************
74.
Observatii

1. Am aratat pAe acest caz particular ca metoda de calculare a proba-
bilitatilor (dA §i 6'3) direct din datele observate (a§a cum 0 §tim din liceu)
corespunde de fapt metodei de estimare in sensul verosimitatii maxime
2. La punctul B vom arata cum anume se poate face estimarea acelora§i
parametri (9A §i (93 in cazul in care 0 parte din date, §i anume variabilele Z7;
(pentru i : 1, . . . , 5) sunt neobservabile.

***************Ending Page***************


***************Beginning Page***************
***************page number:75**************
75.

B. La acest punct se va relua experimentul de la punctul A, insé de data
aceasta vom considera c5 valorile variabilelor ZZ- nu sunt cunoscute.

2' ZZ- X2-

1 ? 5H (5T)

2 ? 9H (1T)

3 ? 8H (2T)

4 ‘.7 4H (6T)

5 ‘.7 7H (3T)

***************Ending Page***************

***************Beginning Page***************
***************page number:76**************
76.
Expectatiun maximization
a
q HTTTHHTHTH {145 11 0 U55 x o =E.2--H, 2.2T =13 I'LE-BIT
I Hi-ii-i i-LTHHHHH
“HTHHHHHTHH 13,3ng ugggo =T.2H.U.BT =1.EH.EI.2T
If H T i-e T T T H H T T _
m THHHTHHHTH (1?;3 11 o [12? :1: o ‘gig-‘H, 115T H2.1H;,ﬂ.5T
I 0.35 1: o 0.55 1: o =14 H, 2.1 T = 2.5 H.315] T
91:11:055 0.55 >1 o 0.35;: o his-H. 1.9T ==r215in 1.1 T
63102050 1:213 H. 5.6T =11.?H,B.¢T
H .
‘E... 9.1 ‘" 21.3 + 35 “031
*|_11__ 11.? ._. - :1. ‘i101:
BB ~1—1_? + 5.4 —- 0.55 - 1.“ 15!‘| [LSD
@"l gimﬁﬂﬁi

***************Ending Page***************


***************Beginning Page***************
***************page number:77**************
77.

iv. Pentru conveniengéi, in locul variabilelor ,,ne0bservabile“ Z,- pentru
i I 1, . . . , 5 vom considera variabilele-indicator (de asemenea neobservabile)
Z,7A,Z,-,B G {0,1}, cu ZM I 1{Z,:A} §i ZM + Z¢,B I 1. Evident, intrucét vari-
abilele Z,- sunt aleatoare, rezulté c5 §i variabilele ZM §i ZM; sunt aleatoare.
Folosind teorema lui Bayes, calculaigi mediile variabilelor neobservabile
ZM §i Z1313 condiigionate de variabilele observabile Xi. Veti considera cii
parametrii acestor distributii (Bernoulli) care modeleazﬁ aruncarea mon-
edelor A §i B au valorile 9511)) I 0.6 §i respectiv €g>> I 0.5.

Agadar, se cer: E[Z,',A I X,,95£),9g))] §i E[Z,-7B I Xiﬁyﬁg] pentru 2' I 1, . . .,5.
Ca §i mai inainte, probabilitiiﬁle a priori P(Z,~,A I 1) §i P(Z,;,B I 1) se vor
considera egale cu 1/2.

***************Ending Page***************

***************Beginning Page***************
***************page number:78**************
78.
Notii

Algoritmul EM ne permite $5 facem in mod iterativ estimarea parametrilor
9A §i €B in funcgie de valorile variabilelor observabile, Xi, §i de valorile
in§iale atribuite parametrilor (in cazul nostru, 6'52) I 0.6 §i 3g) I 0.5).
Vom face 0 sintezé a calculelor de la prima itera§ie a algoritmului EM —
detaliate la punctele i'v, v §i 'vi de mai jos — sub forma urmﬁtoare, care
seaméné intr-o anumité mésuré cu tabelele de 1a punctul A:

i ZM Zi,B X1- E[Zi,A] E [Z13]

1 ‘.7 ? 5H 0.45H 0.55H

2 ? ? 9H g 0.80H 0.20H g

3 ? ? 8H 0.73H 0.27H

4 ? ? 4H 0.35H 0.65H

5 ? ? 7H 0.65H 0.35H

***************Ending Page***************


***************Beginning Page***************
***************page number:79**************
79.
Noté (c0nt.)
X. - EMA] X.- - 1112.3]
2.2H (2.2T) 2.8H (2.8T)
7.2H (0.8T) 1.8H (0.2T)
M 5.9H (1.5T) 2.1H (0.5T)
I 1.4H (2.1T) 2.6H (3.9T) I»
4.511 (1.9T) 2.5H (1.1T)
25:1 X.- - E[ZZ-,A] I 21.8H 215:1 X.- - E[ZZ-,B] I 11.7H
25:1(10 _ X.) - ﬁzz-7.1] I 8.7T 2.1100 _ X.) ' E[Zi,B] I 8.3T
- 21.8
8(1) I — I 0.71
i A 21.8 + 8.7
- 11.7
8%) I — I 0.58
11.7 + 8.8

***************Ending Page***************

***************Beginning Page***************
***************page number:80**************
80.
Nota (c0nt.)
Vom arata ca:

0 intr-adevar, este posibila calcularea mediilor variabilelor neobservabile
Z2314 §i Z133, condigionate de variabilele observabile X1- §i in funcgie de
valorile asignate ini§ial (0.6 §i 0.5 in eriurii;7 dar in general ele se pot
asigna in mod aleatoriu) pentru parametrii (9A §i (9B;

0 faga de tabloul de sinteza de la punctul precedent, cand toate vari-
abilele erau observabile §i se calculau produsele X,- - Zi,A §i X,- - Z135, aici
se inlocuiesc variabilele Z1314 §i Z173 cu mediile E[ZZ-,A] §i E[ZZ-,B] in pro-
dusele respective. De fapt, in loc sa se calculeze 2,6 Xi-ZM se calculeaza
media EQ:Z X1- - ZM], §i similar pentru B.

Notatie: Pentru simplitate, in cele de mai sus (inclusiv in tabelele prece-
dente), prin E[ZZ-7A] am notat E[ZZ-,A | Xi,6(0)], iar prin E[ZZ-,B] am notat
Emu; | Xi, W], unde em) "2- (eff), 99>.

***************Ending Page***************


***************Beginning Page***************
***************page number:81**************
81.
Riispuns (iv)
intrucét variabilele Z1714 au valori booleene (0 sau 1), rezultﬁ (:51
EVIL-Am, 9(0)] I 0 - P(Z,L-,A I 01Xi, 9(0)) + 1 - P(ZZ-,A I 112g, W)
I P(ZZ-,A: 11Xi,6(0))
Probabilitiigile P(Zi,A I 1 1 X,e<0>) I 13(22,4 I 1 y Xi,19(01), pentru 1' I 1, . . .,5,
se pot calcula folosind teorema lui Bayes:
PXZ- ZZ- I1 9(0) -PZ¢ I1 6(0)
WM :1 11,10» I 1
2j6{0,1} P(Xi1Zi,A I ]:H())'P(Z1,A I J |¢9< ))
_ P(X¢ | 21,14 21,99)
P(XZ- |Zi714 I 1,§ff))+ P(XZ- | ZLB I Le?)
S-a ginut cont c5 P(ZZ-,A I 1 1 6(0)) : P(ZZ-,B : 1 1 6(0)) I 1/2 (a se vedea
enungul).

***************Ending Page***************

***************Beginning Page***************
***************page number:82**************
82.
De exemplu, pentru 2' I 1 vom avea:
0.65(1 — 0.6)5 1
EZ X€<O> I —:—%0.45
[ A1 | 1’ ] 065(1 _ 0.6)5 + 055(1- 0.5)5 1 025 5
+ 0.24
Similar cu E[ZA,1 i X1,9(0)] se calculeazii §i celelalte medii E[ZZ-,A i XZ-ﬁwu
pentru 1L I 2, . . .,5 §i E[ZZ-,B |XZ~,9(O)] pentruz':1,...,5.
Am inregistrat aceste valori/medii in cel de-al doilea tabel din Nata de
mai sus.
Observatie: Se poate Qine cont c5, de indatéi ce s-a calculat E[Z7;,A i Xi, 9(0)],
se poate obigine imediat §i E[ZZ-,B i Xi,€(0)] : 1— E[ZZ-7A | Xi,9(0)], ﬁindcéi
21,14 + Z173 :1.

***************Ending Page***************


***************Beginning Page***************
***************page number:83**************
83.
'v. Calculaigi media funcigiei de log-verosimilitate a datelor complete, X
(observabile) §i Z (neobservabile):
def.
L2(8A>9B) I EP(Z|X,6(O))[1OgP(X>Z ‘ 9)],
unde e "2 (eA, 9B) §i e<0> “2' @5299).
Semnificajia notaigiei de mai sus este urmiitoarea:
funcigia L2(9A, €B) este 0 medie a variabilei aleatoare reprezentaté de
log-verosimilitatea datelor complete (observabile gi, respectiv, neobserv-
abile), iar aceastﬁ medie se calculeazé in raport cu distribugia probabilisté
condigionalé a datelor neobservabile, P(Z \ X , 6(0)).
Observatie: La elaborarea calculului, vegi folosi mai intéi proprietatea de
liniaritate a mediilor variabilelor aleatoare, §i apoi rezultatele de la punctul
iv.

***************Ending Page***************

***************Beginning Page***************
***************page number:84**************
84.
Riispuns:
Media func§iei de log-verosimilitate a datelor complete, L2(6A,€B), se cal-
culeazé astfel:
de .
L2(6A>9B) If EP(Z|X,6(O))[1OgP(X>Z | 9)]
5
inde .
:p EP(Z|X,@<O>)[10gHP(Xi, Z2314, Z1313 | 9A, (95)]
1:1
d 11: 5
mg‘ gm ' EP(Z|X,6(0))ilOgHP(Xi i ZM, Z13; 914,919) ' P(Z1,Av Ziﬁ i 9A>QBH
1:1
in continuare, 0mi§énd din nou distribugia probabilistéi in raport cu care
se calculeazéi media aceasta intrucét ea poate ﬁ subin§eleaséi, vom scrie:

***************Ending Page***************


***************Beginning Page***************
***************page number:85**************
85.
11209141 €B>
5
ZZ- . , _ . ZZ-B . . _ . 1
I E[1Ogn(8A,A)Xz_[(1 _ 9A)ZZ,A]10 X1433, )XZ _ [(1_ §B)ZZ7B]1O X1 _ 5]
1:1
5
1:1
’ 5
m-Zmed- 2W . E[Zi,14] ~10g 9A + (10 — Xi) - ﬁzz-,1] ~10g(1— 610+
1:1
X1- - E[ZZ-,B] -10g 9B + (10 — Xi) -E[ZZ-,B] -10g(1— 9B) —10g2]
5
I Zlogwilfz E[Z@,A] _ (1 _ €A)(1O—Xi)-E[ZZ-,A] _ 6}); E[Z1,B] _ (1 _ §B)(10-XZ-)-E[Zi,B] _ 5]
1:1
1
= logwj-Z - (1 _ e102-2 . egg - (1 _ (913)2-8 . . . . - 93-5 - (1 _ @191? - (1 _ eB)1-1 . 5).

***************Ending Page***************

***************Beginning Page***************
***************page number:86**************
86.
La ultima egalitate de mai sus, cantitégile fracgionare provin din calculele
X5,9] w 4.5, X5 - E[Z1,B | X5,9] z 2.5 (a se vedea tabelele din cadrul Notez'
precedente) .

***************Ending Page***************


***************Beginning Page***************
***************page number:87**************
87.
vi. Calculagi Q11) n22. arg maXQA L2(6A, 8B) §i 9%) n25. arg maXQB L2(€A, 9B).
Réspuns:
Valorile parametrilor 8A §i QB pentru care se atinge maximul mediei funcgiei
de log-verosimilitate a datelor complete se 0b§in cu ajutorul derivatelor
pargiale de ordinul intéiza
68A
8
:> 87(2210g €A —|— 2.210g(1 — 9A) + . . . —|— 4.510g€,4 +1.910g(1 — 614)) I O
A
2.2 2.2 4.5 1.9 (1)
i——— ———:O:>...:6 x071.
eA 1_@A+ +eA 1_eA A
Similar, vom obgine (9g) m 0.58.
a Este imediat c5. derivatele de ordinul a1 doilea au valori negative pe tot domeniul de deﬁnigie.

***************Ending Page***************

***************Beginning Page***************
***************page number:88**************
88.
C. Formalizagi pagii E §i M ai algoritmului EM pentru estimarea
parametrilor 9A §i QB in condigiile de la punctul B.
Raspuns:
Formulele care se folosesc in cadrul algoritmului EM pentru rezolvarea
problemei date — i.e. estimarea parametrilor 9A §i QB atunci cénd vari-
abilele Zi sunt neobservabile —, se elaboreain/deduc astfel:

***************Ending Page***************


***************Beginning Page***************
***************page number:89**************
89.
Pasul E:
ﬁzz-7A \ Xi, e] I P(ZZ-,A I 1 y Xi, e) I ﬁzz-A :1 \ Xi, a)
1/2
r—’%
T.:B. P(X¢ \ Z1314 I 1; 9) ' P(Z¢,A :1 ‘ 9)
_,—/
1/2
_ P(Xi 1217A I 1; e) + P(XZ- y ZLB I 1; e)
— Qiiﬂ _ 9A)10—Xi
@ifm - @A>1O—Xi + @5510 — @BWQ
Similar, vom obgine:
€Xi 1 _ (9 10—XZ-
E[Z¢,B I Xiﬁ] I %
(9A1(1 _ 614)“) XZ _|_ 6BZ(1_ (QB)1O—XZ

***************Ending Page***************

***************Beginning Page***************
***************page number:90**************
90.
Noténd cu
— 3:1- Valoarea variabilei Xi,
— (9X) §i respectiv 6g) estimérile parametrilor 9A §i 6'3 la itera§ia t a algo-
ritmului EM,
_ 192T) §i respectiv pggl), mediile E[Z¢,A \ XZ-ﬁf] §i E[Zi,B \ XMQ],
vom avea:
t x. t _$.
p<t+1> _ w
@314 _ 1: . t _m. t 93- t _$.
<9?>%<1— 952)“) 1+ (85;) 1<1 — 922)“) I
t x. t _$.
p(t+1> _ M
ZEB — t . 1: _$. 1: 93- t _m.
(@Wm — 9W 1+ (85;) 1<1 — 822)“) I

***************Ending Page***************


***************Beginning Page***************
***************page number:91**************
91.

Pasul M:
Ca §i mai inainte, in formulele de mai jos vom folosi notaigiile simpliﬁcate
EMA] "it E[ZZ-,A | Xi, W] §i ﬁzz-,3] "2' E[Z7;,B | Xi, em.
Cu aceste notagii, procedénd similar cu calculul de la partea B, punctul v,
vom avea:

5

L2(6A> 9B) I 10g H gimzmlﬂ _ §A)(10-a:Z-)E[Zi,A] egmziﬁlu _ €B)(1O—xi)E[ZZ-’B]
1:1

***************Ending Page***************

***************Beginning Page***************
***************page number:92**************
92.
Prin urmare,
a 1 5 1 5
—L6 9 :0:— Z-EZZ- :— 10—,-EZZ-
551 MB) 92 1,11 1%? @151
5 5
5 (1_ (91) Z $¢E[ZZ-,A] I (91 2(10 _ 51)E[zZ-,A]
i=1 1:1
5 5
:> Z xiE[ZZ-,A] I 10 9A Z EMA]
1:1 izl
5 5
:> 9A : —ZZ:15$ [ A] §1, 51m11ar, €B I —EZ—15£U [ ’B]
10 25:1 E[Z1,A] 10 25:1 E[Zi,B]
A§adar, la pasul M a1 algoritmului EM vom avea:
5 5+1 5 5+1
A — — B — —
10 215:1 BET) 10 215:1 pix-$1)

***************Ending Page***************


***************Beginning Page***************
***************page number:93**************
Q O I O 93-
Summmg up: The EM algorlthm for solvmg thls problem
lnitializare:
atribuie valori arbitrare (69,6?) Tn intervalul (0,1))
pentru parametrii 6A 5i respectiv 05;
Corpul iterativ:
pentru t I 0, . . . 7T — 1 (cu T fixat Tn avans)
(sau: péné cénd log-verosimilitatea datelor observabile nu mai creste semnificativ),
(sau: pana cénd mfg) _ ef§+1>\ < 6, 85; _ eg+1>\ < a,
cu a fixat Tn avans)
executé’
Pasul E:
pentru 2' : 1, . . . , 5 calculeazé’
p<t+1) _ (9%))“ (1 — 6545))10-902'
"AA _ t _ t _$_ t 1»- t _$.
(65459641 —@i8>10 1+<655>> 1<1—@§£>10 l
pun) _ (85551” <1 — @WM .
LB — t , t _m, t x. t _x.’
(95453010 —@f£>10 1+<Q§5>> 1<1—923>10 1
Pasul |\/|:
5 2 n+1) 5 g n+1)
9(t+1) _ 21:1 10 pi,A $i 9(t+1) _ Zizl 10 p13 _
A — t+1 B _ t+1 '
EizlpgA ) 215:1 pigB )
V t+1 t+1 _
Returneaza 954 26% ),

***************Ending Page***************

***************Beginning Page***************
***************page number:94**************
94.
Observatje

Implementénd algoritmul EM cu relaigiile obginute pentru pasul E §i pasul
M, dupii execu§ia a 10 iteragii se vor 0b§ine valorile 6210) m 0.80 §i (9210) z 0.52.
Este interesant de observat (:51 estimarea 0b§inut5 pentru parametrul (9A
este acum la acelagi nivel cu cea 0b§inutii prin metoda verosimilitégii
maxime (MLE) in cazul observérii tuturor variabilelor (0.80, vezi rezolvarea
de la partea A, punctul 7L), iar estimarea obginuté pentru parametrul 9B a
coborét de la valorea 0.58 care a fost obginuté 1a prima iteragie a algoritmu-
lui EM la 0 valoare (0.52) care este considerabil mai apropiatéi de estimarea
prin metoda MLE (0.45).

***************Ending Page***************


***************Beginning Page***************
***************page number:95**************
95.
O 1 2 3 4 5 6 7 8 9 1O 12 14 16 18 20 05 06 07 08 09
Number of iterations I . BIA . I
Nata”: Implementarea acestui algoritm EM, precum §i graﬁcele au fost real-
izate de ciitre Sebastian Ciobanu.

***************Ending Page***************

***************Beginning Page***************
***************page number:96**************
96.
Q O i=1
‘- A i=2
AAAAAAAAAAAAAAAA+i=3
A X i=4
A <> i=5
A +++++++++++++++
\J v +
In graﬁcul alaturat prezentam valo- 3 A A +
- (t) "it (t—1) +
rlle p¢,A _ E[Z1'7A \ X13914 ], pentru + +
. . 1: t
z I 1, . . . ,5. (Ev1dent, pig I 1 —p§,1)4.) <>
UV _ g <><><><><><><><><><><><><><><><><>
Se observa ca valorlle acestea converg 5 <> <>
GD
relatlv repede §1, daca la convergenga é
se face trecerea la apartenenis'éi de tip E'- o
“hard” (adicii se aplicé 0 reguléi de de- 3'
Q I O I I O X
Clzle de tlpul celel f010s1te de algor1t-
o 0 u O
mul Bayes Nalv), atunc1 se regasesc
exact etichetele care au fost ,,§terse“, g >< O
adicﬁi (in ordine) B, A, A, B, A! ° O
X O O O O O O O O O O O O O O O
X
XXxxxxxxxxxxxxxx
8
5 1O 15 20
t

***************Ending Page***************


***************Beginning Page***************
***************page number:97**************
97.
The EM algorithm for solving
a mixture of two vectors of
independent Bernoulli distributions,
aka the unsupervised Naive Bayes
CMU, 2014 spring, Aarti Sing, Barnabas Poczos, HW3, pr. 2.1

***************Ending Page***************

***************Beginning Page***************
***************page number:98**************
98.
In Naive Bayes, the joint likelihood of the data is:
' 'd n n d .
pm) :- Hpmm) z HM) HMXZM)

1:1 1:1 jzl
Let us assume that Y1- € {0,1} Vi and X5 G {1,2,...,V}Vz',j. Denote the pa-
rameters of p(Y) by 7T and the parameters of p(X|Y) by 6. In the presence of
labeled data (i.e., Y2- is observed for all i), we can get estimates of 7T nit (7T0, 7T1),

not. . . .

5 I (61|0=62|0>--~76V|0>61|1162|1w~76VI1) by counting and normahzlng.
We denote random variables by capital letters and their values by lowercase
letters (e.g., Y;- denotes a random variable, while yz- denotes its assignment
from the set of possible values of random variable Y1).
Suppose that we do not have labeled data. We can still estimate these pa-
rameters using the Expectation Maximization (EM) algorithm.

***************Ending Page***************


***************Beginning Page***************
***************page number:99**************
99.
a. Specify the (log) likelihood function that needs to be maximized.
Hint: The likelihood function will now be a summation over all possible
assignments to all latent variables.
b. Derive the E-step, i.e., compute the probability of all class assignments for
each data point, given current parameters 7r and B.
c. Derive the M-step, i.e., compute the parameter updates for each class,
given the class assignment distributions for each point from E-step.
d. Specify a good initialization technique and describe your rationale.

***************Ending Page***************

***************Beginning Page***************
***************page number:100**************
100.
Solution
a. [LCz Letting aside the parameter 6, we would write]
n d j ” p(yi)H§l:1P(wilyi)
10g P(w1, - - - an) I 210g Z My» Hpm-lyi) I 210g Z My»?
1'21 yi€{0,1} 1:1 iIl yie{0,1} q y”
n d ‘
2 Z Z q<yi)10g’(—t)
2:1 y¢€{0,1} q 3h
n d '
I 2 Z th) 10gp(yi)+ Zlogpwilyi) —1OgQ(yZ-) -
b. In the E-step, for all 2', we update q(yZ-) given the current values ofjr and 6. Since
we know the current values of 7T and B, we can compute p7r (yz) and 195(5632 |y2). Taking the
derivative with respect to q(yl) and set it to zero, we get the following update rule:
d . d .
qOG I 0) O< 2MB I 0) Hp/akalYi I 0), and (1(Yi I 1) “pm/i I 1) HPMIBZIYZ- I 1)-
jzl 3:1

***************Ending Page***************


***************Beginning Page***************
***************page number:101**************
101.
c. In the M-step, we know the values of q(y,-), so this step is very similar to super-
vised Naive Bayes updates. Maximizing the objective function with respect to the
parameters, gives the following update:
TL
7T 0 O< Z (1(Y1 I 0)
1:1
TL
111 O< Z q(Y1 I 1)
1:1
‘ n
51310 O‘ qu I 0) '1{1g:1}
1:1
. TL
517,11 O‘ qu I 1) ‘ 1{1»g=1}
1:1
d. A good initialization technique should incorporate our knowledge about the possible
solution. If we think one class is more likely than the other, use this in our initializa-
tion of 7T. For the 6 parameters, if we think some words are indicative of a class, we
should also set the corresponding B for that word to be higher. In the absence of prior
knowledge, we can initialize these parameters randomly.

***************Ending Page***************

***************Beginning Page***************
***************page number:102**************
102.
The EM algorithm for solving
a mixture 0f K categorical distributions
CMU, 2015 spring, Torn Mitchell, Nina Balcan, HW6, pr. 1

***************Ending Page***************


***************Beginning Page***************
***************page number:103**************
103.

Miazture models are helpful for modelling unknown subpopulations in data.
If we have a collection of data points X I {X1, . . . ,Xn}, where each X,- is [in-
dependently] drawn from one of K possible distributions, we can introduce a
discrete-valued random variable Z,- G {1, . . . , K } that indicates which distribu-
tion X,- is drawn from.
This exercise deals with the categorical mixture model, where each observation
X,- is a discrete value drawn from a categorical distribution. The parameter for
a categorical distribution is a K -dimensional vector 7r that lists the probability
of each of K possible values (therefore, 2k in, : 1).
For ewample, suppose our categorical mixture model has 3 underlying dis-
tributions. Then, each ZZ- could take on one of three values, {1,2,3}, with
respective probabilities 7T1,7T2,7T3; equivalently, Z,- ~ Categorical(7r), where 7T I
(7T1,7T2,7T3) 6 R1, with 7T1 + 7T2 + 7T3 I 1. The observation X,- is then generated
from another categorical distribution, depending on the value of Zi.
The generative process for a categorical mixture model is summarized as fol-
lows:

Z, ~ Categorical<7r)

X,- ~ Categoricalwzi)

***************Ending Page***************

***************Beginning Page***************
***************page number:104**************
104.

For this model, where we observe X but not Z, we want to learn the parame-
ters of the K categorical components (9 I {7r, 91, . . . , 8K}, where each 9k € RM is
the parameter for the categorical distribution associated with the k-th mix-
ture component. (It implies that each X1- can take on one of M possible
values). We will use the EM algorithm to accomplish this.
A note on notation and a hint:
When working with categorical distributionsit is helpful to use indicator func-
tions. The indicator function 1{w:j} has the value 1 when x I j and O otherwise.
With this notation, we can express the probability that a random variable
drawn from a categorical distribution (e.g., Y ~ Categorical(gb), where gb € RN)
takes on a particular value as

N

P<Y> I H at“
i:1

***************Ending Page***************


***************Beginning Page***************
***************page number:105**************
105.
a. What is the joint distribution P(X, Z; (9)?
b. What is the posterior distribution of the latent variables, P(Z\X; (9)?
c. Compute the ewpectation of the log-likelihood,
d. What is the update step for 6? That is, What (9 maximizes Q(6|®’)?
Hint: Make sure your solution enforces the constraint that parameters t0
categorical distributions must sum to 1. Lagrange multipliers are a great way
to solve constrained optimization problems.

***************Ending Page***************

***************Beginning Page***************
***************page number:106**************
106.
Answer:
a.
P<X, Z; @> I H P<X¢, 22-; 9) I HP<XAZZ¢ @>P<ZZ-; <9)
2'21 2'21
n K M 1 1{ZF’<=}
I H H 7Tk: H @kixizuj}
i=1 krzl j:1
b.
Bayes F. P<Xi|Zi I k; @)P(ZZ' I k; 9)
P ZZ- I k Xi; I —
< ‘ 9) Pm; @>
1
_ P(Xi‘Zi I k; @)P(Z¢ I k; 6) szl [Wk szl GM I
3:1 P(Zi _ z, @)P(XZ|ZZ _ 1,9) 2,111 m Ply-Ail 9Z3; J}

***************Ending Page***************


***************Beginning Page***************
***************page number:107**************
107.
c.
de.
Q(®!@’) If EZ\X;@I[1ogP<X,Z;@>1
n K [ M 1 _|1{Zi:k}
g EZ\X;@’ 10g H H Trig H ekj-Xizvj}
3:1 11:1 L 3:1 J
n K M
3:1 k:1 3:1
n K M
“1 k4 P(ZZ-:k|X3;@) kl
Using
/ M / 1{X-:v~}
no. b. 7Tkrl‘: (9k) Z j
Wk It EZ|X;@/[1{Zi:k}] I 13(21: MXZ'ﬁ') I K331M—j/1{X_} ’
21:1 7T1H3=1(913) F113
leads t0
n K M
Q(@|@’) I Z Z m 10g m + Z lam-:13} 10g 913'
3:1 13:1 3:1

***************Ending Page***************

***************Beginning Page***************
***************page number:108**************
108.
d. To ﬁnd the updates rules for the parameters, we solve the following constrained
optimization problem:
maXFﬁlzK Q(6|@/)
subject to 25:1 m; : 1
Zjlilekj :1,Vk:1,...,K
We introduce a Lagrange multiplier for each constraint associated to this problem and
form the Lagrangian functional:
K K M
L I Q(®|@’) +A7T <1 _ Em) +23% 1 _ 2%
k:1 kzl 9:1
Now we Will differentiate the Lagrangian functional with respect to each parameter we
want to optimize, set the derivative to zero, and solve for the optimal value.

***************Ending Page***************


***************Beginning Page***************
***************page number:109**************
109.
We’ll start With optimizing for 7T, the parameter to the categorical distribution for the
latent variables Z.
8L n 1 1 n
3m; ;Vk Wk 7T1; Mgvk
We can ﬁnd the value of the Lagrange multiplier AW by enforcing the constraint:
Etﬂeigiwﬂegiiwﬂe
kzl ktzl 1:1 kzl 2:1
K n n K
k::1 1:1 1:1 k::1
1
Substituting this value for AW back into the expression of 71,’; gives the answer:
>l< 1 n
Wk; I b 21 Wk;

***************Ending Page***************

***************Beginning Page***************
***************page number:110**************
110.
The process for optimizing the observation parameters ij is similar. First, we differ-
entiate the Lagrangian C with respect to ‘9ka set to zero, and [ﬁnally] solve.
8L n 1
>|< 1 n
9'“ 1:1
Again, we can ﬁnd the value of the Lagrange multiplier Agk by enforcing the summation
constraint:
Z9111 I 1 (I) Z T01 ZVM: 1{XZ-:11j} I 1 (i) E 227111 1{Xi:1j} I 1
3:1 3:1 1:1 9:1 1:1
M n
1:1 1:1
Substituting this value for A911 back into the expression of 6,;- gives the answer:
* 221:1 V111 1{Xi:11j} 221:1 '7111 1{Xi:1j}
ekj I M n I n M
21:1 21:1 'Yik 1{X1:v1} 21:1 21:1 W111 1{X1:v1}

***************Ending Page***************


***************Beginning Page***************
***************page number:111**************
111.
Using the EM algorithm for
learning a categorical distribution
[and implicitly a multinomial distribution]
Application to the ABC) blood model
Liviu Ciortuz, following
Anirban DasGupta, Probability for Statistics and Machine
Learning, Springer, 2011, EX. 20.10

***************Ending Page***************

***************Beginning Page***************
***************page number:112**************
112.
Grupele sangvine ale oamenilor sunt determinate de variantele (,,a1elele“)
unei gene situate pe cromozomul 9 (mai exact, la pozitia 9q34.2), numita
gena ABO. Se §tie ca ﬁecare dintre noi dispunem de cate o pereche de
astfel de cromozorni, deci de cate doua copii ale genei AB O, §i anume una
mo§tenita de la tata §i una mo§tenita de la mama.
grupe alele

Se noteaza cu A, B §i O cele trei tipuri de alele sangvine mo§tenite
ale genei ABO. Alelele A §i B sunt domznante
A A AA
1n raport cu alela O. (Altfel spus, alela O este AO
recesiva in raport cu ﬁecare dintre alelele A §i BB
B.) Alelele A §i B sunt codominante. Prin ur- “-
mare, grupele sangvine pot ﬁ speciﬁcate conform

- v
tabelulul alaturat. “m
Presupunem ca, intr-o populatie oarecare, ﬁecare dintre alelele A, B §i
O are la barbati aceea§i frecventa ca §i la femei. In cele ce urmeaza,
aceste frecvente (notate respectiv cu pA, pB §i p0) vor ﬁ considerate a
priori necunoscute, dar urmeaza sa 1e determinam.

***************Ending Page***************


***************Beginning Page***************
***************page number:113**************
113.
Location 0f the ABO gene on
chromosome 9 The ABO protein

W a
51:23

E1122 = H

Qp211
$132 = Q r r . _/ {,

51:12 U h

.J

51121.11 _ ‘ ' , . '.
9421.13 — I

M131 - Q
9421.33 " .

w : * ‘ - .
91-2-52 _ - 4 ~

9:15-11 _ v
Qq5'1.3
Qqaas

-
@342 111214.12 ‘h
Source: wiki
Source: wiki

***************Ending Page***************

***************Beginning Page***************
***************page number:114**************
114.
ch. 9 ch. 9’
----
Pro a i ity counts
"AA type type
probabilities alleles alleles , AA p 2 _|_
A A nA
P A A A A0 2 p A p 0
ABO ABO n
I’ B B BB 2
B > BB P +
gene gene B
p0 O O B0 2
poo
2 n
2
ﬂﬂ-u
parameters unobservable data observable data
Output <(— EM algorithm <(— Input

***************Ending Page***************


***************Beginning Page***************
***************page number:115**************
115.

a. Consideriim (:51 intr-un e§anti0n de populatie format din n per-

soane sunt nA persoane cu grupa sangviné A, nB persoane cu grupa
sangvinéi B, nAB persoane cu grupa sangvinéi AB §i no persoane cu

grupa sangvinéi O. (Evident, n I na + nB + nAB + no.)

Pornind de la aceste date ,,0bservabile“, $5 se deriveze algoritmul

EM pentru determinarea probabilitétilor pA, pB §i p0. (Evident,
intrucét suma lor este 1, va ﬁ suﬁcient 55 se determine dear douéi

dintre ele.)

***************Ending Page***************

***************Beginning Page***************
***************page number:116**************
116.

Indicagii
1. Presupunand ca procesul de asociere a alelelor mogtenite de
catre un individ de la parin§ii lui respecta proprietagile speciﬁce
evenimentelor aleatoare independente, rezulta ca probabilitaﬁle
de realizare a combinaigiilor (in termeni genetici: ,,fen0tipurile“)
AA, AO, BB, BO, AB §i OO intr-o populagie oarecare sunt p124,
ZpApo, p23, 2293290, ZPAPB, §i PBSpectiv p?)-
2. Considerand nA I nAA+nAO §i nB I nBB+nBO, unde semniﬁcaigiile
numerelor nAA, nAO, nBB §i “B0 sunt similare cu semniﬁcaigiile nu-
merelor nA, nB, nAB, §i no care au fost precizate mai sus, este
natural ca in formularea algoritmului EM datele nAA §i nBB sa ﬁe
considerate ,,ne0bservabile“. Ca parametri ai modelului, se vor
considera probabilitaﬁle pA, pB §i p0.

***************Ending Page***************


***************Beginning Page***************
***************page number:117**************
117.
3. La pasul E al algoritmului EM vegi calcula ﬁAA §i ﬁBB,
care reprezintﬁ respectiv numéirul ,,a§teptat“ de aparigii ale
combinagiei de alele AA §i numéirul ,,a§teptat“ de aparigii ale
combinagiei de alele BB in populatgia datéi.
Ve§i scrie apoi functia de log-verosimilitate a datelor com-
plete (,,0bservabile“ §i ,,ne0bservabile“), exprimatéi cu ajutorul
distribuQiei Multinomz'aKnmi, ZpApO, p23, ZpoO, ZpApB, 10%)).
4. La pasul M a1 algoritmului EM, pornind de la media funcgiei
de log-verosimilitate care a fost calculatﬁ la pasul E, vegi stabili
regulile de actualizare pentru probabilitﬁgile pA, pB §i p0.
Atentie: suma acestor probabilitéigi ﬁind 1, problema de opti-
mizare peAcare va trebui 55 0 rezolvaﬁ la pasul M este una cu
restricgii. In acest sens, metoda multiplicatorilor lui Lagrange v51
poate ﬁ de folos.

***************Ending Page***************

***************Beginning Page***************
***************page number:118**************
118.
Solution
Notations:
' Parameters P I {PA7PB7P0}
(in fact, it will be enough to estimate pA and p13, since pA +pB +190 : 1)
o observable data: nabs I {nA,nB,nAB,nO}
o unobservable data: nunobs : {nAA,nAO,nBB,nBO}
(in fact, we will restrict nunobs to {nAA,nBB})
o complete data: ncompl : nabs U nunobs
' HIHA+HB+HAB+nm 11A :nAA+nAOa 71B :nBB+nBO-
The likelihood of complete data:
t.
MP) “é PmepllP) I
n! 2 nAA nAO 2 nBB nBo nAB 2 no
W ' (PA) ‘(2 PA PO) '(PB) ‘(2 PB PO) ‘(2 PA PB) '(Po)

***************Ending Page***************


***************Beginning Page***************
***************page number:119**************
119.
The log-likelihood function:
def.
@(P) I 1HL(P)
_ 2 2 2
— C + nAA1n(pA) + "A01n(2 PA P0) + "BB 1H(PB) + "B0111(2 PB Po) + PAB1H(2 PA PB) + "0111(Po)
I c’ —|— 2 nAAlnpA —|— nAO(lnpA +1np0) —|—
2 nBB 1HPB + nBOUIIPB +1I1Po) + "HABUHPA +1I1PB) + 2 no 1HP0
: c’ —|— 2 nAAlnpA + (71A — RAA)(1I1PA +1nPO) +
2 11331an + (71B — "BBWHPB +1I1Po) + "ABOHPA +1I1PB) + 2 no 1HP07
where c and c’ are constants which do not depend on the p parameter.
The “auxiliary” function:
(t) dif- E g . (t)
Q(P\P ) — [ (P)|P0bs ,P 1
: Cl + 2 72AA lIlpA —|— (72A — ﬁAA)(lnpA +1Ilp0) —|—
2 72BB 1112913 + (71B — 723B)(1an + 111190) + "ABUHPA +111PB) + 2 no 1HPO>
where
72AA "gt- EinAAlnobs ;P(t)] I EinAAmA» RB, RAB, n03PEi),Pg)7Pg)i
723B nét' E[nBB|nobs ;P(t)] I EWBBWAWBWAB,n03Pg)>Pg)>Pg)i

***************Ending Page***************

***************Beginning Page***************
***************page number:120**************
120.
E step: As indicated by the expression of Q, here we have to compute 2AA
and ﬁBB, the ecvpected number of individuals having the phenotype (aka,
the allele pair) AA, and respectively BB.
Firstly, taking into account that n A A (or, equivalently, the phenotype AA),
when seen as a random variable, follows a binomial distribution of param-
(t) 2
eters n A and %, its expectation will be:
p2 + 2114 p0
ﬁAA 71g. ElnAAlnA,nBWABWO;P(Z)7Pg)QPg)l
(t) 2
P
I (t) 2( A) (t) (t) '"A'

(PA ) + 219A Po

Similarly,
TALBB Hg‘ ElnBBlnAmB,MB,no;pfi),pg),Pg)l
(t) 2
P
I (t) 2< B) (t) (t) 'nB'
(p3 ) + 2193 p0

***************Ending Page***************


***************Beginning Page***************
***************page number:121**************
121.
M step:
Given the constraint pA + pB +190 I 1, we will introduce the Lagrange vari-
able/ “multiplier” A and solve for the optimisation problem
not. 1 1 1
p(t+1) I (pf? )7p(Bt+ )7p(0t+ ))
1: t t
I argmaX [Q(pA,pB,polp54),p§B),pg)) + M1 — (19A +pB +po))]
pA7pB>pO
I argmaX [c' + 2 ﬁAAlnpA + (12A — ﬁAA)(lnpA + lnpO) + 2 721351an +
291472937 PO
(n5 — ﬁBB)(lan + lnpO) —|— nAB(lnpA —|— lan) + 2 n0 lnpO —|—
M1 — (PA +295 +po))l
Taking the partial derivatives of the objective function w.r.t. pA, pB and p0
and solving them leads to:
1 A A A 1 A
p—A(2 nAA +nA — nAA +nAB) — A I 0 I>PA I X<nAA +nA +nAB)
1 A A A 1 A
25(271133 +713 — nBB +nAB) — >\ I 0 I>pB I X<nBB +713 +nAB)
1 A A A 1 A A
EULA —nAA+nB —nBB+2nO) —)\: 0:>p0 I XMA —nAA+nB —nBB +2110)

***************Ending Page***************

***************Beginning Page***************
***************page number:122**************
122.
Now, enforcing the constraint 15A +155 +150 : l gives
X<nAA+nA+nAB+nBB+nB+nAB+nA—nAA+nB—nBB+2nO) I 14:)
2
X0114 +7113 +nAB +710) :1
Slnce n : nA + nB + nAB + no, 1t follows 1mmed1ately that X271 I 1.
Therefore /\ I 2n.
Together with the results obtained on the previous slide, this leads
to the following updating relations:
A 1 A
PSH) I 2—(nAA + RA + nAB)
n
A 1 A
Pgﬂ) I 2_(nBB + RB + RAB)
n
A(t+1) _ 1 A A _ 1
PO — $0114 — nAA + RB — nBB + 2110) — $0M“) + nBo + 2710)

***************Ending Page***************


***************Beginning Page***************
***************page number:123**************
123.

b. Implementaﬁ algoritmul EM pe care l-a’§i conceput la punctul
a 5i rulatgi-l pentru input-ul nA I 186, nB I 38, nAB I 13, n0 I 284
(n I 521).
Ca valom' initiale pentru parametri, vegi lucra mai intéi cu pA I

1
pB I p0 I g, iar apoi cu pA I p0 I 0.1 §i pB I 0.8.
Pentru opri're, vegi cere ca pg), pg) §i pg) s5 nu difere (ﬁecare in
parte) cu mai mult de 10-4 fatgﬁ de valorile calculate la itera§ia
precedentéi. Comparagi rezultatele obtinute pentru ﬁecare din cele
douii initializéiri.

***************Ending Page***************

***************Beginning Page***************
***************page number:124**************
124.
Starting values: Starting values:
PA I pB I p0 I 1/3- m I p0 I 0-01, pB I 0.98-
Iterations: Iterations:
t pA pB p0 t 19A pB p0
1 0.2505 0.0611 0.6884 1 0.2505 0.0847 0.6648
2 0.2185 0.0505 0.7311 2 0.2193 0.0511 0.7296
3 0.2142 0.0502 0.7357 3 0.2143 0.0502 0.7355
4 0.2137 0.0501 0.7362 4 0.2137 0.0501 0.7362
5 0.2136 0.0501 0.7363 5 0.2136 0.0501 0.7363
6 0.2136 0.0501 0.7363 6 0.2136 0.0501 0.7363
Note: The ﬁnal results are the same.

***************Ending Page***************


***************Beginning Page***************
***************page number:125**************
125.
Using the EM algorithm for
learning a multinomial distribution
which depends on a single parameter
Application to a bioinformatics task:
computing probabilities for two linked bi-allelic loci
in haploid cells
Liviu Ciortuz, following
Brani Vidakovic, Georgia Institute of Technology,
Bayesian Statistics course (ISyE 8843A), 2004,
Handout 12, sec. 1.2.1

***************Ending Page***************

***************Beginning Page***************
***************page number:126**************
126.
Biological background: Meiosis
Daughter
Nuclei ll
Daughter
Nuclei
/‘
\s
n /
—’
\.
/v
'nterphase l Meiosis | \.
Homologous Meiosis H
Chromosomes
Source: wiki

***************Ending Page***************


***************Beginning Page***************
***************page number:127**************
127.
O O ’
Blologlcal background (cont d)
-- I-
(1-p)/2 (1-p’)/2
E- E3-
MIG-11W m (1 —p’)/2
male / father diploid cell female / mother diploid cell
offspring diploid cell
ch. i ch. i . ch. i ch. i
A/a A/a E E A/a A/a
B/b B/b 5 5 B/b B/b
E____Na A/a____§
B/b BR)
meiosis meiosis
> g <
(including (including
crossover) crossover)
homologous chromosomes homologous chromosomes
haploid cell haploid cell
fecundation

***************Ending Page***************

***************Beginning Page***************
***************page number:128**************
Biological background (cont’d) 128'
Note: Alleles A and B are dominant w.r.t. a and respectively b.
Genotype:

1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16
AA Aa aA AA Aa aA AA Aa aA AA Aa aA aa aa aa aa
BB BB BB Bb Bb Bb bB bB bB bb bb bb BB Bb bB bb

‘_z—/_z—”_z—/V
AB Ab aB ab
nAB nAb naB nab
2 + w ﬂ ﬂ 1

4 4 4 4

with 4 “g <1 —p>(1 —p’)-

We have designated in magenta colour the offspring phenotype, in blue the counts, i.e.

the number of individuals having a certain phenotype in a given population, and in red
the corresponding probabilities.

Note that

1 — 1 — ’
P(ab) I W and
p p’ p 1-29’ 1-2) p’ 1-(1—p)(1—P’) 1 (1—p)(1—p’)
() <a)22+22+22 4 4 4

***************Ending Page***************


***************Beginning Page***************
***************page number:129**************
129.

Fie 0 variabilé aleatoare X care ia valori in mul§imea {111,112,113,v4}

2 1 — 1 —
§i urmeazé distribugia Multinomz'al (n; —Z w, —4 w, —4 1b, €> , unde
1p este un parametru cu valori in intervalul (0, 1). Cele patru prob-
abilitﬁgi listate in deﬁnigia acestei distributii multinomiale sunt in
corespondengé directéi cu valorile 211,112,113 §i v4.
a. Presupunem (:51 n1, n2, n3 §i n4 sunt numiirul de ,,realiz§1ri“
ale valorilor 111,222,123 §i v4 in totalul celor n ,,0bserva§ii“. Pentru
ﬁxarea ideilor, vom considera n1 I 125, n2 I 18, n3 I 20 §i n4 I 34.
Calculatgi estimarea de verosimilitate maximﬁ (MLE) a parametru-
lui w.

***************Ending Page***************

***************Beginning Page***************
***************page number:130**************
130.
Solution
By denoting n : n1 + n2 + n3 + n4,
2 1 — 1 —
and kowing that (n1, n2, n3, n4) ~ Multinomial (n; ¥, ij Tw, %) ,
it follows that the verosimility function Will be
def- n! 2+¢ n1 1—¢ n2 1—¢ n3 w n4
L I P D : — - — . — . — . _
While
mp) déf' lnL(¢) I lnc + n11n(2 + 1p) +012 + n3) ln(1 - w) + n4 1w,
Where c is constant W.r.t. 1p.

***************Ending Page***************


***************Beginning Page***************
***************page number:131**************
131.
26W) : 77,1 _n2+n3+E:n1-¢(1—¢)—(n2+n3)~¢(2+¢)+n4-(2+¢)(1—¢)
59¢ 2+¢ 1-17 w (2+¢)(1—¢)¢

_ 111$ — MW — 2n2¢ — "2le — 271%? — 713in + 2714 — 2711M + 714$ — "4192

(2 + ¢)(1 — W
_ —¢2(n1 + n2 + n3 + n4) + M711 — 2712 — 2713 — 714) + 2714
(2 + ¢)(1 — @DW
_ —mb2 + ¢(n1 — 2n2 — 2n3 — n4) + 2n4
(2 + 1W1 — 1MP
Note that the denominator (2 + @b)(1 — @bﬂb is always positive.
By substituting n1, n2, n3 n4 for 125, 18, 20 and respectively 34, the numerator
becomes —1971b2 —|— 15¢ —|— 68.
By analysing the sign of this expression, it is easy to see that for our data
the function KW) reaches its maximum in the interval (O, 1) for
A —15 — V152 + 4 - 197- 68 —15 — V225 + 53809 —15 — 231.967
I — I — I — : 0.626819797.

w —2 - 197 —394 —394

***************Ending Page***************

***************Beginning Page***************
***************page number:132**************
132.
1 1 — 1 —
b. Fie acum variabila aleatoare X’ ~ Multinomz'al (n; 5, %, —4 w, —4 1P, €> . Valorile luate
de variabila X’, corespunzator acestor cinci probabilitatgi, sunt (in ordine) 111,111, 222,113 §i
U4.
Observati ca, in raport cu distributia multinomiala de la punctul a, am ,,desc0mpus“
2 1
probabilitatea ¥ in doua probabilitaigi, 5 §i %, ca §i cum ele ar corespunde unor
evenimente disjuncte.
Vom considera n11, n12, n2, n3 §i respectiv n4 numarul de ,,realizari“ ale acestor valori,
insa de data aceasta n11 §i n12 vor ﬁ neobservabile. In schimb, vom furniza suma
n1 I n11 + n12 ca data ,,0bservabila“, alaturi de celelalte date observabile, n2, n3 §i n4.
Sa se estimeze parametrul w folosind algoritmul EM. Cum este aceasta estimare fa§a
de valoarea obtinuta la punctul a?
Indicaﬁe: Ve§i elabora formulele corespunzatoare pasului E §i pasului M. Apoi veti face
0 implementare §i ve§i rula algoritmul EM (pornind, de exemplu, cu valoarea iniigiala
0.5 pentru 1p) pana cand valorile acestui parametru pana la cea de-a §asea zecimala nu
se mai modiﬁca.

***************Ending Page***************


***************Beginning Page***************
***************page number:133**************
133.
Solution: E-step
The verosimility function for the “complete” data is now
P(D]¢):ﬁ._._.—.—._
— TL‘ 1 n11 1 _ w n2+n3 w n12+n4
while the corresponding log-verosimility function can be written as
lnP(D\@b) : (n2 + n3) ln(1 — w) + (n12 + n4) lnw —|— ln d,
where d is a constan which does not depind on 2p.
Therefore, the ,,auXiliary“ function will be
I lnd + (n2 + n3) ln(1 — 1p) + (1312 + n4) lnrb,
where
n12 — [n12ln17n27n3m47w l — m -n1_ m -n1.

***************Ending Page***************

***************Beginning Page***************
***************page number:134**************
134.
M-step
(9 n2 + n3 7512 + n4
—ElnPD;b :——+—
aw l < \ >1 1 _ w w
:> ZEUHHDWN I _M _ m < 0
W2 (1 — 1W $2 _
:> the auxiliary function is concave.
8 Eu P<D|¢>1 0 e
— n :
8w
(75112 + n4)(1 — w) I 1M2 ‘l’ n3) <I>
$0512 + n2 +713 + n4) I "I312 + n4 (I)
Mud) I 7512 + n4
n — 75/11
where 2
75/11 n25. E[n11|n1,n2,n3,n4,w(t)l I n1 — 75112 I m -n1.
A Matlab implementation of this EM algorithm produces w I 0.62682139,
which is close to the MLE estimation obtained at part a.

***************Ending Page***************


***************Beginning Page***************
***************page number:135**************
135.
a. In(p(X|w))
Q(w|w(0))E “
S . 11(1)
Plots made by | EQWHP: )
Sebastian Ciobanu
‘T 1pm); 1P(1)§§1P(2) \
0.0 0.2 0.4 0.6 0.8 1.0
1p

***************Ending Page***************

***************Beginning Page***************
***************page number:136**************
136.
The EM algorithm for solving
a mixture of K categorical distributions,
applied to the problem of Word Sense Disambiguation,
i.e. identifying the semantic domains associated to words in a
text document
CMU, 2012 fall, Eric Xing, Aarti Singh, HW3, pr. 3

***************Ending Page***************


***************Beginning Page***************
***************page number:137**************
The objective of this exercise is to derive the update equations of the 137.
EM algorithm for optimizing the latent variables [designating the semantic
domains] involved in generating a text document.
Each word will be seen as a random variable w that can take values 1, . . . , V
from the vocabulary Of WOI'dS. In fact, we will denote each w by an array of V
components such that w(z') I 1 if w takes the value of the i-th word in the vocabulary.
Hence, 22/21 w(z') : 1.
Given a document containing words wj, j I 1, . . . , N, Where N is the length
of the document, we will assume that these words are generated from a
mixture of K discrete topics:

K v

P<w> z 2719mm) and P<w|ﬁ$> I Hmww,

5:1 1:1
Where
7T8 denotes the prior [probability] for the latent topic variable Z I s,
65 ﬁg‘ (68(1),...,58(i), . . . ,ﬁ$(V)), with @(2') Z O for 2' : 1, . ..,V and 2L1 58(2') : 1 for each
s: 1,...,K, and
m) @t P<w<¢> I llZ I s)-

***************Ending Page***************

***************Beginning Page***************
***************page number:138**************
138.
a. In the expectation step, for each word wj, compute
not.
(17(5) I P(Zj I sleﬁ),
the probability that wj belongs to each of the K topics, where <9 is
the set of parameters of this mixture model.
Answer:
not. Bayes T. P(wj‘Zj I 5; (9) P(Zj I 8'9)
q-(s) I P(Z- I slw-ﬂ) I —
‘7 J J P (103-19)
I 7T8 P(wj|ﬁ5) I 7T5 Hg; ﬂ5([)wj(l)
25:1 7T8’ P(wj|55’) 25:1 7T8’ Ill/:1 594010" (l)

***************Ending Page***************


***************Beginning Page***************
***************page number:139**************
139.
b. In the maximization step, compute € that maximizes marginea inferioara
of the log-likelihood of the data
N
aw; €) n25. Inn P(wj; <9)
jzl
Hint: Suming over the latent topic variable, we can write 2(a); (9) as
N N
P - '9
£(w;€) I ZanP(wJ-,s;6) I Zlnqﬂs)M
9:1 s j=1 (17(5)
Further on, using Jensen’s inequality (see pr. EM-Z) we get:
N P(w' 5'9) N
@(w39) Z ZZQASNHW I 2261145) 1HP(wj,8;9) +H(qj)
3:1 s J 3'21 s
Hence compute 6 as:
N
ar max -s lnPw',s;6
g6 3:21 g q]( > ( J )

***************Ending Page***************

***************Beginning Page***************
***************page number:140**************
140.
Answer:
N K
6’ : argmaxz 2%(5) lnP(wj, Zj : 5|9)
e .
3:1 5:1
N K
: argmaXZqu-(s) 1nP(wJ-\Zj : s;6) P(Zj : 5W)
0 .
3:1 5:1
N K v
: argmaxz Z qj(s)1n (718 H 3401030))
6 3:1 5:1 1:1
N K v
z arggnaxz Ema-($111715 —|— qj(s) 2111 65(l)wj(l)]
9:1 5:1 1:1
N K V
I arggnax Z 211,15) 1n 7T8 + @748) Z 10340111 58(1)] (14>
9:1 8:1 1:1

***************Ending Page***************


***************Beginning Page***************
***************page number:141**************
To optimize 55a): 141'
After eliminating from (14) the terms which are constant with respect to BS we get:
N v
Z (11(8) Z wall) 111541)
j:1 1:1
We will use a Lagrangian to constrain ﬁg to be a probability distribution:
N V V
£<6$(l)) z Z1<5>2w1<1>1n18<1> + A (Z 68(1) — 1)
j:1 1:1 1:1
Then, solving for 63d):
(9 N w-(l)
—£55l :O<:> q~sj—+)\:0
858(1) ( U) 2 A >110)
N
1 1 —)\
(I) — qj(s)wj(l)+)\:0@—:—
N
._ - s w- l
<:> 65“) I 23_1 (Jig) J() (15)

***************Ending Page***************

***************Beginning Page***************
***************page number:142**************
Knowing that 22/21 58(5) I 1, we have: 142'
v N v N
2-: Q'(5)w'(l)
Z J 11A J I 1 (i) —>\:ZZqJ-(5)wj(l)
l=1 1:1 1:1
Hence, substituting for —)\ in (15), we get:
6 (l) I 2?; 411(5) ION) I 2L ‘11(5) WU)
2L1 2;; MS) 111.1(1) 2;; Eli/=1 MS) 711.1(5)
_ 2221 ‘11(5) WU) _ Ell (11(8) WU)
_ V _ EN—-
‘:1 ‘19(5)
EidﬂQZ 101(1) j
l:1 1
Note: Intuitively the last expression can be interpreted as the portion
[of word[ occurrence]s] that had w(l) I 1 among all words [in the given
document] which are deemed to belong to cluster s.

***************Ending Page***************


***************Beginning Page***************
***************page number:143**************
143.
To optimize 7T5, we proceed similarly:
We begin by removing from (14) the terms that are constant with respect
to 7T3, thus getting:
N
Z qj(s) ln 7T5
3:1
So, using the Lagrangian With the constraint that 25:1 7T5 : 1
N K
we) I 2611(5) 1mg + A (Z 775 _ 1),
j:1 5:1
and solving for 7T5, we have:
59 N (11(5) 1 N
3:1 3:1
N
.2 q’ 5
(i) 7T8 I 211—)\1() (16)

***************Ending Page***************

***************Beginning Page***************
***************page number:144**************
144.
Since 25:1 7T5 : 1, it gives us:
K N K N
23:1 Qj(5) 1
Z——>\ :1 ‘I’ 322W)“
5:1 5:1 3:1
K N
e —A = Z Z (11(5)
5:1 j:1
Substituting for —)\ in (16), we get:
N N N
7T _ Zj:1qj(5) _ ZjI1qj(5) _ Zj:1qj(5)
S _ W _ — _ —
25:1 2]’:1 q](s) N K N
23:1 Z qJ' (5)
5:1
1
Note: Intuitively the last expression can be interpreted as the portion [of
word[ occurrence]s] that belongs to cluster 5 among the total of N words.

***************Ending Page***************


***************Beginning Page***************
***************page number:145**************
145.
T0 summarize:
E step:
v .
s 511090)
65(8): M f0rj:1,...,N and 5:1,...,K
28/:1 778’ lel 58407150)
M step:
N
-_ - s w-l
530) :W for 8:1,...,K andl:1,...,V
Zy=1q1(5)
N
Tszw for 5:1,...,K

***************Ending Page***************

***************Beginning Page***************
***************page number:146**************
146.
The EM algorithm for
solving mixtures of Poisson distributions
University of Utah, 2008 fall, Hal Daumé III, HW9, pr. 1

***************Ending Page***************


***************Beginning Page***************
***************page number:147**************
147.

The Poisson distribution is a distribu- d 00 o M1
tion over positive count values; for a a? ‘ i=4
count as with parameter A, the Poisson ° ' M10

1 X”
has the form P0isson(.r\)\) I —A - —. 3 w. U

e r! Q ° o \
It can be proven that the maximum g. f‘ \‘\"..'.~'~
likelihood estimation for A given a se- f °\ .,' ‘\ ‘3,.
quence of counts $1,...,xn was simply g :,.."°°°°'36,,,,,:"”
1
— 221:1 90¢ — the mean of the counts. o 5 1o 15 20
n X
Let’s consider a generalization of this: the Poisson mixture model. This is
actually used in web ser'ver monitoring. The number of accesses to a web
server in a minute typically follows a Poisson distribution.

***************Ending Page***************

***************Beginning Page***************
***************page number:148**************
148.

Suppose we have n web servers we are monitoring and we monitor

each for M minutes. Thus, we have n >< M counts; call $1M the
number of hits to web server i in minute m. Our goal is to cluster

the web servers according to their hit frequency.

Using the EM algorithm, construct a Poisson mixture model for

this problem and compute the expectations and maximization

steps for this model.

***************Ending Page***************


***************Beginning Page***************
***************page number:149**************
149.
Hint: Suppose we want K clusters; let zz- be the latent variable
telling us which cluster the web server 2' belongs to (from 1 to
K). Let Ak denote the parameter for the Poisson distribution for
cluster k, and Wk the . Then, the complete data likelihood is:
—_ def. __—_1l.i.d.n —_ n —_ —_
( 7W) Maw! 7W) 1119(1); Z! 7T) 111M IZ 7T) 29%| 7T)
W
7Tk:
n K M 1{Z¢=k}
I H H [Wk H P01550n(907;,m|)\k)]
2:1 kzl m:1
where
5E‘ 712' ($1, . . . ,xn), with 9:7; mg. (55171,. ..,l‘1;’M) for 2' I 1,. . .,n,
2 "£5- (21,“ .,zK), 7? "2' (7T1, . . . ,WK); X "2’ (A1, . . Wm, and
1{z¢:k} is one if 21- I k: and zero otherwise.

***************Ending Page***************

***************Beginning Page***************
***************page number:150**************
Solution 150'
The likelihood function:
n K M 1 Xvi“ 1{Z¢=k}
— _ _ k
MMT) — HH [Wk H Wmimil
1:1 k:1 m:1 >
The likelihood function:
df n K M 1 Amwn
— — 3- — - _ k
i:1 kzl m: ’
n K M
I Z Z 1{zZ-:k1} [In Wk; + Z(—)\k —|— ail-am ln Ak; — ln(:cZ-,m)!)]
1'21 krzl mzl
The auxiliary function:
— _ — _ d6. — _
n K M
I Z Z Pei I km, w’ ﬁe) [11W + Zen + mm ln Ak _1n($i,m)!)]
1:1 k:1 m:1

***************Ending Page***************


***************Beginning Page***************
***************page number:151**************
151.
E-step:
29$ 712'?’sz- I km, X“), 7H”)
Bayis F- w

25:1 P(:Uz|z¢ I k’, Xi), 7H6) . P(Z¢ I [@ij ﬁn)

_ w? ‘Pm-‘Zl- I k, w, m
25:1 ﬁg) ' P(ZIZZ|ZZ : k’, Xi), 7H0)

_ ﬁg) - ngl P01550n(:137;,m|)\k)
Egzlmfj) - Hill Poisson($i,m|)\kl))

***************Ending Page***************

***************Beginning Page***************
***************page number:152**************
152.
M-step:
Since 25:1 wk I 1, we have t0 introduce the Lagrange multiplier A:
8 K
_ lam, aw, 7-H”) + 1(1 _ Z 7%)] I 0 4:)
@7174;
k:1
n P11? <t+1> 1 n (t)
Z Wk: 7Tk: >\ szk:
1:1 2:1
It is easy t0 see that ngHl) is indeed a maximum point for Q W.r.t. the pa-
rameter Wk.
. . K (t+1) _
Imposmg the constraint 211:1 Wk _ 1 leads t0:
t t
k::1 i=1 i=1 kzl
1
(t-l-l) _ 1 n (t) . . . .
Therefore, wk _ — 22-21 pm , whlch 1s alyways a non-negatlve quantlty.
n

***************Ending Page***************


***************Beginning Page***************
***************page number:153**************
153.
Now, regarding the parameters Ak:
8 n M 1
1:1 mzl 2:1 mzl 1:1
n M
(t+1) 21:1 PM: (Emzl $13,111)
M I +
MEL-2119M

It can be easily shown that for each k € {1, . . . , K}, the value Agﬂ)
is positive, and it maximizes Q w.r.t. the parameter Ak.

***************Ending Page***************

***************Beginning Page***************
***************page number:154**************
154.
The EM algorithm for solving
a Gamma Mixture Model
G. Vegas-Sénchez-Ferrero, M. Martin-Fernéndez, J. Miguel Sanches
A Gamma Mixture Model for I VUS Imaging, 2014
[ adapted by Liviu Ciortuz l

***************Ending Page***************


***************Beginning Page***************
***************page number:155**************
The Gamma Mixture Model 155'
K x
p(:v|<9) I 2m; Gamma(x\9k), Where Gamma(x|rk,6k) I ;xrk_1e—m,
k::1 577611016)
with 6k I (mm) for k: I 1,. ..,,K r “'2' (T1, . . . ,TK), 5 "2' (51, . . MK), and 7T "2' (7T1, . . . ,WK),
7qu; >0 for k: 1,...,K and Egzlwk : 1,
6 I (74, 57 7T)’
Consider x1, . . . ,xn € R+, each $2- being generated by one component of the above mix-
ture, denoted by zZ- G {1, . ...,K}
Find the maximum likelihood estimation of the parameters 6 by using the EM algo-
rithm.
Solution
o The verosimility of the “complete” data (at, z), with a: n25. (5151, . . . ,xn), and z ng'
(Z1, . . . , Zn), can be written as follows:
i 'd n n K n K
pm» we) 2' Hm, we 2 H Hipwi, 6) -p<zi|@>11~2k} 2 H lll mm 6) mlw}
1:1 i=1 k::1 HF’ 1:1 k:1 ‘F’
Wk Gamma(wi|9k)
Where 1{Zi:k} is the indicator function.

***************Ending Page***************

***************Beginning Page***************
***************page number:156**************
156.
o The log-verosimility function:
d n K
[(9) if 1np(:c, A6) : Z Z 1{Zi:k} [1n 7Tk; +111 Gamma(xi|6k)]
i:1 kzl
6 < ﬂ > n K :1:
I’ 12,: lnvr —7"lnﬂ —1nFT +7‘ 11n$i—]
1:21,;th k: k k (k) (k ) 5k
o The auxiliary function:
(t) 9<t>:(,n<t>75<t>) n K 56¢
Q<Qi€ ) : EP(Z|X,0(’5)) Z Z 1{zi:k} [111717€ — Tk: lnﬁk; —111F(7”k) —|- (Tk: — 1)1Il£17i — E
1:1 kzl
m 2" @‘BP- Z 213%. I km, W) [111m _ m; 1n 5k _1nr(¢=k) + (m _ 1) 11m _ F]
1-:1 1mm?’ k
n K $-
I ZZ'M;[hawk—1"kln6k—lnF(rk)—|-(Tk—1)lnxi—Fl]
1:1 kzl k

***************Ending Page***************


***************Beginning Page***************
***************page number:157**************
157.
E step
G € Wk (9
n0. aes. iZ'Ik, P iIk
,yzgliﬂ) :t PW I k\95¢,9(t)) B y: F K ammaQ? |Z ) (Z | )/
Elk/:1 Gamma(xi|zi I k’, 6) - P(zi I k ‘6)
W
Trkl
_ Gamma(a:i|6k) ~7Tk»
25:1 Gamma(xi|€k/) ~7rk/
Note that $51) > O for k: z 1,...,K and 2' : 1,...,n and any t.

***************Ending Page***************

***************Beginning Page***************
***************page number:158**************
158.
M step: Wk
Because 25:1 wk; I l, we will use a Lagrange multiplier A, and solve as usually:
(9 K
— a e“) A 1 _ z 0 e
8 n K $'
— 1‘ l —l —lF —1lZ-——Z:0<I>
87%;;Vkln1rk m; nﬁk n (Wk)+(rk )nw 5k]
27ik—_>\:04:>—2%k:)\<:>
1:1 7T1“ Wk izl
7T(1t+1) I l if“
k A i:1 Z

***************Ending Page***************


***************Beginning Page***************
***************page number:159**************
159.
By substituting this expression into the constraint 25:1 7Tk I 1, we will get:
XzZVm21¢>XZZV¢k21<I>XnI1©AIn
kzl 1:1 1:1 kzzl

1

Therefore,
<t+1> _ 1 n <t+1>
7% — g 27m

1:1

Note that WISH-1) € (O, 1) for k : 1, . . . ,K.

***************Ending Page***************

***************Beginning Page***************
***************page number:160**************
160.
M step: @111
lemme I 0 a 21141;’? + —) I 0 e i i111- — 1161) I 0
(96k 2.:1 Z ﬂit 513 613 z'zl Z Z
4:) ZV1I<¢<331— 771311) I 0 4:) 27111771511 I 2'7111331 4:) T115111 27111 I Z 7111$1
1:1 1:1 1:1 1:1 1:1
Therefore,
n (t+1)
(1+1) _ 21:1 71k 331' _
Tk: 21:1 V111
Note that ﬁgH) is always positive (because £131 > O for 1L I 1, . . . , 11.),
and it maximizes Q(¢9\<9(t)) w.r.t. 511-

***************Ending Page***************


***************Beginning Page***************
***************page number:161**************
161.
M step: m;
By substituting [the expression of] ﬁgﬂ) into Q(€|€(t)),a we will get:
n K $-
Q(7", ﬂ(t+1)|6’(t)) I Z Zyik [In 7Tk — m1nﬂ<t+1> —1I1F(7"k)+(7"k — 1) 1n 1132' — (#1)]
13:1 kzzl 6k:
Then, solving for the partial derivative of Q(T,ﬁ(t+1)]€(t)) w.r.t. m,
amounts to:
d
_ <t+1> 90:) I 0 4:)
8 n t 1 t 1 x2-
Tmzﬁg) [lnm — Tklnﬂlg+ ) —1nF(7“k) + (m — 1)1n:137; — W I O <:>
1:1 k:
77, /
6+1) —lnﬂ(t+1) — 7" l 1nﬂ<t+1> — m + lnx' — wl; I O
a Note that ﬂétJrl) depends 0n rk.

***************Ending Page***************

***************Beginning Page***************
***************page number:162**************
162.
Since
n (15-1-1) n (t+1)
ilnﬂéﬁl) I i111 21:1 Wk» 11¢ I i (—1n1"k+1n21:1%k an) I _i
n 1 n 1
an‘: 870k Tk 21:1 7g]? ) 871k: 21:1 1;]? ) T":
and
l_1 Z in: 2?:1 vi“) Z EL m-(ZH)
1 n 1 n 1 7
(97% 519+ ) 6m 21:1 1182+ )$i 21:1 1122+ )xi
it follows that
(9
@7ka 6<t+1>|6<t>> I 0 <I>
n TL 6+1) -, r’ TL 6+1)
27§IZ+D [1n 7% — 111 231/21 VZ/lzt+11).1_ _|_ 1 _ Phak) + 1n $1‘ _ $1‘ iii/I121}; 1 I 0
1'21 Zi/zl ,Yi/k; (7%) 2i’=1 Wm 332"

***************Ending Page***************


***************Beginning Page***************
***************page number:163**************
163.
Therefore,
MW) n (t+l)
l — - I
(n77, 110%) 2V”,
n n (t+1) n n n n (t+1)
(t+1) Zi’:1 7m; 93¢’ (t+1) (t+1) (t+1) 2i’:1 Wk
2M: 1n —n (7+1) _ EM: _ 2% 1m” + 2M: mi ‘ —n (7+1) (i)
i=1 21/:1 'Yilk; i=1 i=1 i=1 21/:1 'Ym,» $1”
11/01)) n (15+1) n (t+1) Zn/_ V-(f+1)113w n (154-1)
z z n +1 2k Z
( UM) 1:1 1:1 21":1 Vilk ) 1:1
So,
PM _ 231-11 v§£+1>1v¢ 2:211 v52“) 1n
“WWW —1nn—<t+1>—n—<t+1>
k 21:1 Wm 21:1 Wk
Unfortunately, there is no nkown close form of 7"], satisfying this equation.
Fl
However, it can be shown that the function 1n m, — % is well-behaved,
Tk
yielding a unique solution to the above equation, which will be denoted nail-1);
it can be found through certain numerical methods.
. not P/(Tk) . . .
Note: The funct1on 1M7“) I 1n Tm — W 1s the so-called d1-gamma functlon.
Tk:

***************Ending Page***************

***************Beginning Page***************
***************page number:164**************
164.
Note
It is interesting t0 see that
if in the update equations of this EM algorithm for solving the
1

Gamma Mixture Model we substitute 11ng) I r and yétﬂ) I E for

k: I 17 . . . , K , we obtain exactly the Maximum Likeliood estimations

for the parameters r and 5 of the Gamma distribution.

***************Ending Page***************


***************Beginning Page***************
***************page number:165**************
165.
Deriving the EM algorithm for
estimating the parameters of two random variables
of exponential distribution,
given a set of instances generated by their sum
CMU, 2004 fall, T. Mitchell, Z. Bar-Joseph, HW2, pr. 2.2

***************Ending Page***************

***************Beginning Page***************
***************page number:166**************
166.
Suppose that Z1 ~ eXp(1/)\1) and Z2 ~ eXp(1/)\2), and A1 $£ A2. Z1 and Z2 are
independent. Let X : Z1 + Z2 denote the sum of Z1 and Z2. Suppose that
{$1,362, . . . , 33”} are i.i.d. samples from the distribution of X.
a. Derive an expression for the density of X in terms of A1 and A2.
Hint 1: The density of Z1 is f>\1(z) : A1 -e_>‘1z for z Z O, and O otherwise. The
density of Z2 is deﬁned in a similar way.
Hint 2: You could ﬁrst derive c.d.f. (cumulative distribution function) of X ,
which is deﬁned as F(a:) I P(Z1 + Z2 < w) I fox HP“ f>\1(z1) - f>\2(z2) dz2 dzl.
Emplanat'ion:
def.
F(a:) I P(Z1 +Z2 < 90)
I / (f 1am dz.) when dz.
0 0
I / (f 132%) dZ2> 'f>\1(Z1)dZ1 2/ f f>\1(Z1) ' 132%) dZ2 dZl-
0 0 0 0

***************Ending Page***************


***************Beginning Page***************
***************page number:167**************
167.
Exponential probability density function Exponential cumulative distribution function
C2
m F
F- — 9» = 0.5
— X=1
— x= 1.5 2
3 w.
A O
_\ ><
>< VI
E 5
‘J- <r.
O
LO.
O
g — x = 0.5
— k=1
— t= 1.5
C2 Q
O O
O 1 2 3 4 5 0 1 2 3 4 5
X X

***************Ending Page***************

***************Beginning Page***************
***************page number:168**************
168.
Answer
The c.d.f. of X:
F($)d;flp(zl + Z2 < $> I/ / f>\1(21) ' f,\2(Z2) dZ2 dzl :/ f A1€_>‘121 ->\26_’\2Z2 dzg dzl
0 0 0 0
I / (_)‘1)6_>\1Z1 (/ (—)\2)6_>\2Z2 dZ2) le I/ (—)\1)6_>‘121 (6_>\2z2,g_Z1)d21
0 0 0
I f0 (—)\1)6_A121 (sham) — 6:20) dZ1
I f (—)\1)e_>‘1216_>‘2($—zl)dz1 —/ (—)\1)e_>‘1zldz1
0 0
_)\ w a:
I A 1A e-Agm/ (A2 _)\1>6(>\2—>\1)21dzl _/ <_)\1)6—>\1Z1dzl
2 — 1 0 0
A1 —>\256 A2—>\1 21 £6 —>\1211 :12
Z —)\2—)\16 (A ) ‘0>—€ |O
A1 —>\ (A —>\ ) —>\ A1 —>\ A1 —}\ —>\
: _ 236 2 117_1)_ 196_1:_ 196 217_ 1m 1
A2_>\1€ (6 (6 > A2—>\16 +)\2—)\1€ 6 +
1 _ _ _ — A2€—>\1£C _ A16—>\2$
: 1_—)\ A1w_/\ A200 >\ A1513_)\ Alw:1_
A2—)\1 ( 16 16 + 26 16 ) A2—>\1

***************Ending Page***************


***************Beginning Page***************
***************page number:169**************
169.
The p.d.f. 0f X:
:—:_— —>\)\ 11‘ AA 2$:— 1L 2w
19(33) 633 A2 _ A1 ( 1 26 + 1 26 > A2 _ A1 (6 6 )

***************Ending Page***************

***************Beginning Page***************
***************page number:170**************
170.
b. Derive the E-step and M-step of the EM algorithm, and give explicit
expressions for the parameter updates in the EM process for computing the
MLE Of A1 and A2.
Pasul E (Ewpectatz'on): Se calculeaza functia ,,auXiliara“ (media log-
verosimilitatii datelor complete) pentru iteratia t:
QM | Aw) I EP(Z|X,/\(t))l10gP(X> Z | Ml
Pasul M (Mamimizatz'on): Se maximizeaza media log-verosimilitatii datelor
complete, calculata la pasul E, in raport cu A:
AW'l) I argmaxQQ I Aw)
/\
Notatiz'le de mai sus au urmatoarele semniﬁcatii:
A“) I valoarea parametrului A la iteratia t
X I variabila observabila, cu instantele 331,332, . . . ,xn
Z I (Z1, Z2) variabilele ascunse/neobservabile
avand valorile zlj,z2j, . . .,znj cu j € {1,2},
asa incat 55¢ I Z¢1 + Z22.

***************Ending Page***************


***************Beginning Page***************
***************page number:171**************
171.
Solution: E step; computation of the “auxiliary” function
QM | Aw) I EP(Z|X,,\(t)) [10g ﬁp($112111212 i M] I EP(Z|X,A<1>) [logﬁfxl (Z11) ' fAQ (212)]
i=1 i=1
Z EP(Z|X,/\(t)) [273109; ()\16—MZZ'1 'A26A2Zi2)]
1:1
I EP(Z|X,)\(i)) [2”: (10g A1 — A1211 +10g)\2 — A2212)]
1:1
: EP(Z|X,>\(1§)) [nlog A1 + nlog A2 — Zn: (A1231 —|— A2z¢2)]
1:1
: nlog A1 + nlog A2 — A1 i Ep(z11|w1,>\<t)) [211] — A2 i EP(Z12|$1,>\(t))[Z12]
1:1 1:1

***************Ending Page***************

***************Beginning Page***************
***************page number:172**************
172.
Solution: E step; computation of expectations
de . 931-
EP(Z11|93@>>\“))[Z¢1] :f / Zil ‘19(Zz'1 ‘ $1‘, Aw) de'l
O
e . . )‘(t))
pg 1 I x ’ ) pm | m3)
Ag) _ A?)
t — (t)Z-1 t — (t)96i—21'1
I (A? _ A?) . M
WAS” (€_>‘§t)xi _ @—Aé%)
(t) (t) t
— (W) _ AW) . i
_ 2 1 ( _>\(t)m, —>\(t):13-) >\(t)$'
6 1 1 — 6 2 Z . 6 2 1
(t)_ (t) Z11
I (Aw _ Aw) . $
2 1 6(Agt)_>\gt))mi _ 1

***************Ending Page***************


***************Beginning Page***************
***************page number:173**************
173.
$1‘ m7; (A(t)—>\(t))zi1
df, e 2 1
i’ Ep<z¢1|m<t>ﬂziﬂ é / Z“ 'pQZil \ SCMWMZH I f Z110?) —%§t))'WdZil
0 0 6( 2 _ 1 >951 _ 1
1 a” (t) (t) <2 <2
I — . . A _)\ . (A2 —>\1 )Zild .
6(Agt)—>\§t))£li¢ _ 1/0 Z11 ( 2 1 ) 6 Zzl
Vom rezolva ultima integralé de mai sus utilizémd formula de integrare prin périgi.
mi < > < > mi (9 < > < >
/ Z11 . (Agt) _ A56) . 6(A2t _}\lt )Zil dZil : / Z11 . — (6(A2t _}\1t )Zzl) dzil
0 0 (91511
. LUZ‘
I (Z11 _ 6(Agt>_,\§t>)zil),wl _/ 6(Aét>_/\§t>)zil dzﬂ
0 0
_ , (MU-Mﬁm _ _ 1 (A<t>_A<f/>)zz_l $1 _ . (A<t>_A<t>)a/_i _ 6(Aét)—%§t))wi _ 1
_ x2 . 6 2 1 0 —(t) (t) . 6 2 1 _ £82 . 6 2 1 —(t) (t)
Prin urmare,
(t) (t)
1 (t) (t) 692 _’\1 )mi —1
E . : — . . . (A2 —’\1 )wi _ —
p(z“'$i’w)[zu] e(>\§t)—}\§t))wi _ 1 (x 6 19-151)
$1. . euékkéthwi 1
_ 62929221 _ 1 _ 18L A?)

***************Ending Page***************

***************Beginning Page***************
***************page number:174**************
174.
33¢ I Zn + Z12
i EP(Zi2lwi,)\(t))[Zi2] I EP(Z¢2|$i>)\(t))[xi — 211] I $1- — EP(Zi2|$i,>\(t))[Zi1]
I 33¢ — Ep(zyxi,)\(t))[zil] I 551' — Ep(zi1|xi,>\(t))[zi1]
I $1‘ — f + —
6(A§)-A§))w,- _ 1 Ag) _ A?)
A? - A? (MM _1

***************Ending Page***************


***************Beginning Page***************
***************page number:175**************
175.
Solution: M step
M's-H) I argmaXQ()\ | Aw)
A
I argmax ("10% /\1 + nlog >\2 — >\1 Z Ep(zi1|93i,>\(t)) [Zi1]_ —)\2 Z Ep(zq;2|$i,}\(t)) [212])
A1>0,>\2>0 i=1 i=1
:> AW 1) I 71+ > 0
1 21:1 Ep(zi1|a;i,>\(t)) [211]
:> AU“) : —n n > 0
2 Eizl Ep(Z¢2|£lii,>\(t)) [Z12]
Observatie:
Se veriﬁcéi imediat (:5 aceste solutii intr-adevéir maximizeazé Q(}\ | Aw).

***************Ending Page***************

***************Beginning Page***************
***************page number:176**************
176.
Deriving the EM algorithm for
estimating the parameters of two random variables
of Gaussian univariate distribution,
givl a set of instances generated by their sum
Stanford, 2016 fall, Andrew Ng, John Duchi, HW4, pr. 2

***************Ending Page***************


***************Beginning Page***************
***************page number:177**************
177.
Consider the following problem. There are P papers submitted to a machine learn-
ing conference. Each of R reviewers reads each paper, and gives it a score indicating
how good he / she thought that paper was. We let mp7. denote the score that reviewer
r gave to paper p. A high score means the reviewer liked the paper, and represents
a recommendation from that reviewer that it be accepted for the conference. A low
score means the reviewer did not like the paper.
We imagine that each paper p has some “intrinsic,” true value that we denote by ,up,
where a large value means it’s a good paper. Each reviewer is trying to estimate,
based on reading the paper, what ,up is; the score reported mp7. is then reviewer r’s
guess of ,up.
However, some reviewers are just generally inclined to think all papers are good
and tend to give all papers high scores; other reviewers may be particularly nasty
and tend to give low scores to everything. (Similarly, different reviewers may have
different amounts of variance in the way they review papers, making some reviewers
more consistent / reliable than others.) We let 1/7. denote the “bias” of reviewer r.
A reviewer with bias 1/7. is one whose scores generally tend to be VT higher than they
should be.

***************Ending Page***************

***************Beginning Page***************
***************page number:178**************
178.
All sorts of different random factors inﬂuence the reviewing process, and hence we
will use a model that incorporates several sources of noise. Speciﬁcally, we assume
that reviewers’ scores are generated by a random process given as follows:
3/101" N N<MP7013>7
2P7” N N(VT’7 7-3):
xprlypHZPr N N(yP7" ‘l’ Zpr: ‘72)-
The variables yp," and sz are independent; the variables (:13,y,z) for different paper-
reviewer pairs are also jointly independent. Also, we only ever observe the minis;
thus, the ypT’s and sz’s are all latent random variables.
We would like to estimate the parameters ,up, 0;, I/r, 7'3. If we obtain good estimates
of the papers’ “intrinsic values” up, these can then be used to make acceptance /
rejection decisions for the conference.
We will estimate the parameters by maximizing the marginal likelihood of the data
{xpT ; p : 1, . . .,P, 7" : 1, . . .,R}. This problem has latent variables ypT. and zpqﬂ, and
the maximum likelihood problem cannot be solved in closed form. So, we will use
EM. Your task is to derive the EM update equations. Your ﬁnal E and M step
updates should consist only of addition / subtraction / multiplication / division /
log / exp / sqrt of scalars; and addition / subtraction / multiplication / inverse /
determinant of matrices. For simplicity, you need to treat only {#10, 0,2, ; p : 1,. . . , P}
and {VH7}? ; v" I 1, . . .,R} as parameters. I.e., treat a2 (the conditional variance of
acpr given ypr and zpr) as a ﬁxed, known constant.

***************Ending Page***************


***************Beginning Page***************
***************page number:179**************
179.
a. In this part, we will derive the E-step:
i. The joint distribution p(ypr,zpr,qu~) has the form of a multivariate Gaussian
density. Find its associated mean vector and covariance matrix in terms of the
parameters ,up, 012,, VT, T3, and 02.
Hint: Recognize that wpr can be written as 33p,“ : ypqﬂ —|— zpr + span, Where 6p,‘ ~ N(O, 02)
is independent Gaussian noise.
ii. Derive an expression for qu(ypr,zp,~) déf' p(ypr,zpqn|wpr) (E-step), using the rules
for conditioning on subsets of jointly Gaussian random variables (see the notes
on Factor Analysis, http://cs229.Stanford.edu/notes/csZZQ-notesQ.pdf, accesed at 7
August 2017).
b. Derive the M-step updates to the parameters {,up, I/T, 03,73}.
Hint: It may help to express the lower bound on the likelihood in terms of an expec-
tation with respect to (ypT, sz) drawn from a distribution With density qpr(ypT, zpr).

***************Ending Page***************

***************Beginning Page***************
***************page number:180**************
180.
Solution
a. Let 0 denote the whole set of parameters we are estimating.
Then the steps of the EM algorithm for our problem are (at a high level):
(E-step) For each 10,7" set qéixypr, sz) mg‘ 10(ng zprlgcpr; (905)).
(M-step) Set 6<t+1> : argmapq9 25:1 25:1 Eq(t)(y ) lnp(513pm ypm Zpr; 9)-
pr 101",sz-
Important remark for the E-step:
If we use Bayes’s Rule to compute My”, zpqn|xp7n), then we’ll get integrals of Gaussians
in the denominator, which are tough to compute. Instead, observe that
Mypnzpnfvw) I 19(yprvzpr) ‘19(97prlyprvzpr)

I Mypr) -p(zp1~) -P(fvp1~|yp~ zp.)
is the product of three Gaussian densities, so it is itself a multivariate Gaussian
density.
As a consequence, the joint distribution p(ypr,zpr|:cpr) is also some type of Gaussian
distribution, and we can use the rules for conditioning Gaussians to compute it.
To get a form for its density function, we’ll exploit the fact that a multivariate
Gaussian density is fully parameterized by its mean vector and covariance matrix.

***************Ending Page***************


***************Beginning Page***************
***************page number:181**************
181.
o To compute the mean vector, we’ll rewrite mp7» in the following way:
wpr I ypr + Zpr + 5w",
Where 6W ~ N(O, 02) is independent Gaussian noise.“
Then,
Elyprl I Hp
Elzprl I up
Elmprl I Elypr + Z111" + 5prl Z Elyprl + Elzprl + Elgprl
a To see Why this follows from the deﬁnition in the problem statement, observe that the probability that apr I
mp7» — ypr — zpr takes on any speciﬁc value a is
M52)?" I glyph Zpr) I M35101" — ypr — Zpr I glyph Zpr)
< + + | > 1 1 2
: a; I a z ,2 I i ex ——6 ,
p pr ypr pr ypr p1" m0 p 202
which does not depend on either ypr or zpr. Hence spr can be regarded as independent zero-mean Gaussian noise
with 02 variance.

***************Ending Page***************

***************Beginning Page***************
***************page number:182**************
182.
o To compute the covariance matrix, observe that Var(yp,~) I 0;, Var(zpr) I 7'3, and
Cov(ypr,zpr) I C0v(zpr,ypr) I 0 (since ypr and 2p,» are independent). Also, since ypr,
zpr and apr are independent, we have
Vaﬂxpr) I Va1"(yp,~ —|— zpr + 51w) I Var(ypr) + Va?"(zp,~) —|— Var(5pr)
2 2 2
I 0p + '7} —|— a .
Finally,
001411197", x1”) I Clo/“$117”? Um“) I COMM)?" + 2P7” + 5prayp1")
I Cody”, ypr) + 0014,21,“ ypqﬂ) + Code”, ypT)
I a; —|— O + O I 0;,
where the second to last equality follows from independence of ypr, zpr and 6W.
Similarly, we can show that Cov(zp7~, xpT) I Cov(xpT,a:pT) I 7'3. This allows us to write
up a; O a;
19pm 2pm $101‘ N N 7/7" a 0 7'3 7'3
lap-i-I/T 02 T3 02+73+02

***************Ending Page***************


***************Beginning Page***************
***************page number:183**************
183.
Now we can use the standard results for conditioning on subsets of variables for
multivariate Gaussians (see Appendia: A. Mathematical foundations in Pattern Clas-
siﬁcation (2nd ed.), R. Duda, P. Hart, D. Stork, 2001) to obtain:
nit. _ _ Hpr,Y Zpr,YY Epr,ZY
QPr(ypr>Zpr) — p(yprazpr|wpr»9) —N (l Hpr,Z 1 > l 2P7”,YZ EpT,ZZ I) 7
Where
2
Up
ILL nét. l H2313)’ 1 : ,up + U2 + 0'5? + 7-7? ($177" [up VT) (17)
p7‘ ILLpT',Z U +T—p(x —'Ll, —I/)
7" 0'2 + 0% + 7'7? P7" P 7"
not. Ep'r‘ YY 2p?" ZY 1 (73(7)? + 02) —Ug7'3
Zpr I ’ ’ I — 2 2 2 2 2 - (18)
Epr,YZ Zp'r,ZZ 02 —|— 0g —|— 7'3 —O'PTT Tr (0p + a )

***************Ending Page***************

***************Beginning Page***************
***************page number:184**************
. 184.
Solutlon
b. For the M-step maximizing the expected log-likelihood, we have (letting EqH denote ex-
pectations with respect t0 qu(ypT, zpr) for each p and 7", respectively),
e<t+1> I arg mgXwaW,
where
P R
Q(9|9(t)) I Z Z Eq 111mm, ypr, 2pm)
p21 r21
1 1
1 2 2
M 1 _ (m 1”— 7‘—Z 1’)2 1 — 2(yp7~—up) 1 _—(va"_l/’r’)
lid-2111 25-1 Eq 1n i6 202 p yp p ~ie 20p ~ie 2T2
p_ _ V 271'0' x/ 27T0'p V 27m}
1 1 1 1
_ P R — _ _ _ _ 2 _ _ _ 2 _ _ _ 2
_ szl 21:1 EQ|: 1n (ﬂy/266107} 202 ($17?" ypr Z101") 267123 (ypr Hp) 273 (25101" 7/1") :|
62(0'_va7") P R 1 1 2 1 2

— 219:1 27:1 Eq[ 1n a — Ewpr — Hp) — EWM — V1")

—P RE 11—1<<>2—2 2>—1<<>2—2 +2

— 217:1 211:1 q n a E 31p?“ ypTM/p + Hp Q va" zprur VT)

exp. l'm. P R 1 1 2 2 1 2 2

I 210:1 27:1 ln — — —2(Eq1(ypv") 1_ 2Eq1ypr1lup + Np) _ —2(Eq1(zp1") 1— 2Eq1ZPT1I/1" ‘1' V7")
011T,» 20p 2T7,
exp._lin. zP ZR 1 1 1 E 2 2 2 1 Z 2 2 _ 2
— p21 7:1 I1 UPT — F< pT‘,YY + Mpryy — Hpm/ ' Hp + Mp) — F< pT‘,ZZ) + 112mg — H'pT',Z 1/1" + VT) .
T‘ p T‘

***************Ending Page***************


***************Beginning Page***************
***************page number:185**************
185.
The equality in the last line follows from
Eqiypri : MPHY and Eq[(ypr)2i I (Eqi(ypr)2i _ Eqiypri2) + Eqiyprig I Elord/Y + #129111’-
Similarly for Eq[zpr] and Eq[(zpr)2].
Setting the partial derivatives w.r.t. parameters ,up, VT, 0p, TT t0 O,
1 R 1 R
_—2 2(2MP _ 2HPT,Y) I 0 :> Np I _ ZHPTX (19)
20p 7”:1 R 7":1
1 P 1 P
T p21 p21
R 1 1
2 [—— + —3(Epr,YY + may — lepw Mp + #2)] I 0 i
1:1 0p 0p
1 R
1":1
P 1 1
Z [_7_— + 5(EPT7ZZ + #129132 — QHPTZ V1" + V3] I 0 :>
10:1 T T
1 P
7'3 I F 2(EPTZZ + #129112 — 2“an V1" + V3) (22)
p21

***************Ending Page***************

***************Beginning Page***************
***************page number:186**************
186.
Using the above results,
we can restate our E and M steps in terms of actual computations:
(E-step) For each p, r, compute ,upr, Zpr using equations (17), (18);
(M-step) For each p, 1", compute ,up, up, 0;, 7'3 using equations (19), (20), (21), (22).

***************Ending Page***************


***************Beginning Page***************
***************page number:187**************
187.
Using the EM algorithm for
learning a Poisson distribution
when some data are missing
Liviu Ciortuz, following
Anirban DasGupta, Probability for Statistics and Machine
Learning, Springer, 2011, EX. 20.8

***************Ending Page***************

***************Beginning Page***************
***************page number:188**************
188.
Presupunern ca vrern sa modelam statistic numarul de accidente usoare care s-au produs
in n locatii intr-un anumit interval de timp, sa zicem 0 saptamana. In acest scop, vom
folosi 0 distributie Poisson de parametru A. La sarsitul perioadei de timp respective, ni
se transmite de la m din cele n locatii cate 0 ,,inregistrare“ (notata cu 513,), reprezentand
numarul de accidente usoare produse in locatia 1L.
In mod implicit, ar trebui sa consideram ca in cele n — m locatii de la care n-am primit
inregistrari nu s-a produs niciun accident. Insa, in urma ,,inspectarii“ datelor suntem
determinati sa luam in considerare presupunerea ca in unele din aceste k: locatii s-a
produs cate un [singur] accident user, care a fost ,,trecut sub tacere“ la raportare.
Asadar, formalizand, vom considera datele ,,ne0bservabile“ zl I 0, . . .,zn0 I 0,zn0+1 :
1, . . -7Zn0+n1 I 1, cu n0 + n1 : n — m, alaturi de datele observabile 501, . . . ,513m E N. Toate
aceste date sunt produse de variabile aleatoare urrnand distributia Poisson de [acelasi]
parametru A.
Elaborati algoritmul EM (in speta pasul E si pasul M) pentru estimarea parametrului
A.
Sugestie: In 10c sa se lucreze cu zj, cu j I 1, . . . ,m, va ﬁ suﬁcient sa considerati ca date
neobservabile n0 si n1. Mai mult, considerand numerele n si m cunoscute, va ﬁ suﬁcient
sa lucrati doar cu n1 ca data neobservabila (bineinteles, pe langa datele observabile xZ).

***************Ending Page***************


***************Beginning Page***************
***************page number:189**************
189.
Answer
21, . . . 115110, zn0+1, . . . ,zn0+n1,a31, . . . ,xm ~ PoissonQ)
P ' f P( n) 1 Am
Olsson .m. .: a: : — - —
p e’\ :13!
The verosimility 0f complete data:
def.
L(/\) I P(z1, . . . , zn+0, 2n0+1, . . . , 2n0+nl,a:1, . . . ,ccm|)\)
n0+n1 m no 0 n1 m a:-
1'.1'.d. 1 A 1 A 1 A 1
: H Pei-m -HP(11|1) I H 675. H 55 . H 67:71!
3:1 1:1 1:1 j:110+1 1:1
1 n m XL'i 1 n m A?”
: (6A)”°+"1+m.)\ 11-17%: (1%)" ‘A 1H?!
1:1 1:1
I 6:1» X11 . 1221111- . 1 I 5111. 11:21; @1- . —1
The log-verosimility 0f complete data:
£(A)dgc'1nL(>\): -111 + (111 + Z 11) 1111 _ Z 111111!
1:1 i=1

***************Ending Page***************

***************Beginning Page***************
***************page number:190**************
190.
The auxiliary function:
Q()\‘>\(t)) déf' En1|$i,>\(t) [£(AH : —TL)\ + <E[n1|ach A09] —|— 233i) ln>\ — 21H SQ!
i=1 i=1
E-step:
E[n1|:137;, Aw] is the expected number of unobservable instances zj having value 1, out of
the total of n — m unobservable instances.
The deﬁnition of the density function for the Poisson distribution implies
1 A1 1 1 A0 1
Therefore E [n1|$Z-, Aw] is exactly the expectation of the binomial distribution
. Mt)
Bm (n — m, m) . SO,
AU)
. (t) _ _ —
E[n1|xl,)\ ]_ (n m)1 + Mt).

***************Ending Page***************


***************Beginning Page***************
***************page number:191**************
191.
M-step:
Now we can write
(t) _ _ _ — . _ .
Q(>\|)\ )_ m+ [(71 m1 + W + gm] 1M 21mg.
The ﬁrst two derivatives 0f this function W.r.t. A are:
0 A“) m 1
_ (t) I _ _ — . _
aAQOM > 11+ [(n m>1+Mt> +258] A
(92 A“) m 1
_ (t) I _ _ — . _
(9A2QUM ) [(71 m)1 —|—)\(t) +2951] A2

***************Ending Page***************

***************Beginning Page***************
***************page number:192**************
192.
From the problem’s statement we know that n > m and 2:11 x2- 2 O.
At the initialization step of the EM algorithm the parameter A is asigned a
positive value (M0)), and we will soon see that A“) > 0 at each iteration t > 0.
Therefore, the second derivative of Q is always negative, meaning that Q is
concave and therefore it has a maximum.
In order to ﬁnd this maximum we equate the ﬁrst derivative to 0, which gives
us the update equation:
1 Mt) m
(H1) I _ _ — .

A n[(n m)1+)\(t)+;:m

One can easily see now (ny induction) that A<t+1> > O.

***************Ending Page***************


***************Beginning Page***************
***************page number:193**************
193.
Using the EM algorithm for
estimating the selection probability for a mixture
of two (arbitrary) distributions
CMU, 2006 spring, Carlos Guestrin, ﬁnal exam, pr. 8
ClVlU, 2004 fall, Carlos Guestrin, HW2, pr. 2.1

***************Ending Page***************

***************Beginning Page***************
***************page number:194**************
194.
We want to derive an EM algorithm for estimating the mixing parameter
for a mixture of arbitrary probability densities f1 and f2.
For example, f1(x) could be a standard normal distribution centered at
0, and f2(x) could be the uniform distribution between [0,1]. You can
think about such mixtures in the following way: First, you ﬂip a coin.
With probability A (i.e., the coin comes up heads), you will sample 50 from
density f1, and with probability (l — A) you sample from density f2.
More formally, let fA(a:) I Af1($)+(l —)\) f2(:1:), where f1 and f2 are arbitrary
probability density functions on R, and A 6 [0,1] is an unknown mixture
parameter.

***************Ending Page***************


***************Beginning Page***************
***************page number:195**************
195.
a.
Given a data point x, and a value for the mixture parameter A,
compute the probability that x was generated from density f1.
b.
Now, suppose you are given a data set {$1, . . .,:v,,} drawn i.i.d. from the
mixture density, and a set of coin ﬂips {z1, 22, . . . , zn}, such that z,- : l means
that x,- is a sample from f1, and z,- : O means that x,- was generated from
density f2.
For a ﬁxed parameter A, compute the complete log-likelihood of the data,
i.e., ln P(a:1, Z1, $2, 22, . . . ,xn, znlk).
c.
Now, suppose you are given only a sample {$1, . . . ,xn} drawn i.i.d. from
the mixture density, without the knowledge about which component the
samples were drawn from (i.e., the z,- are unknown).
Using your derivations from part a and b, derive the E- and M-steps for
an EM algorithm to compute the maximum likelihood estimate (MLE) of
the mixture parameter A.

***************Ending Page***************

***************Beginning Page***************
***************page number:196**************
196.
Solution
_ _ _ w _ M
a. P(Z_1\X_a:)_ P(X::E) _ f>\(£13).
b- P<11111111-~,1mzn|1> I H?:1P<w11Z1-W I 11324131111,» - H11»)-
P($1\Z11)\) 'P(Z1|)\) — { (1 _ A)f2(£131) if Z1 I 0
I AzileiYiU — A)1—Zif2($1)l—zi
Therefore,
1nP(a:1,z1,x2,22,.. . ,xn,zn|)\) I ilnP(xZ-, ziIA)
1:1
1:1
: ZZZ-(ﬁrm +1nf1(wZ-)) + (1 — Z1)(11’1(1 — A) +1I1f2($1')))
1:1

***************Ending Page***************


***************Beginning Page***************
***************page number:197**************
197.
c. (t)
E-step: Q(Zi) nét, P(Z2 I 1,33% )\(t)) B.:Th, A fl(wi)
fA(t)($i)
M-step:
A(t+1) : argmaXEq[lnH P(£E1,z1,932,Z2, . . . ,$n,zn|)\)]
A 1:1
I argmaxﬂm - Z M) +1n<1 — A> - Eu — q<zi>>>
A 1.: 1':
1 1 —
3<1A+< —>1<1-A>>—0@£__”-C
(9A C n n C n _ A _ 1 _ A
(I) C(1—/\):A(n—c)<:>czn)\@)\:£:M
n n
:> /\(1:+1) I Q i f1<37i)
n 1-:1 waWU
(92 c 1
Note: Wklnk + (n — C)1n(1 _ M) I _X _ (n — C)—(1 _ M2 S 0 i >\(t+1) corresponds t0 a
maximum.

***************Ending Page***************

***************Beginning Page***************
***************page number:198**************
198.
Note
The EM algorithm can [be naturally extened so as to] handle mix-
tures of an arbritrary (although ﬁxed) number of probabilistic
distributions.

***************Ending Page***************


***************Beginning Page***************
***************page number:199**************
199.
Exempliﬁcation [for a mixture of 3 densities]

Source: Brani Vidakovic, EM Algorithm and Miwtures [Handout 12]
A sample of size 150 is generated from
the mixture

2 2 11.25
ﬁx) : 0.5N(—5,2 )+O.3N(0,0.5 )+0.2./\/(2,1),
where N denotes the normal distribu- '1
tion.
The mixing weights are estimated by the “'15
EM algorithm.
M : 20 iterations of the EM algorithm “'1 r
yielded the weights (0.4977, 0.2732 and r l‘ fl
0.2290. ‘"5 I‘. L -
. r ' ‘I

The nearby ﬁgure shows the h1stogram F! I l!-
of data, the theoretical mixture (dotted u -|:1 -5 n 5
line) and the EM estimate (solid line).

***************Ending Page***************

