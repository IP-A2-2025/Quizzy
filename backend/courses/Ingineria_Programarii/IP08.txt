***************Beginning Page***************
***************page number:1**************
lngineria programérii
Curs 8
12-13 aprilie

***************Ending Page***************

***************Beginning Page***************
***************page number:2**************
Din Cursurile Trecute

> Design Patterns: Definitions, Elements

> GOF: Creational Patterns, Structural Patterns,
Behavioral Patterns

***************Ending Page***************

***************Beginning Page***************
***************page number:3**************
Creational Patterns
> Abstract Factory

> Builder

> Factory Method

> Prototype

> Singleton

> Lazy initialization

> Object pool

> Multiton

> Resource acquisition

***************Ending Page***************

***************Beginning Page***************
***************page number:4**************
Creational Patterns — Introduction

> Abstract the instantiation process

> Help make a system independent of how its
objects are created, composed, and represented

> There are two recurring themes in these patterns:
a First, they all encapsulate knowledge about which
concrete classes the system uses
t Second, they hide how instances of these classes are
created and put together

> The creational patterns give a lot of flexibility in
what gets created, who creates it, how it gets

lireated, and when

***************Ending Page***************

***************Beginning Page***************
***************page number:5**************
Creational Patterns — Abstract
Factory
> Intent — Provide an interface for creating families of
related or dependent objects without specifying
their concrete classes
> Also Known As — Kit
> Motivation
Q Consider a user interface toolkit that supports multiple
look-and-feel standards, defines different appearances
and behaviors for user interface "widgets" like scroll bars,
windows, and buttons
Q To be portable across lookeandefeel standards, an
application should not hardecode its widgets for a
.iicular look and feel

***************Ending Page***************

***************Beginning Page***************
***************page number:6**************
“WWW:
WWW“
mmduwm
WWW
§
"m:w,;;,;v;‘;w,;m;h;a.;i " I
.Mﬂmd
1 .wa I‘ WW
Gumzruvzmewm‘ \
Glomlremmenover H “WWW
' i -
‘ lhlvxtfiﬂ'mv I W
‘ 5

***************Ending Page***************

***************Beginning Page***************
***************page number:7**************
Abstract Factory
> Applicability — Use this pattern when:
r a system should be independent of how its products are
created, composed, and represented
=' a system should be configured with one of multiple
families of products
Q a family of related product objects is designed to be used
together, and you need to enforce this constraint
a you want to provide a class library of products, and you
want to reveal just their interfaces, not their
.itations

***************Ending Page***************

***************Beginning Page***************
***************page number:8**************
CP — Abstract Factory
> Abstract Factory — maze, computer components
m:-
— “I
.
— —
B

***************Ending Page***************

***************Beginning Page***************
***************page number:9**************
Abstract Factory- The Good, The

Bad

> Detaches creators from created objects

> Guarantees compatibility of created objects

> Preserves S and O (from SOLID)

> Code becomes complicated because of lots of
extra classes

***************Ending Page***************

***************Beginning Page***************
***************page number:10**************
Creational Patterns — Builder

> Intent — Separate the construction of a complex
object from its representation so that the same
construction process can create different
representations

> Motivation

Q A reader for the RTF (Rich Text Format) document
exchange format should be able to convert RTF to many
text formats.

a The reader might convert RTF documents into plain ASCII
text or into a text widget that can be edited interactively.
The problem, however, is that the number of possible

nversions is open-ended. So it should be easy to add a
ion without modifying the reader.
n m

***************Ending Page***************

***************Beginning Page***************
***************page number:11**************
Builder and Ficloly Design szm - Bullding chessboard wilh pieces
g was "£3
0......“- MM \\ Q
I I I
“III-I g
k ~

***************Ending Page***************

***************Beginning Page***************
***************page number:12**************
B u | Id e r 2
> Each kind of converter class takes the mechanism for
creating and assembling
v The converter is separate from the reader
I
i Emmaww
i
“miiggramnwmn A
Millﬂanwmlﬂnwliﬂw'ﬂ lwlli (muﬁm'mmcmn vamchnvxmirmn) itmvevlchmmruicmii
Fifi-Mmmmwv muscirrnlu CMMQMM, CMWWMM)
i waMPumglwmli Cunnleaiaw-IIKV
i i oar-mm; GiiYanmeiii
‘ ,1

***************Ending Page***************

***************Beginning Page***************
***************page number:13**************
> Builder , RTF Reader, Happy Meal
—‘ —
\ A
‘
l
- m
‘gemmomm —
,3

***************Ending Page***************


***************Beginning Page***************
***************page number:14**************
Builder 3

> Applicability — Use when the parameters
required for construction are numerous, but
only some are required for each specific
object (different kinds of pizza)

> When you want to build different
representations of similar objects (rail bridge
and road bridge)

***************Ending Page***************

***************Beginning Page***************
***************page number:15**************
Builder - The Good, The Bad

> Allows for step by step construction of
objects

> Steps can be skipped and run later, or can be
run recursively

> Allows for reusing code when building similar
(but different) objects

> Preserves S (from SOLID) — decouples
complex building processes from the
business logic

> Code becomes complicated because of many
new classes

***************Ending Page***************

***************Beginning Page***************
***************page number:16**************
Creational Patterns — Factory
Method

> Intent — Define an interface for creating an object,
but let subclasses decide which class to instantiate

> Also Known As — Virtual Constructor

> Motivation — To create a drawing application, for
example, we define the classes DrawingApplication
and DrawingDocument. The Application class is
responsible for managing Documents and will
create them as required (at Open or New from a
menu, for example)

***************Ending Page***************

***************Beginning Page***************
***************page number:17**************
l ‘a
QM.‘

***************Ending Page***************

***************Beginning Page***************
***************page number:18**************
Factory Method 2
> Subclasses redefine an abstract CreateDocument
> It can then instantiate application-specific Documents
without knowing their class
> CreateDocument is a factory method because it‘s
responsible for "manufacturing" an object
M m m
-
3:25" gﬁgiggmii; Eﬁﬁllﬁ _ mammal» r
Sir/Bil DnoﬂDOcumenll) doumueniil
Flﬁvu'lll
‘ A
‘ i

***************Ending Page***************

***************Beginning Page***************
***************page number:19**************
Factory Method 3
> Applicability — Use this pattern when

, a class can't anticipate the class of objects it must
create

= a class wants its subclasses to specify the objects it
creates

a classes delegate responsibility to one of several helper
subclasses, and you want to localize the knowledge of
which helper subclass is the delegate

***************Ending Page***************

***************Beginning Page***************
***************page number:20**************
Factory Method 4
> Consequences
1v Provides interconnections for subclasses
2v Connects parallel class hierarchies

***************Ending Page***************

***************Beginning Page***************
***************page number:21**************
CP — Factory Method
> Factory Method , Open/New Project, Hello Mr/Ms
Imm-
‘ wosmneuwgl) vw -—————
I A -
'
—
—iiii-
— “

***************Ending Page***************

***************Beginning Page***************
***************page number:22**************
Factory Method- The Good, The

Bad

> Detaches creators from created objects

> Preserves S and O (from SOLID)

> Code becomes complicated because of extra
(derived) classes

***************Ending Page***************

***************Beginning Page***************
***************page number:23**************
Creational Patterns — Prototype

> Intent — Speciﬁ/ the kinds of objects to create using
a prototypical instance, and create new objects by
copying this prototype

> Motivation — You could build an editor for music
scores by customizing a general framework for
graphical editors and adding new objects that
represent notes, rests, and staves

> The editor framework may have a palette of tools
for adding these music objects to the score. The
palette would also include tools for selecting,

‘iving, and otherwise manipulating music objects

***************Ending Page***************

***************Beginning Page***************
***************page number:24**************
mm WW
mm.‘

Mudmed [mg mm‘
,»_ ,/‘
. \ " '
3 X

‘

u

***************Ending Page***************

***************Beginning Page***************
***************page number:25**************
v We can use the Prototype pattern to reduce the
number of classes
M
Clonal)
A
wmlolvu
“W” —' m-
: clnmo A _____
“WW-mm um Im-
DruvAPmmuH) DIIWIPcuImn)
Zwmmm, 5 5

***************Ending Page***************

***************Beginning Page***************
***************page number:26**************
Prototype 3
> Applicability — Use the Prototype pattern when a

system should be independent of how its products

are created, composed, and represented; and

a when the classes to instantiate are specified at run-
time, for example, by dynamic loading; or

to avoid building a class hierarchy of factories that
parallels the class hierarchy of products; or

a when instances of a class can have one of only a few
different combinations of state

***************Ending Page***************


***************Beginning Page***************
***************page number:27**************
CP — Prototype
> Prototype , Music editor, Clonable
\ A
\
—

***************Ending Page***************

***************Beginning Page***************
***************page number:28**************
Prototype - The Good, The Bad

> Copy objects without using the concrete class

> Skip repeated initializations

> Quickly create complex objects

> It is very hard to clone complex classes with
many references

***************Ending Page***************

***************Beginning Page***************
***************page number:29**************
Creational Patterns — Singleton

> Intent — Ensure a class only has one instance, and
provide a global point of access to it

> Motivation — It's important for some classes to
have exactly one instance. There should be only
one file system and one window manager. An
accounting system will be dedicated to serving one
company.

> How do we ensure that a class has only one
instance and that the instance is easily accessible?
A global variable makes an object accessible, but it

iesn't keep you from instantiating multiple

***************Ending Page***************

***************Beginning Page***************
***************page number:30**************
"T
Twu Instancs m samt Smglnon pamm IS wulkmg (In:
‘ 3“

***************Ending Page***************

***************Beginning Page***************
***************page number:31**************
CP — Smgleton
> Singleton i Logger
Singldun
-in:§ance:Sing|etcn
iSmgletonO:
+get|nsianceﬁISingletcn
1,

***************Ending Page***************

***************Beginning Page***************
***************page number:32**************
Singleton - The Good, The Bad

> Guarantees a single instance

> Global access point to an instance

> Breaks S (from SOLID) — the pattern has TWO
responsibilities (i.e. does two things)

> Can mask high coupling or other bad design

> ls difficult to use in multi thread systems

***************Ending Page***************

***************Beginning Page***************
***************page number:33**************
CP — Lazy initialization

> Lazy initialization is the tactic of delaying the
creation of an object, the calculation of a
value, or some other expensive process until
the first time it is needed

> How? With a flag

> Each time when the object is called, the ﬂag
is tested:
a If it is ready, it is returned
a If not, it is initialized

***************Ending Page***************

***************Beginning Page***************
***************page number:34**************
Lazy initialization — Java i
public class Fruitl
private static final Map<String,Fruit> types : new
HashMap<String, Fruit>();
private final String type;
//using a private constructor to force use of the factory method
private Fruit(String type) { this.type I type; }
public static synchronized Fruit getFruit(String type){
if(!types.containsKey(type)) {
types.put(type, new Fruit(type)); // Lazy initialization
l
return types.get(type);

***************Ending Page***************

***************Beginning Page***************
***************page number:35**************
Lazy lnitialization- The Good, The

Bad

> Saves on memory, since it instantiates only as
needed

> More time consuming in case you need many
new instances

***************Ending Page***************

***************Beginning Page***************
***************page number:36**************
CP — Object Pool

> Intent: reuse and share objects that are
expensive to create.

> Motivation: Performance can be sometimes the
key issue during the software development and
the object creation (class instantiation) is a
costly step. The Object Pool pattern offer a
mechanism to reuse objects that are expensive
to create

> Why use it? Basically, we'll use an object pool
whenever there are several clients who needs

i same stateless resource which is expensive

***************Ending Page***************

***************Beginning Page***************
***************page number:37**************
Visual Example of Object Pooling
L" r1 ‘
L33; H Crfq+¢ Bed-o 7
vb \\/
*0 Q o n a . a X
/'
6“
Bad
Pause.
a o o o p I I 0 ;%)
hv
Ev a‘
OD
6 by MikeGeig
‘ ‘7

***************Ending Page***************

***************Beginning Page***************
***************page number:38**************
Object Pool — Implementation (i)
> When a client asks for a Reusable object, the
pool performs the following actions:

= Search for an available Reusable object and if it
was found it will be returned to the client.

a If no Reusable object was found then it tries to
create a new one. If this actions succeeds the new
Reusable object will be returned to the client.

= If the pool was unable to create a new Reusable,
the pool will wait until a reusable object will be
released.

***************Ending Page***************

***************Beginning Page***************
***************page number:39**************
Object Pool — Implementation (2)
m asks for Reuseme
USES +g€HHSlance Reusableporﬂ
+acquu eReusableﬁ):Reusab\e
+| aleaseRasusablaﬂ'eusableﬂeusable) vmd
§
‘ ‘g

***************Ending Page***************


***************Beginning Page***************
***************page number:40**************
ObjECt Pool — Applicability
> Lets’ take the example of the database
connections. It's obviously that opening too
many connections might affect the performance:
D Creating a connection is an expensive operation
n When there are too many connections Opened it
takes longer to create a new one and the
database server will become overloaded
> Here the object pool comes to manage the
connections and provide a way to reuse and
share them. It can also limit the maximum
“that can be created

***************Ending Page***************

***************Beginning Page***************
***************page number:41**************
Object P00l- The Good, The Bad

> Saves on computing resources, since it only
allows for a set number of instances

> Increased overhead in terms of managing the
pool

> Slow for the objects in the waiting queue

***************Ending Page***************

***************Beginning Page***************
***************page number:42**************
Structural Patterns i

> Structural patterns are concerned with how
classes and objects are composed to form larger
structures

> Example: consider how multiple inheritance
mixes two or more classes into one. The result
is a class that combines the properties of its
parent classes. This pattern is particularly useful
for making independently developed class
libraries work together.

***************Ending Page***************

***************Beginning Page***************
***************page number:43**************
Structural Patterns 2

> Rather than composing interfaces or
implementations, structural object
patterns describe ways to compose
objects to realize new functionality

> The added flexibility of object
composition comes from the ability to
change the composition at run-time

***************Ending Page***************

***************Beginning Page***************
***************page number:44**************
Structural Patterns
> Adapter

> Bridge

> Composite

> Decorator

> Fagade

> Flyweight

> Proxy

***************Ending Page***************

***************Beginning Page***************
***************page number:45**************
Structural Patterns — Adapter
> Intent: Convert the interface of a class into another
interface clients expect. Adapter lets classes work
together that couldn't otherwise because of
incompatible interfaces.
> Also Known As: Wrapper
> Motivation: Consider for example a drawing editor
that lets users draw and arrange graphical elements
(lines, polygons, text, etc.) into pictures and
diagrams. The interface for graphical objects is
defined by an abstract class called Shape. The editor
defines a subclass of Shape for each kind of
aphical object: a LineShape class for lines, a
e class for polygons, and so forth.

***************Ending Page***************

***************Beginning Page***************
***************page number:46**************
g
~_ / < 1‘ k‘ U“ ‘UCADAVTR
0 _ 4\» 1 C
1 ' 7’ § M
0/’ ole‘ “' ,' ,
~ {kw
htlps://refac(or|ng.guru/ _ (,3’ ,
‘ '5

***************Ending Page***************

***************Beginning Page***************
***************page number:47**************
mm“
M 1 mmsa
so
USE CW mm
NDMlVM-Q OLIVDLI! _ 2 X USE 1| Gill‘
mBﬂp a 60m SEE/‘ﬂaw KM SGh/s ammwd
MM M WWW; mummy
upmﬁKevZXle 50mm Wvumdmzs
Mmmmw
m M WMM
‘ '7

***************Ending Page***************

***************Beginning Page***************
***************page number:48**************
Adapte r l
> A TextShape subclass that can display and edit text is

considerably more difficult to implement
> We suppose the existence of a TextView class for

displaying and editing text‘ So we can consider TextShape

derived from these classes

CrealeMaﬂWnlallwl
A
CIealeManiDuialoK) CvsaleMamnulaiulll ‘T ""3
w

***************Ending Page***************

***************Beginning Page***************
***************page number:49**************
Adapte r 2

> Applicability — Use the Adapter pattern when
5 you want to use an existing class, and its interface
does not match the one you need
=' you want to create a reusable class that cooperates
with unrelated or unforeseen classes, that is, classes
that don't necessarily have compatible interfaces
a (object adapter only) you need to use several existing
subclasses, but it‘s impractical to adapt their interface
by sub classing every one.

‘ ‘g

***************Ending Page***************

***************Beginning Page***************
***************page number:50**************
Adapter 3
v Structure — The Adapter pattern is used so that two
unrelated interfaces can work together. This is
something like we convert interface of one class into
interface expected by the client.
m
A A
(lmplemenlalionl
‘ 5“

***************Ending Page***************

***************Beginning Page***************
***************page number:51**************
Adapter — Example

> We all have electric sockets in our houses of
different sizes and shapes. | will take an
example of a socket of l 5 Ampere. This is a
bigger socket and the other one which is smaller
is of 5 Ampere. A 15 Amp plug cannot fit into a
5 Amp socket :> we will use an Adapter

> We have a 5 Amp plug and want a 5 Amp socket
so that it can work. We D0 NOT have a 5 Amp
socket, what we have is a 15 Amp socket in
which the 5 Amp plug cannot fit. The problem is
how to cater to the client without changing the

***************Ending Page***************

***************Beginning Page***************
***************page number:52**************
Adapter — Java l
/** The socket class has a specs for 15 AMP.*/
public interface Socket{
public String getOutput();
l
public class Plug{
private String specification : "5 AMP";
public String getlnput(){
return specification;
l l

***************Ending Page***************


***************Beginning Page***************
***************page number:53**************
Adapter —Java 2
public class ConnectorAdapter implements Socket
{
public String getOutput(){
Plug plug = new Plug();
String output: plug.getlnput();
return output;
l
l

***************Ending Page***************

***************Beginning Page***************
***************page number:54**************
Adapter — The Good, The Bad

> Preserves S and O (from SOLID)

> Code becomes complicated because of extra
classes

***************Ending Page***************

***************Beginning Page***************
***************page number:55**************
Structural Patterns — Bridge

> Intent — Decouple an abstraction from its
implementation so that the two can vary
independently

> Also Known As — Handle/Body

> Motivation — Consider the abstraction of shapes,
each with its own properties. One thing all
shapes can do is draw themselves. Drawing
graphics to a screen can be dependent on
different graphics implementations or operating
systems. Shapes have to be able to be drawn on

I many types of operating systems

***************Ending Page***************

***************Beginning Page***************
***************page number:56**************
+ 063 + W
~‘Y
‘

@

. ' . '

Vs.
‘ ‘

htlps://refac(oring.guru/ Q m ‘V M

‘ ‘5

***************Ending Page***************

***************Beginning Page***************
***************page number:57**************
> The bridge helps by allowing the creation of new implementation
classes that provide the drawing implementation. Shape class
provides methods for getting the size or properties of a shape.
Drawing class provides an interface for drawing graphics
- —
i
A l
i s
— —
-
57

***************Ending Page***************

***************Beginning Page***************
***************page number:58**************
Bridge 2

> Applicability i When dividing large classes
with many versions of the same feature (e.g.
multiple types of network connections)

> When developing and extending classes in
multiple and independent directions

***************Ending Page***************

***************Beginning Page***************
***************page number:59**************
Bridge — Java l
interface DrawingAPl {/** "lmplementor" */
public void drawCirc|e(double X, double y, double
radius);
l
/** "Concretelmplementor" 1,2 */
class DrawingAPll implements DrawingAPl{
public void drawCirc|e(double x, double y, double
radius){ System.0ut.printf("APll " + x + y + radius);}
l
class DrawingAPlZ implements DrawingAPl{
ublic void drawCirc|e(double x, double y, double
i‘ ‘ System.out.printf("API2“ + x + y + radius);}

***************Ending Page***************

***************Beginning Page***************
***************page number:60**************
Bridge — Java 2
interface Shape {/** "Abstraction" */
public void drawO;
public void resizeByPercentage(double pct); }
/** "Refined Abstraction" */
class CircleShape implements Shape l
private double x, y, radius;
private DrawingAPl drawingAPl;
public CircleShape(double x, double y, double radius,
DrawingAPl drawingAPl) l
this.x I x; this.y I y; this.radius I radius;
this.drawingAPl I drawingAPl;
l
public void drawO {drawingAPl.drawCirc|e(x, y, radius); }
' oid resizeByPercentage(double pct) l radius *I pct; }
K W

***************Ending Page***************

***************Beginning Page***************
***************page number:61**************
Bridge — Java 3
/** "Client" */
class BridgePattern i
public static void main(5tring[] args){
Shapel] shapes I new Shape[2];
shapele] I new CircleShapeU, 2, 3, new DrawingAPliO);
shapesli] I new CircleShape(S, 7, 8, new DrawingAPlZO);
for (Shape shape : shapes){
shape.resizeByPercentage(2.5);
shape.draw();
i
- 5'

***************Ending Page***************

***************Beginning Page***************
***************page number:62**************
Bridge — The Good, The Bad

> Preserves S and O (from SOLID)

> Allows for platform independent systems

> High level connections

> Code becomes complicated and splits
cohesive classes

***************Ending Page***************

***************Beginning Page***************
***************page number:63**************
Bibliografie

> Erich Gamma, Richard Helm, Ralph Johnson,
and John Vlissides: Design Patterns: Elements
of Reusable Object-Oriented Software
(GangOfFour)

***************Ending Page***************

***************Beginning Page***************
***************page number:64**************
L| n ks

> Design Patterns: http:[[www.oodesign.corn[

> Gang-Of-Four: http:[[c2.com[cgi[wiki?Gang0fFour,
http:i[www.um|.0rg,cn[c%2B%ZB[pdeDesignPatterns.pdf

> Design Patterns Book: http:[[c2.com[cgi[wikiYDesignPatternsBook

> About Design Patterns: httg:i[www.‘avacamg.org[designPatterni

> Design Patterns *Java companion:
httg:Z[www.patterndepot.com[gutlSi avaPatterns.htm

> Java Design patterns:
httg:[[www.allagglabs.(0m['ava design gatternsl'ava design gatter
ns.htm

> Overview of Design Patterns:
httg:l[www.mindsgring.com[ngrand[gattern synopseshtm

> Lazy initialization: http:[[en.wikipedia.orgiwiki[Lazy initialization

> Use Lazy Initialization to Conserve Resources:
t : www.dev><.com ti s Ti 18007

' n patterns httgstl irefactoringguru[designipatterns
E 5»

***************Ending Page***************

